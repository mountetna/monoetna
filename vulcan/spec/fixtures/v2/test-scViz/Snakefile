configfile: "config.yaml"

rule all:
    input:
        "output/plot.png"

rule get_dataset_and_summarize:
    input:
        dataset_name=config["dataset_name"]
    output:
        plotting_options="dataset/plotting_options.json",
        scdata="dataset/scdata.Rds",
        discrete_metadata_summary="dataset/discrete_metadata_summary.json",
        all_opts="dataset/all_opts.json",
        continuous_opts="dataset/continuous_opts.json",
        discrete_opts="dataset/discrete_opts.json",
        reduction_opts="dataset/reduction_opts.json"
    script:
        "scripts/get_dataset_and_summarize.R"

rule make_plot:
    input:
        scdata="dataset/scdata.Rds",
        plot_setup="temps/plot_setup",
        plotting_options="dataset/plotting_options.json"
    output:
        plot_out="output/plot.out",
        legend_png="output/legend.png",
        thumb="output/plot.png",
        plot_Rds="output/plot.Rds"
    script:
        "scripts/make_dittoSeq_plot.R"
