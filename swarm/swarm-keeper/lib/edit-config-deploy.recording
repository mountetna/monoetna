
{"cmd":"http","args":["--check-status","--proxy=http:socks5h://127.0.0.1:9090","--proxy=https:socks5h://127.0.0.1:9090","GET","https://portainer.dsco.ucsf.edu/api/endpoints/1/docker/configs","Authorization: Bearer xxx","filters=={\"name\":[\"timur.staging.yml\"]}"],"result":"0","stdin":"","stdout":"[{\"CreatedAt\":\"2022-01-04T21:53:07.844544002Z\",\"ID\":\"qn484g1c0bmaaw2n1fkueyc8e\",\"Portainer\":{\"ResourceControl\":{\"Id\":236,\"ResourceId\":\"qn484g1c0bmaaw2n1fkueyc8e\",\"SubResourceIds\":[],\"Type\":7,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"Spec\":{\"Data\":\"LS0tCjpwcm9kdWN0aW9uOgogIDpkYjoKICAgIDphZGFwdGVyOiBwb3N0Z3Jlc3FsCiAgICA6ZW5jb2Rpbmc6IHVuaWNvZGUKICAgIDp1c2VyOiBkZXZlbG9wZXIKICAgIDpob3N0OiB0aW11ci1zdGFnaW5nX3Bvc3RncmVzCiAgICA6cG9ydDogNTQzMgogICAgOnBvb2w6IDUKICAgIDp0aW1lb3V0OiA1MDAwCiAgICA6ZGF0YWJhc2U6IHRpbXVyCiAgICA6c2VhcmNoX3BhdGg6CiAgICAtIHByaXZhdGU=\",\"Labels\":{\"canon\":\"timur.staging.yml\",\"replaces\":\"timur.staging.yml_1641333148\"},\"Name\":\"timur.staging.yml\"},\"UpdatedAt\":\"2022-01-04T21:53:07.844544002Z\",\"Version\":{\"Index\":10056888}},{\"CreatedAt\":\"2022-01-04T21:52:28.943648138Z\",\"ID\":\"sh4pln0b83bunf130n8v9e42n\",\"Portainer\":{\"ResourceControl\":{\"Id\":235,\"ResourceId\":\"sh4pln0b83bunf130n8v9e42n\",\"SubResourceIds\":[],\"Type\":7,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"Spec\":{\"Data\":\"LS0tCjpwcm9kdWN0aW9uOgogIDpkYjoKICAgIDphZGFwdGVyOiBwb3N0Z3Jlc3FsCiAgICA6ZW5jb2Rpbmc6IHVuaWNvZGUKICAgIDp1c2VyOiBkZXZlbG9wZXIKICAgIDpob3N0OiB0aW11ci1zdGFnaW5nX3Bvc3RncmVzCiAgICA6cG9ydDogNTQzMgogICAgOnBvb2w6IDUKICAgIDp0aW1lb3V0OiA1MDAwCiAgICA6ZGF0YWJhc2U6IHRpbXVyCiAgICA6c2VhcmNoX3BhdGg6CiAgICAtIHByaXZhdGU=\",\"Labels\":{\"canon\":\"timur.staging.yml\",\"replaces\":\"timur.staging.yml\"},\"Name\":\"timur.staging.yml_1641333148\"},\"UpdatedAt\":\"2022-01-04T21:52:28.943648138Z\",\"Version\":{\"Index\":10056765}}]","stderr":"","i":"1 /home/home/monoetna/swarm/swarm-keeper/lib/edit-config-deploy.recording"}
{"cmd":"http","args":["--check-status","--proxy=http:socks5h://127.0.0.1:9090","--proxy=https:socks5h://127.0.0.1:9090","GET","https://portainer.dsco.ucsf.edu/api/endpoints/1/docker/configs","Authorization: Bearer xxx","filters=={\"name\":[\"timur.staging.yml\"]}"],"result":"0","stdin":"","stdout":"[{\"CreatedAt\":\"2022-01-04T21:53:07.844544002Z\",\"ID\":\"qn484g1c0bmaaw2n1fkueyc8e\",\"Portainer\":{\"ResourceControl\":{\"Id\":236,\"ResourceId\":\"qn484g1c0bmaaw2n1fkueyc8e\",\"SubResourceIds\":[],\"Type\":7,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"Spec\":{\"Data\":\"LS0tCjpwcm9kdWN0aW9uOgogIDpkYjoKICAgIDphZGFwdGVyOiBwb3N0Z3Jlc3FsCiAgICA6ZW5jb2Rpbmc6IHVuaWNvZGUKICAgIDp1c2VyOiBkZXZlbG9wZXIKICAgIDpob3N0OiB0aW11ci1zdGFnaW5nX3Bvc3RncmVzCiAgICA6cG9ydDogNTQzMgogICAgOnBvb2w6IDUKICAgIDp0aW1lb3V0OiA1MDAwCiAgICA6ZGF0YWJhc2U6IHRpbXVyCiAgICA6c2VhcmNoX3BhdGg6CiAgICAtIHByaXZhdGU=\",\"Labels\":{\"canon\":\"timur.staging.yml\",\"replaces\":\"timur.staging.yml_1641333148\"},\"Name\":\"timur.staging.yml\"},\"UpdatedAt\":\"2022-01-04T21:53:07.844544002Z\",\"Version\":{\"Index\":10056888}},{\"CreatedAt\":\"2022-01-04T21:52:28.943648138Z\",\"ID\":\"sh4pln0b83bunf130n8v9e42n\",\"Portainer\":{\"ResourceControl\":{\"Id\":235,\"ResourceId\":\"sh4pln0b83bunf130n8v9e42n\",\"SubResourceIds\":[],\"Type\":7,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"Spec\":{\"Data\":\"LS0tCjpwcm9kdWN0aW9uOgogIDpkYjoKICAgIDphZGFwdGVyOiBwb3N0Z3Jlc3FsCiAgICA6ZW5jb2Rpbmc6IHVuaWNvZGUKICAgIDp1c2VyOiBkZXZlbG9wZXIKICAgIDpob3N0OiB0aW11ci1zdGFnaW5nX3Bvc3RncmVzCiAgICA6cG9ydDogNTQzMgogICAgOnBvb2w6IDUKICAgIDp0aW1lb3V0OiA1MDAwCiAgICA6ZGF0YWJhc2U6IHRpbXVyCiAgICA6c2VhcmNoX3BhdGg6CiAgICAtIHByaXZhdGU=\",\"Labels\":{\"canon\":\"timur.staging.yml\",\"replaces\":\"timur.staging.yml\"},\"Name\":\"timur.staging.yml_1641333148\"},\"UpdatedAt\":\"2022-01-04T21:52:28.943648138Z\",\"Version\":{\"Index\":10056765}}]","stderr":"","i":"2 /home/home/monoetna/swarm/swarm-keeper/lib/edit-config-deploy.recording"}
{"cmd":"http","args":["--check-status","--proxy=http:socks5h://127.0.0.1:9090","--proxy=https:socks5h://127.0.0.1:9090","GET","https://portainer.dsco.ucsf.edu/api/endpoints/1/docker/configs","Authorization: Bearer xxx","filters=={\"name\":[\"timur.staging.yml\"]}"],"result":"0","stdin":"","stdout":"[{\"CreatedAt\":\"2022-01-04T21:53:07.844544002Z\",\"ID\":\"qn484g1c0bmaaw2n1fkueyc8e\",\"Portainer\":{\"ResourceControl\":{\"Id\":236,\"ResourceId\":\"qn484g1c0bmaaw2n1fkueyc8e\",\"SubResourceIds\":[],\"Type\":7,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"Spec\":{\"Data\":\"LS0tCjpwcm9kdWN0aW9uOgogIDpkYjoKICAgIDphZGFwdGVyOiBwb3N0Z3Jlc3FsCiAgICA6ZW5jb2Rpbmc6IHVuaWNvZGUKICAgIDp1c2VyOiBkZXZlbG9wZXIKICAgIDpob3N0OiB0aW11ci1zdGFnaW5nX3Bvc3RncmVzCiAgICA6cG9ydDogNTQzMgogICAgOnBvb2w6IDUKICAgIDp0aW1lb3V0OiA1MDAwCiAgICA6ZGF0YWJhc2U6IHRpbXVyCiAgICA6c2VhcmNoX3BhdGg6CiAgICAtIHByaXZhdGU=\",\"Labels\":{\"canon\":\"timur.staging.yml\",\"replaces\":\"timur.staging.yml_1641333148\"},\"Name\":\"timur.staging.yml\"},\"UpdatedAt\":\"2022-01-04T21:53:07.844544002Z\",\"Version\":{\"Index\":10056888}},{\"CreatedAt\":\"2022-01-04T21:52:28.943648138Z\",\"ID\":\"sh4pln0b83bunf130n8v9e42n\",\"Portainer\":{\"ResourceControl\":{\"Id\":235,\"ResourceId\":\"sh4pln0b83bunf130n8v9e42n\",\"SubResourceIds\":[],\"Type\":7,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"Spec\":{\"Data\":\"LS0tCjpwcm9kdWN0aW9uOgogIDpkYjoKICAgIDphZGFwdGVyOiBwb3N0Z3Jlc3FsCiAgICA6ZW5jb2Rpbmc6IHVuaWNvZGUKICAgIDp1c2VyOiBkZXZlbG9wZXIKICAgIDpob3N0OiB0aW11ci1zdGFnaW5nX3Bvc3RncmVzCiAgICA6cG9ydDogNTQzMgogICAgOnBvb2w6IDUKICAgIDp0aW1lb3V0OiA1MDAwCiAgICA6ZGF0YWJhc2U6IHRpbXVyCiAgICA6c2VhcmNoX3BhdGg6CiAgICAtIHByaXZhdGU=\",\"Labels\":{\"canon\":\"timur.staging.yml\",\"replaces\":\"timur.staging.yml\"},\"Name\":\"timur.staging.yml_1641333148\"},\"UpdatedAt\":\"2022-01-04T21:52:28.943648138Z\",\"Version\":{\"Index\":10056765}}]","stderr":"","i":"3 /home/home/monoetna/swarm/swarm-keeper/lib/edit-config-deploy.recording"}
{"cmd":"date","args":["+%s"],"result":"0","stdin":"","stdout":"1641333336","stderr":"","i":"4 /home/home/monoetna/swarm/swarm-keeper/lib/edit-config-deploy.recording"}
{"cmd":"http","args":["--check-status","--proxy=http:socks5h://127.0.0.1:9090","--proxy=https:socks5h://127.0.0.1:9090","POST","https://portainer.dsco.ucsf.edu/api/endpoints/1/docker/configs/create","Authorization: Bearer xxx","Name=timur.staging.yml_1641333336","Data=LS0tCjpwcm9kdWN0aW9uOgogIDpkYjoKICAgIDphZGFwdGVyOiBwb3N0Z3Jlc3FsCiAgICA6ZW5jb2Rpbmc6IHVuaWNvZGUKICAgIDp1c2VyOiBkZXZlbG9wZXIKICAgIDpob3N0OiB0aW11ci1zdGFnaW5nX3Bvc3RncmVzCiAgICA6cG9ydDogNTQzMgogICAgOnBvb2w6IDUKICAgIDp0aW1lb3V0OiA1MDAwCiAgICA6ZGF0YWJhc2U6IHRpbXVyCiAgICA6c2VhcmNoX3BhdGg6CiAgICAtIHByaXZhdGU=","Labels:={","  \"canon\": \"timur.staging.yml\",","  \"replaces\": \"timur.staging.yml\"","}"],"result":"0","stdin":"","stdout":"{\"ID\":\"v708ckky9705nzt3rv6gya39l\",\"Portainer\":{\"ResourceControl\":{\"Id\":237,\"ResourceId\":\"v708ckky9705nzt3rv6gya39l\",\"SubResourceIds\":[],\"Type\":7,\"UserAccesses\":[{\"UserId\":1,\"AccessLevel\":1}],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":false,\"System\":false}}}","stderr":"","i":"5 /home/home/monoetna/swarm/swarm-keeper/lib/edit-config-deploy.recording"}
{"cmd":"http","args":["--check-status","--proxy=http:socks5h://127.0.0.1:9090","--proxy=https:socks5h://127.0.0.1:9090","GET","https://portainer.dsco.ucsf.edu/api/endpoints/1/docker/configs/v708ckky9705nzt3rv6gya39l","Authorization: Bearer xxx"],"result":"0","stdin":"","stdout":"{\"CreatedAt\":\"2022-01-04T21:55:36.743578474Z\",\"ID\":\"v708ckky9705nzt3rv6gya39l\",\"Portainer\":{\"ResourceControl\":{\"Id\":237,\"ResourceId\":\"v708ckky9705nzt3rv6gya39l\",\"SubResourceIds\":[],\"Type\":7,\"UserAccesses\":[{\"UserId\":1,\"AccessLevel\":1}],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":false,\"System\":false}},\"Spec\":{\"Data\":\"LS0tCjpwcm9kdWN0aW9uOgogIDpkYjoKICAgIDphZGFwdGVyOiBwb3N0Z3Jlc3FsCiAgICA6ZW5jb2Rpbmc6IHVuaWNvZGUKICAgIDp1c2VyOiBkZXZlbG9wZXIKICAgIDpob3N0OiB0aW11ci1zdGFnaW5nX3Bvc3RncmVzCiAgICA6cG9ydDogNTQzMgogICAgOnBvb2w6IDUKICAgIDp0aW1lb3V0OiA1MDAwCiAgICA6ZGF0YWJhc2U6IHRpbXVyCiAgICA6c2VhcmNoX3BhdGg6CiAgICAtIHByaXZhdGU=\",\"Labels\":{\"canon\":\"timur.staging.yml\",\"replaces\":\"timur.staging.yml\"},\"Name\":\"timur.staging.yml_1641333336\"},\"UpdatedAt\":\"2022-01-04T21:55:36.743578474Z\",\"Version\":{\"Index\":10057248}}","stderr":"","i":"6 /home/home/monoetna/swarm/swarm-keeper/lib/edit-config-deploy.recording"}
{"cmd":"http","args":["--check-status","--proxy=http:socks5h://127.0.0.1:9090","--proxy=https:socks5h://127.0.0.1:9090","PUT","https://portainer.dsco.ucsf.edu/api/resource_controls/237","Authorization: Bearer xxx","AdministratorsOnly:=true","Public:=false","Teams:=[]","Users:=[]"],"result":"0","stdin":"","stdout":"{\"Id\":237,\"ResourceId\":\"v708ckky9705nzt3rv6gya39l\",\"SubResourceIds\":[],\"Type\":7,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}","stderr":"","i":"7 /home/home/monoetna/swarm/swarm-keeper/lib/edit-config-deploy.recording"}
{"cmd":"http","args":["--check-status","--proxy=http:socks5h://127.0.0.1:9090","--proxy=https:socks5h://127.0.0.1:9090","GET","https://portainer.dsco.ucsf.edu/api/endpoints/1/docker/configs","Authorization: Bearer xxx","filters=={\"name\":[\"timur.staging.yml\"]}"],"result":"0","stdin":"","stdout":"[{\"CreatedAt\":\"2022-01-04T21:53:07.844544002Z\",\"ID\":\"qn484g1c0bmaaw2n1fkueyc8e\",\"Portainer\":{\"ResourceControl\":{\"Id\":236,\"ResourceId\":\"qn484g1c0bmaaw2n1fkueyc8e\",\"SubResourceIds\":[],\"Type\":7,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"Spec\":{\"Data\":\"LS0tCjpwcm9kdWN0aW9uOgogIDpkYjoKICAgIDphZGFwdGVyOiBwb3N0Z3Jlc3FsCiAgICA6ZW5jb2Rpbmc6IHVuaWNvZGUKICAgIDp1c2VyOiBkZXZlbG9wZXIKICAgIDpob3N0OiB0aW11ci1zdGFnaW5nX3Bvc3RncmVzCiAgICA6cG9ydDogNTQzMgogICAgOnBvb2w6IDUKICAgIDp0aW1lb3V0OiA1MDAwCiAgICA6ZGF0YWJhc2U6IHRpbXVyCiAgICA6c2VhcmNoX3BhdGg6CiAgICAtIHByaXZhdGU=\",\"Labels\":{\"canon\":\"timur.staging.yml\",\"replaces\":\"timur.staging.yml_1641333148\"},\"Name\":\"timur.staging.yml\"},\"UpdatedAt\":\"2022-01-04T21:53:07.844544002Z\",\"Version\":{\"Index\":10056888}},{\"CreatedAt\":\"2022-01-04T21:52:28.943648138Z\",\"ID\":\"sh4pln0b83bunf130n8v9e42n\",\"Portainer\":{\"ResourceControl\":{\"Id\":235,\"ResourceId\":\"sh4pln0b83bunf130n8v9e42n\",\"SubResourceIds\":[],\"Type\":7,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"Spec\":{\"Data\":\"LS0tCjpwcm9kdWN0aW9uOgogIDpkYjoKICAgIDphZGFwdGVyOiBwb3N0Z3Jlc3FsCiAgICA6ZW5jb2Rpbmc6IHVuaWNvZGUKICAgIDp1c2VyOiBkZXZlbG9wZXIKICAgIDpob3N0OiB0aW11ci1zdGFnaW5nX3Bvc3RncmVzCiAgICA6cG9ydDogNTQzMgogICAgOnBvb2w6IDUKICAgIDp0aW1lb3V0OiA1MDAwCiAgICA6ZGF0YWJhc2U6IHRpbXVyCiAgICA6c2VhcmNoX3BhdGg6CiAgICAtIHByaXZhdGU=\",\"Labels\":{\"canon\":\"timur.staging.yml\",\"replaces\":\"timur.staging.yml\"},\"Name\":\"timur.staging.yml_1641333148\"},\"UpdatedAt\":\"2022-01-04T21:52:28.943648138Z\",\"Version\":{\"Index\":10056765}},{\"CreatedAt\":\"2022-01-04T21:55:36.743578474Z\",\"ID\":\"v708ckky9705nzt3rv6gya39l\",\"Portainer\":{\"ResourceControl\":{\"Id\":237,\"ResourceId\":\"v708ckky9705nzt3rv6gya39l\",\"SubResourceIds\":[],\"Type\":7,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"Spec\":{\"Data\":\"LS0tCjpwcm9kdWN0aW9uOgogIDpkYjoKICAgIDphZGFwdGVyOiBwb3N0Z3Jlc3FsCiAgICA6ZW5jb2Rpbmc6IHVuaWNvZGUKICAgIDp1c2VyOiBkZXZlbG9wZXIKICAgIDpob3N0OiB0aW11ci1zdGFnaW5nX3Bvc3RncmVzCiAgICA6cG9ydDogNTQzMgogICAgOnBvb2w6IDUKICAgIDp0aW1lb3V0OiA1MDAwCiAgICA6ZGF0YWJhc2U6IHRpbXVyCiAgICA6c2VhcmNoX3BhdGg6CiAgICAtIHByaXZhdGU=\",\"Labels\":{\"canon\":\"timur.staging.yml\",\"replaces\":\"timur.staging.yml\"},\"Name\":\"timur.staging.yml_1641333336\"},\"UpdatedAt\":\"2022-01-04T21:55:36.743578474Z\",\"Version\":{\"Index\":10057248}}]","stderr":"","i":"8 /home/home/monoetna/swarm/swarm-keeper/lib/edit-config-deploy.recording"}
{"cmd":"http","args":["--check-status","--proxy=http:socks5h://127.0.0.1:9090","--proxy=https:socks5h://127.0.0.1:9090","GET","https://portainer.dsco.ucsf.edu/api/stacks","Authorization: Bearer xxx"],"result":"0","stdin":"","stdout":"[{\"Id\":2,\"Name\":\"redis-ha\",\"Type\":1,\"EndpointId\":1,\"SwarmId\":\"npcpmkzm9t2zp6gfq9o96wogc\",\"EntryPoint\":\"swarm/redis.yml\",\"Env\":[],\"ResourceControl\":{\"Id\":3,\"ResourceId\":\"1_redis-ha\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false},\"Status\":1,\"ProjectPath\":\"/data/compose/2\",\"CreationDate\":1629483058,\"CreatedBy\":\"etna\",\"UpdateDate\":1630428797,\"UpdatedBy\":\"etna\",\"AdditionalFiles\":null,\"AutoUpdate\":null,\"GitConfig\":{\"URL\":\"https://github.com/mountetna/monoetna.git\",\"ReferenceName\":\"refs/heads/swarm/stacks\",\"ConfigFilePath\":\"swarm/redis.yml\",\"Authentication\":null,\"ConfigHash\":\"\"},\"Namespace\":\"\",\"IsComposeFormat\":false},{\"Id\":4,\"Name\":\"edge\",\"Type\":1,\"EndpointId\":1,\"SwarmId\":\"npcpmkzm9t2zp6gfq9o96wogc\",\"EntryPoint\":\"swarm/edge.yml\",\"Env\":[],\"ResourceControl\":{\"Id\":7,\"ResourceId\":\"1_edge\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[{\"TeamId\":1,\"AccessLevel\":1}],\"Public\":false,\"AdministratorsOnly\":false,\"System\":false},\"Status\":1,\"ProjectPath\":\"/data/compose/4\",\"CreationDate\":1629765680,\"CreatedBy\":\"etna\",\"UpdateDate\":1641113620,\"UpdatedBy\":\"etna\",\"AdditionalFiles\":null,\"AutoUpdate\":null,\"GitConfig\":{\"URL\":\"https://github.com/mountetna/monoetna.git\",\"ReferenceName\":\"refs/heads/swarm/stacks\",\"ConfigFilePath\":\"swarm/edge.yml\",\"Authentication\":null,\"ConfigHash\":\"14c58939ab6b51d3b377fcbb2b68ffaaa528088a\"},\"Namespace\":\"\",\"IsComposeFormat\":false},{\"Id\":7,\"Name\":\"agents\",\"Type\":1,\"EndpointId\":1,\"SwarmId\":\"npcpmkzm9t2zp6gfq9o96wogc\",\"EntryPoint\":\"swarm/agents.yml\",\"Env\":[],\"ResourceControl\":{\"Id\":36,\"ResourceId\":\"1_agents\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false},\"Status\":1,\"ProjectPath\":\"/data/compose/7\",\"CreationDate\":1630378503,\"CreatedBy\":\"etna\",\"UpdateDate\":1641112224,\"UpdatedBy\":\"etna\",\"AdditionalFiles\":null,\"AutoUpdate\":null,\"GitConfig\":{\"URL\":\"https://github.com/mountetna/monoetna.git\",\"ReferenceName\":\"refs/heads/swarm/stacks\",\"ConfigFilePath\":\"swarm/agents.yml\",\"Authentication\":null,\"ConfigHash\":\"6d09a4082adb027ef6389e65215608f34b691e5a\"},\"Namespace\":\"\",\"IsComposeFormat\":false},{\"Id\":12,\"Name\":\"monitor\",\"Type\":1,\"EndpointId\":1,\"SwarmId\":\"npcpmkzm9t2zp6gfq9o96wogc\",\"EntryPoint\":\"swarm/monitor.yml\",\"Env\":[],\"ResourceControl\":{\"Id\":49,\"ResourceId\":\"1_monitor\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false},\"Status\":1,\"ProjectPath\":\"/data/compose/12\",\"CreationDate\":1630445964,\"CreatedBy\":\"etna\",\"UpdateDate\":1641113950,\"UpdatedBy\":\"etna\",\"AdditionalFiles\":null,\"AutoUpdate\":null,\"GitConfig\":{\"URL\":\"https://github.com/mountetna/monoetna.git\",\"ReferenceName\":\"refs/heads/swarm/stacks\",\"ConfigFilePath\":\"swarm/monitor.yml\",\"Authentication\":null,\"ConfigHash\":\"\"},\"Namespace\":\"\",\"IsComposeFormat\":false},{\"Id\":15,\"Name\":\"airflow\",\"Type\":1,\"EndpointId\":1,\"SwarmId\":\"npcpmkzm9t2zp6gfq9o96wogc\",\"EntryPoint\":\"swarm/airflow.yml\",\"Env\":[{\"name\":\"_AIRFLOW_WWW_USER_USERNAME\",\"value\":\"etna\"},{\"name\":\"_AIRFLOW_WWW_USER_PASSWORD\",\"value\":\"etnapassword\"}],\"ResourceControl\":{\"Id\":54,\"ResourceId\":\"1_airflow\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false},\"Status\":1,\"ProjectPath\":\"/data/compose/15\",\"CreationDate\":1630648397,\"CreatedBy\":\"etna\",\"UpdateDate\":1640831223,\"UpdatedBy\":\"etna\",\"AdditionalFiles\":null,\"AutoUpdate\":null,\"GitConfig\":{\"URL\":\"https://github.com/mountetna/monoetna.git\",\"ReferenceName\":\"refs/heads/swarm/stacks\",\"ConfigFilePath\":\"swarm/airflow.yml\",\"Authentication\":null,\"ConfigHash\":\"\"},\"Namespace\":\"\",\"IsComposeFormat\":false},{\"Id\":17,\"Name\":\"vulcan\",\"Type\":1,\"EndpointId\":1,\"SwarmId\":\"npcpmkzm9t2zp6gfq9o96wogc\",\"EntryPoint\":\"swarm/vulcan.yml\",\"Env\":[],\"ResourceControl\":{\"Id\":59,\"ResourceId\":\"1_vulcan\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false},\"Status\":1,\"ProjectPath\":\"/data/compose/17\",\"CreationDate\":1630827434,\"CreatedBy\":\"etna\",\"UpdateDate\":1641241242,\"UpdatedBy\":\"etna\",\"AdditionalFiles\":null,\"AutoUpdate\":{\"Interval\":\"\",\"Webhook\":\"\",\"JobID\":\"\"},\"GitConfig\":{\"URL\":\"https://github.com/mountetna/monoetna.git\",\"ReferenceName\":\"refs/heads/swarm/stacks\",\"ConfigFilePath\":\"swarm/vulcan.yml\",\"Authentication\":null,\"ConfigHash\":\"\"},\"Namespace\":\"\",\"IsComposeFormat\":false},{\"Id\":28,\"Name\":\"janus-staging\",\"Type\":1,\"EndpointId\":1,\"SwarmId\":\"npcpmkzm9t2zp6gfq9o96wogc\",\"EntryPoint\":\"swarm/janus-staging.yml\",\"Env\":[{\"name\":\"APP_NAME\",\"value\":\"janus\"},{\"name\":\"ENV\",\"value\":\"staging\"},{\"name\":\"APP_ENV\",\"value\":\"JANUS_ENV\"},{\"name\":\"APP_CONFIG\",\"value\":\"janus.staging.yml\"},{\"name\":\"ENV_CONFIG\",\"value\":\"etna.staging.yml\"}],\"ResourceControl\":{\"Id\":83,\"ResourceId\":\"1_janus-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false},\"Status\":1,\"ProjectPath\":\"/data/compose/28\",\"CreationDate\":1638227821,\"CreatedBy\":\"etna\",\"UpdateDate\":1641330711,\"UpdatedBy\":\"etna\",\"AdditionalFiles\":null,\"AutoUpdate\":{\"Interval\":\"\",\"Webhook\":\"\",\"JobID\":\"\"},\"GitConfig\":{\"URL\":\"https://github.com/mountetna/monoetna.git\",\"ReferenceName\":\"refs/heads/swarm/stacks\",\"ConfigFilePath\":\"swarm/janus-staging.yml\",\"Authentication\":null,\"ConfigHash\":\"\"},\"Namespace\":\"\",\"IsComposeFormat\":false},{\"Id\":30,\"Name\":\"polyphemus-staging\",\"Type\":1,\"EndpointId\":1,\"SwarmId\":\"npcpmkzm9t2zp6gfq9o96wogc\",\"EntryPoint\":\"swarm/polyphemus-staging.yml\",\"Env\":[{\"name\":\"APP_ENV\",\"value\":\"POLYPHEMUS_ENV\"},{\"name\":\"APP_NAME\",\"value\":\"polyphemus\"},{\"name\":\"ENV\",\"value\":\"staging\"},{\"name\":\"APP_CONFIG\",\"value\":\"polyphemus.staging.yml\"},{\"name\":\"ENV_CONFIG\",\"value\":\"etna.staging.yml\"}],\"ResourceControl\":{\"Id\":140,\"ResourceId\":\"1_polyphemus-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false},\"Status\":1,\"ProjectPath\":\"/data/compose/30\",\"CreationDate\":1640813746,\"CreatedBy\":\"etna\",\"UpdateDate\":1641254093,\"UpdatedBy\":\"etna\",\"AdditionalFiles\":[],\"AutoUpdate\":{\"Interval\":\"\",\"Webhook\":\"\",\"JobID\":\"\"},\"GitConfig\":{\"URL\":\"https://github.com/mountetna/monoetna\",\"ReferenceName\":\"refs/heads/swarm/stacks\",\"ConfigFilePath\":\"swarm/polyphemus-staging.yml\",\"Authentication\":null,\"ConfigHash\":\"14c58939ab6b51d3b377fcbb2b68ffaaa528088a\"},\"Namespace\":\"\",\"IsComposeFormat\":false},{\"Id\":36,\"Name\":\"timur-staging\",\"Type\":1,\"EndpointId\":1,\"SwarmId\":\"npcpmkzm9t2zp6gfq9o96wogc\",\"EntryPoint\":\"swarm/timur-staging.yml\",\"Env\":[{\"name\":\"APP_NAME\",\"value\":\"timur\"},{\"name\":\"ENV\",\"value\":\"staging\"},{\"name\":\"APP_ENV\",\"value\":\"TIMUR_ENV\"},{\"name\":\"APP_CONFIG\",\"value\":\"timur.staging.yml\"},{\"name\":\"ENV_CONFIG\",\"value\":\"etna.staging.yml\"}],\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false},\"Status\":1,\"ProjectPath\":\"/data/compose/36\",\"CreationDate\":1641252002,\"CreatedBy\":\"etna\",\"UpdateDate\":1641333200,\"UpdatedBy\":\"etna\",\"AdditionalFiles\":[],\"AutoUpdate\":{\"Interval\":\"\",\"Webhook\":\"\",\"JobID\":\"\"},\"GitConfig\":{\"URL\":\"https://github.com/mountetna/monoetna.git\",\"ReferenceName\":\"refs/heads/swarm/stacks\",\"ConfigFilePath\":\"swarm/timur-staging.yml\",\"Authentication\":null,\"ConfigHash\":\"c0b611a840bdf74165e6042683b3cc57f7c57a25\"},\"Namespace\":\"\",\"IsComposeFormat\":false}]","stderr":"","i":"9 /home/home/monoetna/swarm/swarm-keeper/lib/edit-config-deploy.recording"}
{"cmd":"http","args":["--check-status","--proxy=http:socks5h://127.0.0.1:9090","--proxy=https:socks5h://127.0.0.1:9090","GET","https://portainer.dsco.ucsf.edu/api/stacks/36/file","Authorization: Bearer xxx"],"result":"0","stdin":"","stdout":"{\"StackFileContent\":\"version: '3.8'\\n\\nservices:\\n  postgres:\\n    image: postgres:10.19\\n    environment:\\n      POSTGRES_DB: \\\"${APP_NAME}\\\"\\n      POSTGRES_PASSWORD_FILE: /run/secrets/password\\n      POSTGRES_USER: developer\\n    volumes:\\n      - db:/var/lib/postgresql/data\\n    deploy:\\n      placement:\\n        constraints:\\n          - node.labels.volumes.${APP_NAME}_${ENV}_db == true\\n    networks:\\n      - db\\n    secrets:\\n      - source: db-pw\\n        target: password\\n\\n  app:\\n    environment:\\n      - APP_NAME=${APP_NAME}\\n      - ${APP_ENV}=production\\n      - ETNA__PRODUCTION_FILE=/app/env.yml\\n      - ETNA__PRODUCTION__DB__PASSWORD_FILE=/run/secrets/db-password\\n      - ETNA__PRODUCTION__ROLLBAR__ACCESS_TOKEN=/run/secrets/rollbar-access-token\\n      - ETNA__PRODUCTION__USER_HASH_SECRET=/run/secrets/user-hash-secret\\n      #- ETNA__PRODUCTION__HMAC_KEYS__METIS_FILE=/run/secrets/staging-metis-hmac\\n      #- ETNA__PRODUCTION__HMAC_KEYS__MAGMA_FILE=/run/secrets/staging-metis-hmac\\n    command:\\n      - bash\\n      - -c\\n      - |\\n        set -e\\n        export METRICS_PW=\\\"$$(cat /run/secrets/metrics-pw)\\\"\\n        exec /bin/deploy.sh migrate -- /app/bin/puma.sh\\n    image: etnaagent/${APP_NAME}:${ENV}\\n    volumes:\\n      #- ${DATA_SOURCE}/${APP_NAME}/:/app/data/${APP_NAME}\\n      - /var/node_exporter/metrics.prom:/tmp/metrics.prom\\n    #user: ${APP_UID}:999 # metis:docker\\n    deploy:\\n      update_config:\\n        parallelism: 1\\n        order: start-first\\n      labels:\\n        - autoupdate=true\\n      #placement:\\n        #constraints:\\n          #- node.labels.volumes.${APP_NAME}_${ENV}_data == true\\n    healthcheck:\\n      interval: 10s\\n      retries: 3\\n      start_period: 1s\\n      test: bash -c 'curl http://localhost:3000 || exit 1'\\n      timeout: 5s\\n    configs:\\n      - source: config\\n        target: /app/config.yml\\n      - source: env\\n        target: /app/env.yml\\n    networks:\\n      db:\\n      prometheus:\\n      fe:\\n        aliases:\\n          - ${APP_NAME}_app\\n    secrets:\\n      #- staging-metis-hmac\\n      #- staging-magma-hmac\\n      - metrics-pw\\n      - user-hash-secret\\n      - source: db-pw\\n        target: db-password\\n      #- rollbar-access-token\\n\\n  app_fe:\\n    environment:\\n      - APP_NAME=${APP_NAME}\\n      - ${APP_ENV}=production\\n    image: etnaagent/${APP_NAME}_app_fe:${ENV}\\n    networks:\\n      - edge_bridge\\n      - fe\\n    volumes:\\n      - app_public:/app/public\\n      #- ${DATA_SOURCE}/${APP_NAME}/:/app/data/${APP_NAME}:ro\\n    # Notably, apache needs to start as super user but it immediately downgrades\\n    # its own user permissions after bootup.  See the includes.\\n    user: 0:3000 # su:browser\\n    configs:\\n      - source: browser.system.include\\n        target: /usr/opt/httpd.conf.d/browser.system.include\\n    deploy:\\n      labels:\\n        - autoupdate=true\\n      restart_policy:\\n        condition: none\\n      placement:\\n        constraints:\\n          - node.labels.volumes.${APP_NAME}_${ENV}_app_public == true\\n          #- node.labels.volumes.${APP_NAME}_${ENV}_data == true\\n\\n  app_assets_deployer:\\n    environment:\\n      - APP_NAME=${APP_NAME}\\n      - ${APP_ENV}=production\\n\\n    command: /bin/deploy.sh syncAssets -- true # Sync the assets to the shared data volume and stop.\\n    image: etnaagent/${APP_NAME}:${ENV}\\n    volumes:\\n      - app_public:/sync-assets:rw\\n\\n    deploy:\\n      labels:\\n        - autoupdate=true\\n      restart_policy:\\n        condition: none\\n      mode: global\\n      placement:\\n        max_replicas_per_node: 1\\n        constraints:\\n          - node.labels.volumes.${APP_NAME}_${ENV}_app_public == true\\n\\nvolumes:\\n  app_public:\\n  db:\\n    name: \\\"${APP_NAME}_${ENV}_db\\\"\\n\\nconfigs:\\n  browser.system.include:\\n    name: ${BROWSER_SYSTEM_INCLUDE:-browser.system.include}\\n    external: true\\n  config:\\n    external: true\\n    name: ${APP_CONFIG:-timur.staging.yml}\\n  env:\\n    external: true\\n    name: ${ENV_CONFIG:-etna.staging.yml}\\n\\nsecrets:\\n  user-hash-secret:\\n    external: true\\n  metrics-pw:\\n    external: true\\n  staging-metis-hmac:\\n    external: true\\n  staging-magma-hmac:\\n    external: true\\n  db-pw:\\n    external: true\\n    name: \\\"${APP_NAME}_${ENV}_db_password\\\"\\n\\nnetworks:\\n  fe:\\n  db:\\n  edge_bridge:\\n    external: true\\n  prometheus:\\n    external: true\"}","stderr":"","i":"10 /home/home/monoetna/swarm/swarm-keeper/lib/edit-config-deploy.recording"}
{"cmd":"http","args":["--check-status","--proxy=http:socks5h://127.0.0.1:9090","--proxy=https:socks5h://127.0.0.1:9090","PUT","https://portainer.dsco.ucsf.edu/api/stacks/36?endpointId=1","Authorization: Bearer xxx"],"result":"0","stdin":"{\"stackFileContent\":\"version: '3.8'\\n\\nservices:\\n  postgres:\\n    image: postgres:10.19\\n    environment:\\n      POSTGRES_DB: \\\"${APP_NAME}\\\"\\n      POSTGRES_PASSWORD_FILE: /run/secrets/password\\n      POSTGRES_USER: developer\\n    volumes:\\n      - db:/var/lib/postgresql/data\\n    deploy:\\n      placement:\\n        constraints:\\n          - node.labels.volumes.${APP_NAME}_${ENV}_db == true\\n    networks:\\n      - db\\n    secrets:\\n      - source: db-pw\\n        target: password\\n\\n  app:\\n    environment:\\n      - APP_NAME=${APP_NAME}\\n      - ${APP_ENV}=production\\n      - ETNA__PRODUCTION_FILE=/app/env.yml\\n      - ETNA__PRODUCTION__DB__PASSWORD_FILE=/run/secrets/db-password\\n      - ETNA__PRODUCTION__ROLLBAR__ACCESS_TOKEN=/run/secrets/rollbar-access-token\\n      - ETNA__PRODUCTION__USER_HASH_SECRET=/run/secrets/user-hash-secret\\n      #- ETNA__PRODUCTION__HMAC_KEYS__METIS_FILE=/run/secrets/staging-metis-hmac\\n      #- ETNA__PRODUCTION__HMAC_KEYS__MAGMA_FILE=/run/secrets/staging-metis-hmac\\n    command:\\n      - bash\\n      - -c\\n      - |\\n        set -e\\n        export METRICS_PW=\\\"$$(cat /run/secrets/metrics-pw)\\\"\\n        exec /bin/deploy.sh migrate -- /app/bin/puma.sh\\n    image: etnaagent/${APP_NAME}:${ENV}\\n    volumes:\\n      #- ${DATA_SOURCE}/${APP_NAME}/:/app/data/${APP_NAME}\\n      - /var/node_exporter/metrics.prom:/tmp/metrics.prom\\n    #user: ${APP_UID}:999 # metis:docker\\n    deploy:\\n      update_config:\\n        parallelism: 1\\n        order: start-first\\n      labels:\\n        - autoupdate=true\\n      #placement:\\n        #constraints:\\n          #- node.labels.volumes.${APP_NAME}_${ENV}_data == true\\n    healthcheck:\\n      interval: 10s\\n      retries: 3\\n      start_period: 1s\\n      test: bash -c 'curl http://localhost:3000 || exit 1'\\n      timeout: 5s\\n    configs:\\n      - source: config\\n        target: /app/config.yml\\n      - source: env\\n        target: /app/env.yml\\n    networks:\\n      db:\\n      prometheus:\\n      fe:\\n        aliases:\\n          - ${APP_NAME}_app\\n    secrets:\\n      #- staging-metis-hmac\\n      #- staging-magma-hmac\\n      - metrics-pw\\n      - user-hash-secret\\n      - source: db-pw\\n        target: db-password\\n      #- rollbar-access-token\\n\\n  app_fe:\\n    environment:\\n      - APP_NAME=${APP_NAME}\\n      - ${APP_ENV}=production\\n    image: etnaagent/${APP_NAME}_app_fe:${ENV}\\n    networks:\\n      - edge_bridge\\n      - fe\\n    volumes:\\n      - app_public:/app/public\\n      #- ${DATA_SOURCE}/${APP_NAME}/:/app/data/${APP_NAME}:ro\\n    # Notably, apache needs to start as super user but it immediately downgrades\\n    # its own user permissions after bootup.  See the includes.\\n    user: 0:3000 # su:browser\\n    configs:\\n      - source: browser.system.include\\n        target: /usr/opt/httpd.conf.d/browser.system.include\\n    deploy:\\n      labels:\\n        - autoupdate=true\\n      restart_policy:\\n        condition: none\\n      placement:\\n        constraints:\\n          - node.labels.volumes.${APP_NAME}_${ENV}_app_public == true\\n          #- node.labels.volumes.${APP_NAME}_${ENV}_data == true\\n\\n  app_assets_deployer:\\n    environment:\\n      - APP_NAME=${APP_NAME}\\n      - ${APP_ENV}=production\\n\\n    command: /bin/deploy.sh syncAssets -- true # Sync the assets to the shared data volume and stop.\\n    image: etnaagent/${APP_NAME}:${ENV}\\n    volumes:\\n      - app_public:/sync-assets:rw\\n\\n    deploy:\\n      labels:\\n        - autoupdate=true\\n      restart_policy:\\n        condition: none\\n      mode: global\\n      placement:\\n        max_replicas_per_node: 1\\n        constraints:\\n          - node.labels.volumes.${APP_NAME}_${ENV}_app_public == true\\n\\nvolumes:\\n  app_public:\\n  db:\\n    name: \\\"${APP_NAME}_${ENV}_db\\\"\\n\\nconfigs:\\n  browser.system.include:\\n    name: ${BROWSER_SYSTEM_INCLUDE:-browser.system.include}\\n    external: true\\n  config:\\n    external: true\\n    name: ${APP_CONFIG:-timur.staging.yml}\\n  env:\\n    external: true\\n    name: ${ENV_CONFIG:-etna.staging.yml}\\n\\nsecrets:\\n  user-hash-secret:\\n    external: true\\n  metrics-pw:\\n    external: true\\n  staging-metis-hmac:\\n    external: true\\n  staging-magma-hmac:\\n    external: true\\n  db-pw:\\n    external: true\\n    name: \\\"${APP_NAME}_${ENV}_db_password\\\"\\n\\nnetworks:\\n  fe:\\n  db:\\n  edge_bridge:\\n    external: true\\n  prometheus:\\n    external: true\",\"prune\":true,\"env\":[{\"name\":\"APP_NAME\",\"value\":\"timur\"},{\"name\":\"ENV\",\"value\":\"staging\"},{\"name\":\"APP_ENV\",\"value\":\"TIMUR_ENV\"},{\"name\":\"APP_CONFIG\",\"value\":\"timur.staging.yml_1641333336\"},{\"name\":\"ENV_CONFIG\",\"value\":\"etna.staging.yml\"}]}","stdout":"{\"Id\":36,\"Name\":\"timur-staging\",\"Type\":1,\"EndpointId\":1,\"SwarmId\":\"npcpmkzm9t2zp6gfq9o96wogc\",\"EntryPoint\":\"swarm/timur-staging.yml\",\"Env\":[{\"name\":\"APP_NAME\",\"value\":\"timur\"},{\"name\":\"ENV\",\"value\":\"staging\"},{\"name\":\"APP_ENV\",\"value\":\"TIMUR_ENV\"},{\"name\":\"APP_CONFIG\",\"value\":\"timur.staging.yml_1641333336\"},{\"name\":\"ENV_CONFIG\",\"value\":\"etna.staging.yml\"}],\"ResourceControl\":null,\"Status\":1,\"ProjectPath\":\"/data/compose/36\",\"CreationDate\":1641252002,\"CreatedBy\":\"etna\",\"UpdateDate\":1641333349,\"UpdatedBy\":\"etna\",\"AdditionalFiles\":[],\"AutoUpdate\":{\"Interval\":\"\",\"Webhook\":\"\",\"JobID\":\"\"},\"GitConfig\":{\"URL\":\"https://github.com/mountetna/monoetna.git\",\"ReferenceName\":\"refs/heads/swarm/stacks\",\"ConfigFilePath\":\"swarm/timur-staging.yml\",\"Authentication\":null,\"ConfigHash\":\"c0b611a840bdf74165e6042683b3cc57f7c57a25\"},\"Namespace\":\"\",\"IsComposeFormat\":false}","stderr":"","i":"11 /home/home/monoetna/swarm/swarm-keeper/lib/edit-config-deploy.recording"}
{"cmd":"http","args":["--check-status","--proxy=http:socks5h://127.0.0.1:9090","--proxy=https:socks5h://127.0.0.1:9090","GET","https://portainer.dsco.ucsf.edu/api/endpoints/1/docker/services","Authorization: Bearer xxx","filters=={\"label\":[\"com.docker.stack.namespace=timur-staging\"]}"],"result":"0","stdin":"","stdout":"[{\"CreatedAt\":\"2022-01-03T23:20:43.937407448Z\",\"Endpoint\":{\"Spec\":{\"Mode\":\"vip\"},\"VirtualIPs\":[{\"Addr\":\"10.0.4.98/24\",\"NetworkID\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Addr\":\"10.0.21.4/24\",\"NetworkID\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Addr\":\"10.0.19.4/24\",\"NetworkID\":\"r1u6c0bclbl6wyl1g8478x91v\"}]},\"ID\":\"9vxwqyzsiehxqhe2w9pyi39n4\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"PreviousSpec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Replicated\":{\"Replicas\":1}},\"Name\":\"timur-staging_app\",\"TaskTemplate\":{\"ContainerSpec\":{\"Args\":[\"bash\",\"-c\",\"set -e\\nexport METRICS_PW=\\\"$(cat /run/secrets/metrics-pw)\\\"\\nexec /bin/deploy.sh migrate -- /app/bin/puma.sh\\n\"],\"Configs\":[{\"ConfigID\":\"kyzf7xy96uv6ip5x65lgjf1wf\",\"ConfigName\":\"etna.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/env.yml\",\"UID\":\"0\"}},{\"ConfigID\":\"qn484g1c0bmaaw2n1fkueyc8e\",\"ConfigName\":\"timur.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/config.yml\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"ETNA__PRODUCTION_FILE=/app/env.yml\",\"ETNA__PRODUCTION__DB__PASSWORD_FILE=/run/secrets/db-password\",\"ETNA__PRODUCTION__ROLLBAR__ACCESS_TOKEN=/run/secrets/rollbar-access-token\",\"ETNA__PRODUCTION__USER_HASH_SECRET=/run/secrets/user-hash-secret\",\"TIMUR_ENV=production\"],\"Healthcheck\":{\"Interval\":10000000000,\"Retries\":3,\"StartPeriod\":1000000000,\"Test\":[\"CMD-SHELL\",\"bash -c 'curl http://localhost:3000 || exit 1'\"],\"Timeout\":5000000000},\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"/var/node_exporter/metrics.prom\",\"Target\":\"/tmp/metrics.prom\",\"Type\":\"bind\"}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"metrics-pw\",\"UID\":\"0\"},\"SecretID\":\"6adzt6tvilj2msj5m4vsy1eug\",\"SecretName\":\"metrics-pw\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"db-password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"user-hash-secret\",\"UID\":\"0\"},\"SecretID\":\"nqdn03euckbucxx1d7brr0gde\",\"SecretName\":\"user-hash-secret\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app\"],\"Target\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Aliases\":[\"app\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Aliases\":[\"timur_app\",\"app\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"Runtime\":\"container\"},\"UpdateConfig\":{\"FailureAction\":\"pause\",\"MaxFailureRatio\":0,\"Order\":\"start-first\",\"Parallelism\":1}},\"Spec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Replicated\":{\"Replicas\":1}},\"Name\":\"timur-staging_app\",\"TaskTemplate\":{\"ContainerSpec\":{\"Args\":[\"bash\",\"-c\",\"set -e\\nexport METRICS_PW=\\\"$(cat /run/secrets/metrics-pw)\\\"\\nexec /bin/deploy.sh migrate -- /app/bin/puma.sh\\n\"],\"Configs\":[{\"ConfigID\":\"kyzf7xy96uv6ip5x65lgjf1wf\",\"ConfigName\":\"etna.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/env.yml\",\"UID\":\"0\"}},{\"ConfigID\":\"v708ckky9705nzt3rv6gya39l\",\"ConfigName\":\"timur.staging.yml_1641333336\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/config.yml\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"ETNA__PRODUCTION_FILE=/app/env.yml\",\"ETNA__PRODUCTION__DB__PASSWORD_FILE=/run/secrets/db-password\",\"ETNA__PRODUCTION__ROLLBAR__ACCESS_TOKEN=/run/secrets/rollbar-access-token\",\"ETNA__PRODUCTION__USER_HASH_SECRET=/run/secrets/user-hash-secret\",\"TIMUR_ENV=production\"],\"Healthcheck\":{\"Interval\":10000000000,\"Retries\":3,\"StartPeriod\":1000000000,\"Test\":[\"CMD-SHELL\",\"bash -c 'curl http://localhost:3000 || exit 1'\"],\"Timeout\":5000000000},\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"/var/node_exporter/metrics.prom\",\"Target\":\"/tmp/metrics.prom\",\"Type\":\"bind\"}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"metrics-pw\",\"UID\":\"0\"},\"SecretID\":\"6adzt6tvilj2msj5m4vsy1eug\",\"SecretName\":\"metrics-pw\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"db-password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"user-hash-secret\",\"UID\":\"0\"},\"SecretID\":\"nqdn03euckbucxx1d7brr0gde\",\"SecretName\":\"user-hash-secret\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app\"],\"Target\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Aliases\":[\"app\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Aliases\":[\"timur_app\",\"app\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"Runtime\":\"container\"},\"UpdateConfig\":{\"FailureAction\":\"pause\",\"MaxFailureRatio\":0,\"Order\":\"start-first\",\"Parallelism\":1}},\"UpdateStatus\":{\"Message\":\"update in progress\",\"StartedAt\":\"2022-01-04T21:55:48.092741259Z\",\"State\":\"updating\"},\"UpdatedAt\":\"2022-01-04T21:55:48.09277362Z\",\"Version\":{\"Index\":10057278}},{\"CreatedAt\":\"2022-01-03T23:20:42.40988215Z\",\"Endpoint\":{\"Spec\":{\"Mode\":\"vip\"},\"VirtualIPs\":[{\"Addr\":\"10.0.21.2/24\",\"NetworkID\":\"c4ggc3aqae1ost27az5ri3nxz\"}]},\"ID\":\"l8z4f6ubn3a07ldj5mscerbog\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"PreviousSpec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"com.docker.stack.image\":\"postgres:10.19\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Replicated\":{\"Replicas\":1}},\"Name\":\"timur-staging_postgres\",\"TaskTemplate\":{\"ContainerSpec\":{\"Env\":[\"POSTGRES_DB=timur\",\"POSTGRES_PASSWORD_FILE=/run/secrets/password\",\"POSTGRES_USER=developer\"],\"Image\":\"postgres:10.19@sha256:ac0b1670c906d610741e93a517e6492979b7b0ad2127862c8a574ce265dc8804\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur_staging_db\",\"Target\":\"/var/lib/postgresql/data\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"postgres\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_db == true\"],\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"},{\"OS\":\"linux\"},{\"OS\":\"linux\"},{\"Architecture\":\"arm64\",\"OS\":\"linux\"},{\"Architecture\":\"386\",\"OS\":\"linux\"}]},\"Resources\":{},\"Runtime\":\"container\"}},\"Spec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"com.docker.stack.image\":\"postgres:10.19\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Replicated\":{\"Replicas\":1}},\"Name\":\"timur-staging_postgres\",\"TaskTemplate\":{\"ContainerSpec\":{\"Env\":[\"POSTGRES_DB=timur\",\"POSTGRES_PASSWORD_FILE=/run/secrets/password\",\"POSTGRES_USER=developer\"],\"Image\":\"postgres:10.19@sha256:ac0b1670c906d610741e93a517e6492979b7b0ad2127862c8a574ce265dc8804\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur_staging_db\",\"Target\":\"/var/lib/postgresql/data\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"postgres\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_db == true\"],\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"},{\"OS\":\"linux\"},{\"OS\":\"linux\"},{\"Architecture\":\"arm64\",\"OS\":\"linux\"},{\"Architecture\":\"386\",\"OS\":\"linux\"}]},\"Resources\":{},\"Runtime\":\"container\"}},\"UpdatedAt\":\"2022-01-04T21:55:46.585093564Z\",\"Version\":{\"Index\":10057273}},{\"CreatedAt\":\"2022-01-03T23:20:41.23437548Z\",\"Endpoint\":{\"Spec\":{\"Mode\":\"vip\"},\"VirtualIPs\":[{\"Addr\":\"10.0.20.2/24\",\"NetworkID\":\"m52fcusnqimfjqpnrnqrq34gs\"}]},\"ID\":\"qgjxwctj8zxsu5i6ux5bf40j2\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"PreviousSpec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Global\":{}},\"Name\":\"timur-staging_app_assets_deployer\",\"TaskTemplate\":{\"ContainerSpec\":{\"Args\":[\"/bin/deploy.sh\",\"syncAssets\",\"--\",\"true\"],\"Env\":[\"APP_NAME=timur\",\"TIMUR_ENV=production\"],\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur-staging_app_public\",\"Target\":\"/sync-assets\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null}},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app_assets_deployer\"],\"Target\":\"m52fcusnqimfjqpnrnqrq34gs\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_app_public == true\"],\"MaxReplicas\":1,\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"RestartPolicy\":{\"Condition\":\"none\",\"MaxAttempts\":0},\"Runtime\":\"container\"}},\"Spec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Global\":{}},\"Name\":\"timur-staging_app_assets_deployer\",\"TaskTemplate\":{\"ContainerSpec\":{\"Args\":[\"/bin/deploy.sh\",\"syncAssets\",\"--\",\"true\"],\"Env\":[\"APP_NAME=timur\",\"TIMUR_ENV=production\"],\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur-staging_app_public\",\"Target\":\"/sync-assets\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null}},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app_assets_deployer\"],\"Target\":\"m52fcusnqimfjqpnrnqrq34gs\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_app_public == true\"],\"MaxReplicas\":1,\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"RestartPolicy\":{\"Condition\":\"none\",\"MaxAttempts\":0},\"Runtime\":\"container\"}},\"UpdatedAt\":\"2022-01-04T21:55:45.413437387Z\",\"Version\":{\"Index\":10057271}},{\"CreatedAt\":\"2022-01-03T23:20:39.571206988Z\",\"Endpoint\":{\"Spec\":{\"Mode\":\"vip\"},\"VirtualIPs\":[{\"Addr\":\"10.0.3.214/24\",\"NetworkID\":\"wl9z0sp3su5p6za45i3klgtn6\"},{\"Addr\":\"10.0.19.2/24\",\"NetworkID\":\"r1u6c0bclbl6wyl1g8478x91v\"}]},\"ID\":\"y8mocvq0olbq809713v3ey9hd\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"PreviousSpec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur_app_fe:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Replicated\":{\"Replicas\":1}},\"Name\":\"timur-staging_app_fe\",\"TaskTemplate\":{\"ContainerSpec\":{\"Configs\":[{\"ConfigID\":\"efyi8cnelo5i809bnga85ozje\",\"ConfigName\":\"browser.system.include\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/usr/opt/httpd.conf.d/browser.system.include\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"TIMUR_ENV=production\"],\"Image\":\"etnaagent/timur_app_fe:staging@sha256:f3527445b7147a4fba3923abc4f308f12457ffcf120021c7d9a0e234e7e048a3\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur-staging_app_public\",\"Target\":\"/app/public\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"User\":\"0:3000\"},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app_fe\"],\"Target\":\"wl9z0sp3su5p6za45i3klgtn6\"},{\"Aliases\":[\"app_fe\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_app_public == true\"],\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"RestartPolicy\":{\"Condition\":\"none\",\"MaxAttempts\":0},\"Runtime\":\"container\"}},\"Spec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur_app_fe:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Replicated\":{\"Replicas\":1}},\"Name\":\"timur-staging_app_fe\",\"TaskTemplate\":{\"ContainerSpec\":{\"Configs\":[{\"ConfigID\":\"efyi8cnelo5i809bnga85ozje\",\"ConfigName\":\"browser.system.include\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/usr/opt/httpd.conf.d/browser.system.include\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"TIMUR_ENV=production\"],\"Image\":\"etnaagent/timur_app_fe:staging@sha256:f3527445b7147a4fba3923abc4f308f12457ffcf120021c7d9a0e234e7e048a3\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur-staging_app_public\",\"Target\":\"/app/public\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"User\":\"0:3000\"},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app_fe\"],\"Target\":\"wl9z0sp3su5p6za45i3klgtn6\"},{\"Aliases\":[\"app_fe\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_app_public == true\"],\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"RestartPolicy\":{\"Condition\":\"none\",\"MaxAttempts\":0},\"Runtime\":\"container\"}},\"UpdatedAt\":\"2022-01-04T21:55:49.683887969Z\",\"Version\":{\"Index\":10057286}}]","stderr":"","i":"12 /home/home/monoetna/swarm/swarm-keeper/lib/edit-config-deploy.recording"}
{"cmd":"http","args":["--check-status","--proxy=http:socks5h://127.0.0.1:9090","--proxy=https:socks5h://127.0.0.1:9090","GET","https://portainer.dsco.ucsf.edu/api/endpoints/1/docker/services","Authorization: Bearer xxx","filters=={\"name\":[\"timur-staging_app\"]}"],"result":"0","stdin":"","stdout":"[{\"CreatedAt\":\"2022-01-03T23:20:43.937407448Z\",\"Endpoint\":{\"Spec\":{\"Mode\":\"vip\"},\"VirtualIPs\":[{\"Addr\":\"10.0.4.98/24\",\"NetworkID\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Addr\":\"10.0.21.4/24\",\"NetworkID\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Addr\":\"10.0.19.4/24\",\"NetworkID\":\"r1u6c0bclbl6wyl1g8478x91v\"}]},\"ID\":\"9vxwqyzsiehxqhe2w9pyi39n4\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"PreviousSpec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Replicated\":{\"Replicas\":1}},\"Name\":\"timur-staging_app\",\"TaskTemplate\":{\"ContainerSpec\":{\"Args\":[\"bash\",\"-c\",\"set -e\\nexport METRICS_PW=\\\"$(cat /run/secrets/metrics-pw)\\\"\\nexec /bin/deploy.sh migrate -- /app/bin/puma.sh\\n\"],\"Configs\":[{\"ConfigID\":\"kyzf7xy96uv6ip5x65lgjf1wf\",\"ConfigName\":\"etna.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/env.yml\",\"UID\":\"0\"}},{\"ConfigID\":\"qn484g1c0bmaaw2n1fkueyc8e\",\"ConfigName\":\"timur.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/config.yml\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"ETNA__PRODUCTION_FILE=/app/env.yml\",\"ETNA__PRODUCTION__DB__PASSWORD_FILE=/run/secrets/db-password\",\"ETNA__PRODUCTION__ROLLBAR__ACCESS_TOKEN=/run/secrets/rollbar-access-token\",\"ETNA__PRODUCTION__USER_HASH_SECRET=/run/secrets/user-hash-secret\",\"TIMUR_ENV=production\"],\"Healthcheck\":{\"Interval\":10000000000,\"Retries\":3,\"StartPeriod\":1000000000,\"Test\":[\"CMD-SHELL\",\"bash -c 'curl http://localhost:3000 || exit 1'\"],\"Timeout\":5000000000},\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"/var/node_exporter/metrics.prom\",\"Target\":\"/tmp/metrics.prom\",\"Type\":\"bind\"}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"metrics-pw\",\"UID\":\"0\"},\"SecretID\":\"6adzt6tvilj2msj5m4vsy1eug\",\"SecretName\":\"metrics-pw\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"db-password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"user-hash-secret\",\"UID\":\"0\"},\"SecretID\":\"nqdn03euckbucxx1d7brr0gde\",\"SecretName\":\"user-hash-secret\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app\"],\"Target\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Aliases\":[\"app\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Aliases\":[\"timur_app\",\"app\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"Runtime\":\"container\"},\"UpdateConfig\":{\"FailureAction\":\"pause\",\"MaxFailureRatio\":0,\"Order\":\"start-first\",\"Parallelism\":1}},\"Spec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Replicated\":{\"Replicas\":1}},\"Name\":\"timur-staging_app\",\"TaskTemplate\":{\"ContainerSpec\":{\"Args\":[\"bash\",\"-c\",\"set -e\\nexport METRICS_PW=\\\"$(cat /run/secrets/metrics-pw)\\\"\\nexec /bin/deploy.sh migrate -- /app/bin/puma.sh\\n\"],\"Configs\":[{\"ConfigID\":\"kyzf7xy96uv6ip5x65lgjf1wf\",\"ConfigName\":\"etna.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/env.yml\",\"UID\":\"0\"}},{\"ConfigID\":\"v708ckky9705nzt3rv6gya39l\",\"ConfigName\":\"timur.staging.yml_1641333336\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/config.yml\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"ETNA__PRODUCTION_FILE=/app/env.yml\",\"ETNA__PRODUCTION__DB__PASSWORD_FILE=/run/secrets/db-password\",\"ETNA__PRODUCTION__ROLLBAR__ACCESS_TOKEN=/run/secrets/rollbar-access-token\",\"ETNA__PRODUCTION__USER_HASH_SECRET=/run/secrets/user-hash-secret\",\"TIMUR_ENV=production\"],\"Healthcheck\":{\"Interval\":10000000000,\"Retries\":3,\"StartPeriod\":1000000000,\"Test\":[\"CMD-SHELL\",\"bash -c 'curl http://localhost:3000 || exit 1'\"],\"Timeout\":5000000000},\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"/var/node_exporter/metrics.prom\",\"Target\":\"/tmp/metrics.prom\",\"Type\":\"bind\"}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"metrics-pw\",\"UID\":\"0\"},\"SecretID\":\"6adzt6tvilj2msj5m4vsy1eug\",\"SecretName\":\"metrics-pw\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"db-password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"user-hash-secret\",\"UID\":\"0\"},\"SecretID\":\"nqdn03euckbucxx1d7brr0gde\",\"SecretName\":\"user-hash-secret\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app\"],\"Target\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Aliases\":[\"app\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Aliases\":[\"timur_app\",\"app\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"Runtime\":\"container\"},\"UpdateConfig\":{\"FailureAction\":\"pause\",\"MaxFailureRatio\":0,\"Order\":\"start-first\",\"Parallelism\":1}},\"UpdateStatus\":{\"Message\":\"update in progress\",\"StartedAt\":\"2022-01-04T21:55:48.092741259Z\",\"State\":\"updating\"},\"UpdatedAt\":\"2022-01-04T21:55:48.09277362Z\",\"Version\":{\"Index\":10057278}},{\"CreatedAt\":\"2022-01-03T23:20:41.23437548Z\",\"Endpoint\":{\"Spec\":{\"Mode\":\"vip\"},\"VirtualIPs\":[{\"Addr\":\"10.0.20.2/24\",\"NetworkID\":\"m52fcusnqimfjqpnrnqrq34gs\"}]},\"ID\":\"qgjxwctj8zxsu5i6ux5bf40j2\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"PreviousSpec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Global\":{}},\"Name\":\"timur-staging_app_assets_deployer\",\"TaskTemplate\":{\"ContainerSpec\":{\"Args\":[\"/bin/deploy.sh\",\"syncAssets\",\"--\",\"true\"],\"Env\":[\"APP_NAME=timur\",\"TIMUR_ENV=production\"],\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur-staging_app_public\",\"Target\":\"/sync-assets\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null}},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app_assets_deployer\"],\"Target\":\"m52fcusnqimfjqpnrnqrq34gs\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_app_public == true\"],\"MaxReplicas\":1,\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"RestartPolicy\":{\"Condition\":\"none\",\"MaxAttempts\":0},\"Runtime\":\"container\"}},\"Spec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Global\":{}},\"Name\":\"timur-staging_app_assets_deployer\",\"TaskTemplate\":{\"ContainerSpec\":{\"Args\":[\"/bin/deploy.sh\",\"syncAssets\",\"--\",\"true\"],\"Env\":[\"APP_NAME=timur\",\"TIMUR_ENV=production\"],\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur-staging_app_public\",\"Target\":\"/sync-assets\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null}},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app_assets_deployer\"],\"Target\":\"m52fcusnqimfjqpnrnqrq34gs\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_app_public == true\"],\"MaxReplicas\":1,\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"RestartPolicy\":{\"Condition\":\"none\",\"MaxAttempts\":0},\"Runtime\":\"container\"}},\"UpdatedAt\":\"2022-01-04T21:55:45.413437387Z\",\"Version\":{\"Index\":10057271}},{\"CreatedAt\":\"2022-01-03T23:20:39.571206988Z\",\"Endpoint\":{\"Spec\":{\"Mode\":\"vip\"},\"VirtualIPs\":[{\"Addr\":\"10.0.3.214/24\",\"NetworkID\":\"wl9z0sp3su5p6za45i3klgtn6\"},{\"Addr\":\"10.0.19.2/24\",\"NetworkID\":\"r1u6c0bclbl6wyl1g8478x91v\"}]},\"ID\":\"y8mocvq0olbq809713v3ey9hd\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"PreviousSpec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur_app_fe:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Replicated\":{\"Replicas\":1}},\"Name\":\"timur-staging_app_fe\",\"TaskTemplate\":{\"ContainerSpec\":{\"Configs\":[{\"ConfigID\":\"efyi8cnelo5i809bnga85ozje\",\"ConfigName\":\"browser.system.include\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/usr/opt/httpd.conf.d/browser.system.include\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"TIMUR_ENV=production\"],\"Image\":\"etnaagent/timur_app_fe:staging@sha256:f3527445b7147a4fba3923abc4f308f12457ffcf120021c7d9a0e234e7e048a3\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur-staging_app_public\",\"Target\":\"/app/public\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"User\":\"0:3000\"},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app_fe\"],\"Target\":\"wl9z0sp3su5p6za45i3klgtn6\"},{\"Aliases\":[\"app_fe\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_app_public == true\"],\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"RestartPolicy\":{\"Condition\":\"none\",\"MaxAttempts\":0},\"Runtime\":\"container\"}},\"Spec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur_app_fe:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Replicated\":{\"Replicas\":1}},\"Name\":\"timur-staging_app_fe\",\"TaskTemplate\":{\"ContainerSpec\":{\"Configs\":[{\"ConfigID\":\"efyi8cnelo5i809bnga85ozje\",\"ConfigName\":\"browser.system.include\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/usr/opt/httpd.conf.d/browser.system.include\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"TIMUR_ENV=production\"],\"Image\":\"etnaagent/timur_app_fe:staging@sha256:f3527445b7147a4fba3923abc4f308f12457ffcf120021c7d9a0e234e7e048a3\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur-staging_app_public\",\"Target\":\"/app/public\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"User\":\"0:3000\"},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app_fe\"],\"Target\":\"wl9z0sp3su5p6za45i3klgtn6\"},{\"Aliases\":[\"app_fe\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_app_public == true\"],\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"RestartPolicy\":{\"Condition\":\"none\",\"MaxAttempts\":0},\"Runtime\":\"container\"}},\"UpdatedAt\":\"2022-01-04T21:55:49.683887969Z\",\"Version\":{\"Index\":10057286}}]","stderr":"","i":"13 /home/home/monoetna/swarm/swarm-keeper/lib/edit-config-deploy.recording"}
{"cmd":"http","args":["--check-status","--proxy=http:socks5h://127.0.0.1:9090","--proxy=https:socks5h://127.0.0.1:9090","GET","https://portainer.dsco.ucsf.edu/api/endpoints/1/docker/tasks","Authorization: Bearer xxx","filters=={\"service\":[\"timur-staging_app\"],\"desired-state\":[\"shutdown\"]}"],"result":"0","stdin":"","stdout":"[{\"CreatedAt\":\"2022-01-04T21:52:36.602750303Z\",\"DesiredState\":\"shutdown\",\"ID\":\"1mn2vkae0he34q7mtwtwanpak\",\"Labels\":{},\"NetworksAttachments\":[{\"Addresses\":[\"10.0.4.197/24\"],\"Network\":{\"CreatedAt\":\"2021-06-12T00:04:08.851633906Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4100\"}},\"ID\":\"pwqf514t16rtmjpq62shyib7h\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.4.1\",\"Subnet\":\"10.0.4.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"Attachable\":true,\"DriverConfiguration\":{\"Name\":\"overlay\"},\"IPAMOptions\":{\"Driver\":{\"Name\":\"default\"}},\"Labels\":{},\"Name\":\"prometheus\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2021-12-28T20:39:20.053403246Z\",\"Version\":{\"Index\":8635318}}},{\"Addresses\":[\"10.0.21.9/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.74850188Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4117\"}},\"ID\":\"c4ggc3aqae1ost27az5ri3nxz\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.21.1\",\"Subnet\":\"10.0.21.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_db\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.751592118Z\",\"Version\":{\"Index\":9866157}}},{\"Addresses\":[\"10.0.19.6/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.712710437Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4115\"}},\"ID\":\"r1u6c0bclbl6wyl1g8478x91v\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.19.1\",\"Subnet\":\"10.0.19.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_fe\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.715086232Z\",\"Version\":{\"Index\":9866153}}}],\"NodeID\":\"3e634fut8umris4hqblxbgmk0\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"ServiceID\":\"9vxwqyzsiehxqhe2w9pyi39n4\",\"Slot\":1,\"Spec\":{\"ContainerSpec\":{\"Args\":[\"bash\",\"-c\",\"set -e\\nexport METRICS_PW=\\\"$(cat /run/secrets/metrics-pw)\\\"\\nexec /bin/deploy.sh migrate -- /app/bin/puma.sh\\n\"],\"Configs\":[{\"ConfigID\":\"kyzf7xy96uv6ip5x65lgjf1wf\",\"ConfigName\":\"etna.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/env.yml\",\"UID\":\"0\"}},{\"ConfigID\":\"sh4pln0b83bunf130n8v9e42n\",\"ConfigName\":\"timur.staging.yml_1641333148\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/config.yml\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"ETNA__PRODUCTION_FILE=/app/env.yml\",\"ETNA__PRODUCTION__DB__PASSWORD_FILE=/run/secrets/db-password\",\"ETNA__PRODUCTION__ROLLBAR__ACCESS_TOKEN=/run/secrets/rollbar-access-token\",\"ETNA__PRODUCTION__USER_HASH_SECRET=/run/secrets/user-hash-secret\",\"TIMUR_ENV=production\"],\"Healthcheck\":{\"Interval\":10000000000,\"Retries\":3,\"StartPeriod\":1000000000,\"Test\":[\"CMD-SHELL\",\"bash -c 'curl http://localhost:3000 || exit 1'\"],\"Timeout\":5000000000},\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"/var/node_exporter/metrics.prom\",\"Target\":\"/tmp/metrics.prom\",\"Type\":\"bind\"}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"metrics-pw\",\"UID\":\"0\"},\"SecretID\":\"6adzt6tvilj2msj5m4vsy1eug\",\"SecretName\":\"metrics-pw\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"db-password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"user-hash-secret\",\"UID\":\"0\"},\"SecretID\":\"nqdn03euckbucxx1d7brr0gde\",\"SecretName\":\"user-hash-secret\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app\"],\"Target\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Aliases\":[\"app\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Aliases\":[\"timur_app\",\"app\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{}},\"Status\":{\"ContainerStatus\":{\"ContainerID\":\"aaca6f0fdb21b4b33d0e72c46114d197cf1590889a946dfd4c0e84ab88573f31\",\"ExitCode\":1,\"PID\":0},\"Message\":\"shutdown\",\"PortStatus\":{},\"State\":\"shutdown\",\"Timestamp\":\"2022-01-04T21:53:41.895541058Z\"},\"UpdatedAt\":\"2022-01-04T21:53:41.93158238Z\",\"Version\":{\"Index\":10056975}},{\"CreatedAt\":\"2022-01-04T21:48:34.869891753Z\",\"DesiredState\":\"shutdown\",\"ID\":\"fz7aup1fu575twznk2a7lhqkd\",\"Labels\":{},\"NetworksAttachments\":[{\"Addresses\":[\"10.0.4.195/24\"],\"Network\":{\"CreatedAt\":\"2021-06-12T00:04:08.851633906Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4100\"}},\"ID\":\"pwqf514t16rtmjpq62shyib7h\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.4.1\",\"Subnet\":\"10.0.4.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"Attachable\":true,\"DriverConfiguration\":{\"Name\":\"overlay\"},\"IPAMOptions\":{\"Driver\":{\"Name\":\"default\"}},\"Labels\":{},\"Name\":\"prometheus\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2021-12-28T20:39:20.053403246Z\",\"Version\":{\"Index\":8635318}}},{\"Addresses\":[\"10.0.21.7/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.74850188Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4117\"}},\"ID\":\"c4ggc3aqae1ost27az5ri3nxz\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.21.1\",\"Subnet\":\"10.0.21.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_db\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.751592118Z\",\"Version\":{\"Index\":9866157}}},{\"Addresses\":[\"10.0.19.254/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.712710437Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4115\"}},\"ID\":\"r1u6c0bclbl6wyl1g8478x91v\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.19.1\",\"Subnet\":\"10.0.19.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_fe\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.715086232Z\",\"Version\":{\"Index\":9866153}}}],\"NodeID\":\"ybj02s79vhfv0zrcmwjecr3d6\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"ServiceID\":\"9vxwqyzsiehxqhe2w9pyi39n4\",\"Slot\":1,\"Spec\":{\"ContainerSpec\":{\"Args\":[\"bash\",\"-c\",\"set -e\\nexport METRICS_PW=\\\"$(cat /run/secrets/metrics-pw)\\\"\\nexec /bin/deploy.sh migrate -- /app/bin/puma.sh\\n\"],\"Configs\":[{\"ConfigID\":\"kyzf7xy96uv6ip5x65lgjf1wf\",\"ConfigName\":\"etna.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/env.yml\",\"UID\":\"0\"}},{\"ConfigID\":\"x4akplf1vv5h2j46f2hunod67\",\"ConfigName\":\"timur.staging.yml_1641325556_1641332269\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/config.yml\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"ETNA__PRODUCTION_FILE=/app/env.yml\",\"ETNA__PRODUCTION__DB__PASSWORD_FILE=/run/secrets/db-password\",\"ETNA__PRODUCTION__ROLLBAR__ACCESS_TOKEN=/run/secrets/rollbar-access-token\",\"ETNA__PRODUCTION__USER_HASH_SECRET=/run/secrets/user-hash-secret\",\"TIMUR_ENV=production\"],\"Healthcheck\":{\"Interval\":10000000000,\"Retries\":3,\"StartPeriod\":1000000000,\"Test\":[\"CMD-SHELL\",\"bash -c 'curl http://localhost:3000 || exit 1'\"],\"Timeout\":5000000000},\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"/var/node_exporter/metrics.prom\",\"Target\":\"/tmp/metrics.prom\",\"Type\":\"bind\"}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"metrics-pw\",\"UID\":\"0\"},\"SecretID\":\"6adzt6tvilj2msj5m4vsy1eug\",\"SecretName\":\"metrics-pw\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"db-password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"user-hash-secret\",\"UID\":\"0\"},\"SecretID\":\"nqdn03euckbucxx1d7brr0gde\",\"SecretName\":\"user-hash-secret\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app\"],\"Target\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Aliases\":[\"app\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Aliases\":[\"timur_app\",\"app\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{}},\"Status\":{\"ContainerStatus\":{\"ContainerID\":\"28e15f27e3274630586d2342b0a25983920365a860a2ff6745fd158f1d9a5a6b\",\"ExitCode\":1,\"PID\":0},\"Message\":\"shutdown\",\"PortStatus\":{},\"State\":\"shutdown\",\"Timestamp\":\"2022-01-04T21:52:55.827606933Z\"},\"UpdatedAt\":\"2022-01-04T21:52:55.864189786Z\",\"Version\":{\"Index\":10056849}},{\"CreatedAt\":\"2022-01-04T21:47:49.357311198Z\",\"DesiredState\":\"shutdown\",\"ID\":\"wbizxzjv0fml602niqyv4sqem\",\"Labels\":{},\"NetworksAttachments\":[{\"Addresses\":[\"10.0.4.194/24\"],\"Network\":{\"CreatedAt\":\"2021-06-12T00:04:08.851633906Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4100\"}},\"ID\":\"pwqf514t16rtmjpq62shyib7h\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.4.1\",\"Subnet\":\"10.0.4.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"Attachable\":true,\"DriverConfiguration\":{\"Name\":\"overlay\"},\"IPAMOptions\":{\"Driver\":{\"Name\":\"default\"}},\"Labels\":{},\"Name\":\"prometheus\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2021-12-28T20:39:20.053403246Z\",\"Version\":{\"Index\":8635318}}},{\"Addresses\":[\"10.0.21.5/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.74850188Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4117\"}},\"ID\":\"c4ggc3aqae1ost27az5ri3nxz\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.21.1\",\"Subnet\":\"10.0.21.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_db\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.751592118Z\",\"Version\":{\"Index\":9866157}}},{\"Addresses\":[\"10.0.19.252/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.712710437Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4115\"}},\"ID\":\"r1u6c0bclbl6wyl1g8478x91v\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.19.1\",\"Subnet\":\"10.0.19.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_fe\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.715086232Z\",\"Version\":{\"Index\":9866153}}}],\"NodeID\":\"3e634fut8umris4hqblxbgmk0\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"ServiceID\":\"9vxwqyzsiehxqhe2w9pyi39n4\",\"Slot\":1,\"Spec\":{\"ContainerSpec\":{\"Args\":[\"bash\",\"-c\",\"set -e\\nexport METRICS_PW=\\\"$(cat /run/secrets/metrics-pw)\\\"\\nexec /bin/deploy.sh migrate -- /app/bin/puma.sh\\n\"],\"Configs\":[{\"ConfigID\":\"kyzf7xy96uv6ip5x65lgjf1wf\",\"ConfigName\":\"etna.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/env.yml\",\"UID\":\"0\"}},{\"ConfigID\":\"jl1ceyd1c6mt3ei4umpf5ap06\",\"ConfigName\":\"timur.staging.yml_1641325556_1641332269_1641332856\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/config.yml\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"ETNA__PRODUCTION_FILE=/app/env.yml\",\"ETNA__PRODUCTION__DB__PASSWORD_FILE=/run/secrets/db-password\",\"ETNA__PRODUCTION__ROLLBAR__ACCESS_TOKEN=/run/secrets/rollbar-access-token\",\"ETNA__PRODUCTION__USER_HASH_SECRET=/run/secrets/user-hash-secret\",\"TIMUR_ENV=production\"],\"Healthcheck\":{\"Interval\":10000000000,\"Retries\":3,\"StartPeriod\":1000000000,\"Test\":[\"CMD-SHELL\",\"bash -c 'curl http://localhost:3000 || exit 1'\"],\"Timeout\":5000000000},\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"/var/node_exporter/metrics.prom\",\"Target\":\"/tmp/metrics.prom\",\"Type\":\"bind\"}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"metrics-pw\",\"UID\":\"0\"},\"SecretID\":\"6adzt6tvilj2msj5m4vsy1eug\",\"SecretName\":\"metrics-pw\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"db-password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"user-hash-secret\",\"UID\":\"0\"},\"SecretID\":\"nqdn03euckbucxx1d7brr0gde\",\"SecretName\":\"user-hash-secret\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app\"],\"Target\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Aliases\":[\"app\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Aliases\":[\"timur_app\",\"app\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{}},\"Status\":{\"ContainerStatus\":{\"ContainerID\":\"95a714f8efd181042dc60a29236337bc07a92389c91d8df81e3eac038d2ccddb\",\"ExitCode\":1,\"PID\":0},\"Message\":\"shutdown\",\"PortStatus\":{},\"State\":\"shutdown\",\"Timestamp\":\"2022-01-04T21:48:55.80395479Z\"},\"UpdatedAt\":\"2022-01-04T21:48:55.829545767Z\",\"Version\":{\"Index\":10056263}}]","stderr":"","i":"14 /home/home/monoetna/swarm/swarm-keeper/lib/edit-config-deploy.recording"}
{"cmd":"http","args":["--check-status","--proxy=http:socks5h://127.0.0.1:9090","--proxy=https:socks5h://127.0.0.1:9090","GET","https://portainer.dsco.ucsf.edu/api/endpoints/1/docker/services","Authorization: Bearer xxx","filters=={\"name\":[\"timur-staging_app\"]}"],"result":"0","stdin":"","stdout":"[{\"CreatedAt\":\"2022-01-03T23:20:43.937407448Z\",\"Endpoint\":{\"Spec\":{\"Mode\":\"vip\"},\"VirtualIPs\":[{\"Addr\":\"10.0.4.98/24\",\"NetworkID\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Addr\":\"10.0.21.4/24\",\"NetworkID\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Addr\":\"10.0.19.4/24\",\"NetworkID\":\"r1u6c0bclbl6wyl1g8478x91v\"}]},\"ID\":\"9vxwqyzsiehxqhe2w9pyi39n4\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"PreviousSpec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Replicated\":{\"Replicas\":1}},\"Name\":\"timur-staging_app\",\"TaskTemplate\":{\"ContainerSpec\":{\"Args\":[\"bash\",\"-c\",\"set -e\\nexport METRICS_PW=\\\"$(cat /run/secrets/metrics-pw)\\\"\\nexec /bin/deploy.sh migrate -- /app/bin/puma.sh\\n\"],\"Configs\":[{\"ConfigID\":\"kyzf7xy96uv6ip5x65lgjf1wf\",\"ConfigName\":\"etna.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/env.yml\",\"UID\":\"0\"}},{\"ConfigID\":\"qn484g1c0bmaaw2n1fkueyc8e\",\"ConfigName\":\"timur.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/config.yml\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"ETNA__PRODUCTION_FILE=/app/env.yml\",\"ETNA__PRODUCTION__DB__PASSWORD_FILE=/run/secrets/db-password\",\"ETNA__PRODUCTION__ROLLBAR__ACCESS_TOKEN=/run/secrets/rollbar-access-token\",\"ETNA__PRODUCTION__USER_HASH_SECRET=/run/secrets/user-hash-secret\",\"TIMUR_ENV=production\"],\"Healthcheck\":{\"Interval\":10000000000,\"Retries\":3,\"StartPeriod\":1000000000,\"Test\":[\"CMD-SHELL\",\"bash -c 'curl http://localhost:3000 || exit 1'\"],\"Timeout\":5000000000},\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"/var/node_exporter/metrics.prom\",\"Target\":\"/tmp/metrics.prom\",\"Type\":\"bind\"}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"metrics-pw\",\"UID\":\"0\"},\"SecretID\":\"6adzt6tvilj2msj5m4vsy1eug\",\"SecretName\":\"metrics-pw\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"db-password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"user-hash-secret\",\"UID\":\"0\"},\"SecretID\":\"nqdn03euckbucxx1d7brr0gde\",\"SecretName\":\"user-hash-secret\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app\"],\"Target\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Aliases\":[\"app\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Aliases\":[\"timur_app\",\"app\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"Runtime\":\"container\"},\"UpdateConfig\":{\"FailureAction\":\"pause\",\"MaxFailureRatio\":0,\"Order\":\"start-first\",\"Parallelism\":1}},\"Spec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Replicated\":{\"Replicas\":1}},\"Name\":\"timur-staging_app\",\"TaskTemplate\":{\"ContainerSpec\":{\"Args\":[\"bash\",\"-c\",\"set -e\\nexport METRICS_PW=\\\"$(cat /run/secrets/metrics-pw)\\\"\\nexec /bin/deploy.sh migrate -- /app/bin/puma.sh\\n\"],\"Configs\":[{\"ConfigID\":\"kyzf7xy96uv6ip5x65lgjf1wf\",\"ConfigName\":\"etna.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/env.yml\",\"UID\":\"0\"}},{\"ConfigID\":\"v708ckky9705nzt3rv6gya39l\",\"ConfigName\":\"timur.staging.yml_1641333336\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/config.yml\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"ETNA__PRODUCTION_FILE=/app/env.yml\",\"ETNA__PRODUCTION__DB__PASSWORD_FILE=/run/secrets/db-password\",\"ETNA__PRODUCTION__ROLLBAR__ACCESS_TOKEN=/run/secrets/rollbar-access-token\",\"ETNA__PRODUCTION__USER_HASH_SECRET=/run/secrets/user-hash-secret\",\"TIMUR_ENV=production\"],\"Healthcheck\":{\"Interval\":10000000000,\"Retries\":3,\"StartPeriod\":1000000000,\"Test\":[\"CMD-SHELL\",\"bash -c 'curl http://localhost:3000 || exit 1'\"],\"Timeout\":5000000000},\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"/var/node_exporter/metrics.prom\",\"Target\":\"/tmp/metrics.prom\",\"Type\":\"bind\"}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"metrics-pw\",\"UID\":\"0\"},\"SecretID\":\"6adzt6tvilj2msj5m4vsy1eug\",\"SecretName\":\"metrics-pw\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"db-password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"user-hash-secret\",\"UID\":\"0\"},\"SecretID\":\"nqdn03euckbucxx1d7brr0gde\",\"SecretName\":\"user-hash-secret\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app\"],\"Target\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Aliases\":[\"app\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Aliases\":[\"timur_app\",\"app\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"Runtime\":\"container\"},\"UpdateConfig\":{\"FailureAction\":\"pause\",\"MaxFailureRatio\":0,\"Order\":\"start-first\",\"Parallelism\":1}},\"UpdateStatus\":{\"Message\":\"update in progress\",\"StartedAt\":\"2022-01-04T21:55:48.092741259Z\",\"State\":\"updating\"},\"UpdatedAt\":\"2022-01-04T21:55:48.09277362Z\",\"Version\":{\"Index\":10057278}},{\"CreatedAt\":\"2022-01-03T23:20:41.23437548Z\",\"Endpoint\":{\"Spec\":{\"Mode\":\"vip\"},\"VirtualIPs\":[{\"Addr\":\"10.0.20.2/24\",\"NetworkID\":\"m52fcusnqimfjqpnrnqrq34gs\"}]},\"ID\":\"qgjxwctj8zxsu5i6ux5bf40j2\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"PreviousSpec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Global\":{}},\"Name\":\"timur-staging_app_assets_deployer\",\"TaskTemplate\":{\"ContainerSpec\":{\"Args\":[\"/bin/deploy.sh\",\"syncAssets\",\"--\",\"true\"],\"Env\":[\"APP_NAME=timur\",\"TIMUR_ENV=production\"],\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur-staging_app_public\",\"Target\":\"/sync-assets\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null}},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app_assets_deployer\"],\"Target\":\"m52fcusnqimfjqpnrnqrq34gs\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_app_public == true\"],\"MaxReplicas\":1,\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"RestartPolicy\":{\"Condition\":\"none\",\"MaxAttempts\":0},\"Runtime\":\"container\"}},\"Spec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Global\":{}},\"Name\":\"timur-staging_app_assets_deployer\",\"TaskTemplate\":{\"ContainerSpec\":{\"Args\":[\"/bin/deploy.sh\",\"syncAssets\",\"--\",\"true\"],\"Env\":[\"APP_NAME=timur\",\"TIMUR_ENV=production\"],\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur-staging_app_public\",\"Target\":\"/sync-assets\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null}},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app_assets_deployer\"],\"Target\":\"m52fcusnqimfjqpnrnqrq34gs\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_app_public == true\"],\"MaxReplicas\":1,\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"RestartPolicy\":{\"Condition\":\"none\",\"MaxAttempts\":0},\"Runtime\":\"container\"}},\"UpdatedAt\":\"2022-01-04T21:55:45.413437387Z\",\"Version\":{\"Index\":10057271}},{\"CreatedAt\":\"2022-01-03T23:20:39.571206988Z\",\"Endpoint\":{\"Spec\":{\"Mode\":\"vip\"},\"VirtualIPs\":[{\"Addr\":\"10.0.3.214/24\",\"NetworkID\":\"wl9z0sp3su5p6za45i3klgtn6\"},{\"Addr\":\"10.0.19.2/24\",\"NetworkID\":\"r1u6c0bclbl6wyl1g8478x91v\"}]},\"ID\":\"y8mocvq0olbq809713v3ey9hd\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"PreviousSpec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur_app_fe:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Replicated\":{\"Replicas\":1}},\"Name\":\"timur-staging_app_fe\",\"TaskTemplate\":{\"ContainerSpec\":{\"Configs\":[{\"ConfigID\":\"efyi8cnelo5i809bnga85ozje\",\"ConfigName\":\"browser.system.include\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/usr/opt/httpd.conf.d/browser.system.include\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"TIMUR_ENV=production\"],\"Image\":\"etnaagent/timur_app_fe:staging@sha256:f3527445b7147a4fba3923abc4f308f12457ffcf120021c7d9a0e234e7e048a3\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur-staging_app_public\",\"Target\":\"/app/public\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"User\":\"0:3000\"},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app_fe\"],\"Target\":\"wl9z0sp3su5p6za45i3klgtn6\"},{\"Aliases\":[\"app_fe\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_app_public == true\"],\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"RestartPolicy\":{\"Condition\":\"none\",\"MaxAttempts\":0},\"Runtime\":\"container\"}},\"Spec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur_app_fe:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Replicated\":{\"Replicas\":1}},\"Name\":\"timur-staging_app_fe\",\"TaskTemplate\":{\"ContainerSpec\":{\"Configs\":[{\"ConfigID\":\"efyi8cnelo5i809bnga85ozje\",\"ConfigName\":\"browser.system.include\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/usr/opt/httpd.conf.d/browser.system.include\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"TIMUR_ENV=production\"],\"Image\":\"etnaagent/timur_app_fe:staging@sha256:f3527445b7147a4fba3923abc4f308f12457ffcf120021c7d9a0e234e7e048a3\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur-staging_app_public\",\"Target\":\"/app/public\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"User\":\"0:3000\"},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app_fe\"],\"Target\":\"wl9z0sp3su5p6za45i3klgtn6\"},{\"Aliases\":[\"app_fe\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_app_public == true\"],\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"RestartPolicy\":{\"Condition\":\"none\",\"MaxAttempts\":0},\"Runtime\":\"container\"}},\"UpdatedAt\":\"2022-01-04T21:55:49.683887969Z\",\"Version\":{\"Index\":10057286}}]","stderr":"","i":"15 /home/home/monoetna/swarm/swarm-keeper/lib/edit-config-deploy.recording"}
{"cmd":"http","args":["--check-status","--proxy=http:socks5h://127.0.0.1:9090","--proxy=https:socks5h://127.0.0.1:9090","GET","https://portainer.dsco.ucsf.edu/api/endpoints/1/docker/tasks","Authorization: Bearer xxx","filters=={\"service\":[\"timur-staging_app\"],\"desired-state\":[\"shutdown\"]}"],"result":"0","stdin":"","stdout":"[{\"CreatedAt\":\"2022-01-04T21:52:36.602750303Z\",\"DesiredState\":\"shutdown\",\"ID\":\"1mn2vkae0he34q7mtwtwanpak\",\"Labels\":{},\"NetworksAttachments\":[{\"Addresses\":[\"10.0.4.197/24\"],\"Network\":{\"CreatedAt\":\"2021-06-12T00:04:08.851633906Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4100\"}},\"ID\":\"pwqf514t16rtmjpq62shyib7h\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.4.1\",\"Subnet\":\"10.0.4.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"Attachable\":true,\"DriverConfiguration\":{\"Name\":\"overlay\"},\"IPAMOptions\":{\"Driver\":{\"Name\":\"default\"}},\"Labels\":{},\"Name\":\"prometheus\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2021-12-28T20:39:20.053403246Z\",\"Version\":{\"Index\":8635318}}},{\"Addresses\":[\"10.0.21.9/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.74850188Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4117\"}},\"ID\":\"c4ggc3aqae1ost27az5ri3nxz\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.21.1\",\"Subnet\":\"10.0.21.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_db\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.751592118Z\",\"Version\":{\"Index\":9866157}}},{\"Addresses\":[\"10.0.19.6/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.712710437Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4115\"}},\"ID\":\"r1u6c0bclbl6wyl1g8478x91v\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.19.1\",\"Subnet\":\"10.0.19.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_fe\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.715086232Z\",\"Version\":{\"Index\":9866153}}}],\"NodeID\":\"3e634fut8umris4hqblxbgmk0\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"ServiceID\":\"9vxwqyzsiehxqhe2w9pyi39n4\",\"Slot\":1,\"Spec\":{\"ContainerSpec\":{\"Args\":[\"bash\",\"-c\",\"set -e\\nexport METRICS_PW=\\\"$(cat /run/secrets/metrics-pw)\\\"\\nexec /bin/deploy.sh migrate -- /app/bin/puma.sh\\n\"],\"Configs\":[{\"ConfigID\":\"kyzf7xy96uv6ip5x65lgjf1wf\",\"ConfigName\":\"etna.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/env.yml\",\"UID\":\"0\"}},{\"ConfigID\":\"sh4pln0b83bunf130n8v9e42n\",\"ConfigName\":\"timur.staging.yml_1641333148\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/config.yml\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"ETNA__PRODUCTION_FILE=/app/env.yml\",\"ETNA__PRODUCTION__DB__PASSWORD_FILE=/run/secrets/db-password\",\"ETNA__PRODUCTION__ROLLBAR__ACCESS_TOKEN=/run/secrets/rollbar-access-token\",\"ETNA__PRODUCTION__USER_HASH_SECRET=/run/secrets/user-hash-secret\",\"TIMUR_ENV=production\"],\"Healthcheck\":{\"Interval\":10000000000,\"Retries\":3,\"StartPeriod\":1000000000,\"Test\":[\"CMD-SHELL\",\"bash -c 'curl http://localhost:3000 || exit 1'\"],\"Timeout\":5000000000},\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"/var/node_exporter/metrics.prom\",\"Target\":\"/tmp/metrics.prom\",\"Type\":\"bind\"}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"metrics-pw\",\"UID\":\"0\"},\"SecretID\":\"6adzt6tvilj2msj5m4vsy1eug\",\"SecretName\":\"metrics-pw\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"db-password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"user-hash-secret\",\"UID\":\"0\"},\"SecretID\":\"nqdn03euckbucxx1d7brr0gde\",\"SecretName\":\"user-hash-secret\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app\"],\"Target\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Aliases\":[\"app\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Aliases\":[\"timur_app\",\"app\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{}},\"Status\":{\"ContainerStatus\":{\"ContainerID\":\"aaca6f0fdb21b4b33d0e72c46114d197cf1590889a946dfd4c0e84ab88573f31\",\"ExitCode\":1,\"PID\":0},\"Message\":\"shutdown\",\"PortStatus\":{},\"State\":\"shutdown\",\"Timestamp\":\"2022-01-04T21:53:41.895541058Z\"},\"UpdatedAt\":\"2022-01-04T21:53:41.93158238Z\",\"Version\":{\"Index\":10056975}},{\"CreatedAt\":\"2022-01-04T21:48:34.869891753Z\",\"DesiredState\":\"shutdown\",\"ID\":\"fz7aup1fu575twznk2a7lhqkd\",\"Labels\":{},\"NetworksAttachments\":[{\"Addresses\":[\"10.0.4.195/24\"],\"Network\":{\"CreatedAt\":\"2021-06-12T00:04:08.851633906Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4100\"}},\"ID\":\"pwqf514t16rtmjpq62shyib7h\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.4.1\",\"Subnet\":\"10.0.4.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"Attachable\":true,\"DriverConfiguration\":{\"Name\":\"overlay\"},\"IPAMOptions\":{\"Driver\":{\"Name\":\"default\"}},\"Labels\":{},\"Name\":\"prometheus\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2021-12-28T20:39:20.053403246Z\",\"Version\":{\"Index\":8635318}}},{\"Addresses\":[\"10.0.21.7/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.74850188Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4117\"}},\"ID\":\"c4ggc3aqae1ost27az5ri3nxz\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.21.1\",\"Subnet\":\"10.0.21.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_db\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.751592118Z\",\"Version\":{\"Index\":9866157}}},{\"Addresses\":[\"10.0.19.254/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.712710437Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4115\"}},\"ID\":\"r1u6c0bclbl6wyl1g8478x91v\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.19.1\",\"Subnet\":\"10.0.19.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_fe\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.715086232Z\",\"Version\":{\"Index\":9866153}}}],\"NodeID\":\"ybj02s79vhfv0zrcmwjecr3d6\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"ServiceID\":\"9vxwqyzsiehxqhe2w9pyi39n4\",\"Slot\":1,\"Spec\":{\"ContainerSpec\":{\"Args\":[\"bash\",\"-c\",\"set -e\\nexport METRICS_PW=\\\"$(cat /run/secrets/metrics-pw)\\\"\\nexec /bin/deploy.sh migrate -- /app/bin/puma.sh\\n\"],\"Configs\":[{\"ConfigID\":\"kyzf7xy96uv6ip5x65lgjf1wf\",\"ConfigName\":\"etna.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/env.yml\",\"UID\":\"0\"}},{\"ConfigID\":\"x4akplf1vv5h2j46f2hunod67\",\"ConfigName\":\"timur.staging.yml_1641325556_1641332269\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/config.yml\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"ETNA__PRODUCTION_FILE=/app/env.yml\",\"ETNA__PRODUCTION__DB__PASSWORD_FILE=/run/secrets/db-password\",\"ETNA__PRODUCTION__ROLLBAR__ACCESS_TOKEN=/run/secrets/rollbar-access-token\",\"ETNA__PRODUCTION__USER_HASH_SECRET=/run/secrets/user-hash-secret\",\"TIMUR_ENV=production\"],\"Healthcheck\":{\"Interval\":10000000000,\"Retries\":3,\"StartPeriod\":1000000000,\"Test\":[\"CMD-SHELL\",\"bash -c 'curl http://localhost:3000 || exit 1'\"],\"Timeout\":5000000000},\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"/var/node_exporter/metrics.prom\",\"Target\":\"/tmp/metrics.prom\",\"Type\":\"bind\"}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"metrics-pw\",\"UID\":\"0\"},\"SecretID\":\"6adzt6tvilj2msj5m4vsy1eug\",\"SecretName\":\"metrics-pw\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"db-password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"user-hash-secret\",\"UID\":\"0\"},\"SecretID\":\"nqdn03euckbucxx1d7brr0gde\",\"SecretName\":\"user-hash-secret\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app\"],\"Target\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Aliases\":[\"app\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Aliases\":[\"timur_app\",\"app\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{}},\"Status\":{\"ContainerStatus\":{\"ContainerID\":\"28e15f27e3274630586d2342b0a25983920365a860a2ff6745fd158f1d9a5a6b\",\"ExitCode\":1,\"PID\":0},\"Message\":\"shutdown\",\"PortStatus\":{},\"State\":\"shutdown\",\"Timestamp\":\"2022-01-04T21:52:55.827606933Z\"},\"UpdatedAt\":\"2022-01-04T21:52:55.864189786Z\",\"Version\":{\"Index\":10056849}},{\"CreatedAt\":\"2022-01-04T21:47:49.357311198Z\",\"DesiredState\":\"shutdown\",\"ID\":\"wbizxzjv0fml602niqyv4sqem\",\"Labels\":{},\"NetworksAttachments\":[{\"Addresses\":[\"10.0.4.194/24\"],\"Network\":{\"CreatedAt\":\"2021-06-12T00:04:08.851633906Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4100\"}},\"ID\":\"pwqf514t16rtmjpq62shyib7h\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.4.1\",\"Subnet\":\"10.0.4.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"Attachable\":true,\"DriverConfiguration\":{\"Name\":\"overlay\"},\"IPAMOptions\":{\"Driver\":{\"Name\":\"default\"}},\"Labels\":{},\"Name\":\"prometheus\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2021-12-28T20:39:20.053403246Z\",\"Version\":{\"Index\":8635318}}},{\"Addresses\":[\"10.0.21.5/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.74850188Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4117\"}},\"ID\":\"c4ggc3aqae1ost27az5ri3nxz\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.21.1\",\"Subnet\":\"10.0.21.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_db\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.751592118Z\",\"Version\":{\"Index\":9866157}}},{\"Addresses\":[\"10.0.19.252/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.712710437Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4115\"}},\"ID\":\"r1u6c0bclbl6wyl1g8478x91v\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.19.1\",\"Subnet\":\"10.0.19.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_fe\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.715086232Z\",\"Version\":{\"Index\":9866153}}}],\"NodeID\":\"3e634fut8umris4hqblxbgmk0\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"ServiceID\":\"9vxwqyzsiehxqhe2w9pyi39n4\",\"Slot\":1,\"Spec\":{\"ContainerSpec\":{\"Args\":[\"bash\",\"-c\",\"set -e\\nexport METRICS_PW=\\\"$(cat /run/secrets/metrics-pw)\\\"\\nexec /bin/deploy.sh migrate -- /app/bin/puma.sh\\n\"],\"Configs\":[{\"ConfigID\":\"kyzf7xy96uv6ip5x65lgjf1wf\",\"ConfigName\":\"etna.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/env.yml\",\"UID\":\"0\"}},{\"ConfigID\":\"jl1ceyd1c6mt3ei4umpf5ap06\",\"ConfigName\":\"timur.staging.yml_1641325556_1641332269_1641332856\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/config.yml\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"ETNA__PRODUCTION_FILE=/app/env.yml\",\"ETNA__PRODUCTION__DB__PASSWORD_FILE=/run/secrets/db-password\",\"ETNA__PRODUCTION__ROLLBAR__ACCESS_TOKEN=/run/secrets/rollbar-access-token\",\"ETNA__PRODUCTION__USER_HASH_SECRET=/run/secrets/user-hash-secret\",\"TIMUR_ENV=production\"],\"Healthcheck\":{\"Interval\":10000000000,\"Retries\":3,\"StartPeriod\":1000000000,\"Test\":[\"CMD-SHELL\",\"bash -c 'curl http://localhost:3000 || exit 1'\"],\"Timeout\":5000000000},\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"/var/node_exporter/metrics.prom\",\"Target\":\"/tmp/metrics.prom\",\"Type\":\"bind\"}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"metrics-pw\",\"UID\":\"0\"},\"SecretID\":\"6adzt6tvilj2msj5m4vsy1eug\",\"SecretName\":\"metrics-pw\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"db-password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"user-hash-secret\",\"UID\":\"0\"},\"SecretID\":\"nqdn03euckbucxx1d7brr0gde\",\"SecretName\":\"user-hash-secret\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app\"],\"Target\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Aliases\":[\"app\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Aliases\":[\"timur_app\",\"app\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{}},\"Status\":{\"ContainerStatus\":{\"ContainerID\":\"95a714f8efd181042dc60a29236337bc07a92389c91d8df81e3eac038d2ccddb\",\"ExitCode\":1,\"PID\":0},\"Message\":\"shutdown\",\"PortStatus\":{},\"State\":\"shutdown\",\"Timestamp\":\"2022-01-04T21:48:55.80395479Z\"},\"UpdatedAt\":\"2022-01-04T21:48:55.829545767Z\",\"Version\":{\"Index\":10056263}}]","stderr":"","i":"16 /home/home/monoetna/swarm/swarm-keeper/lib/edit-config-deploy.recording"}
{"cmd":"http","args":["--check-status","--proxy=http:socks5h://127.0.0.1:9090","--proxy=https:socks5h://127.0.0.1:9090","GET","https://portainer.dsco.ucsf.edu/api/endpoints/1/docker/services","Authorization: Bearer xxx","filters=={\"name\":[\"timur-staging_app\"]}"],"result":"0","stdin":"","stdout":"[{\"CreatedAt\":\"2022-01-03T23:20:43.937407448Z\",\"Endpoint\":{\"Spec\":{\"Mode\":\"vip\"},\"VirtualIPs\":[{\"Addr\":\"10.0.4.98/24\",\"NetworkID\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Addr\":\"10.0.21.4/24\",\"NetworkID\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Addr\":\"10.0.19.4/24\",\"NetworkID\":\"r1u6c0bclbl6wyl1g8478x91v\"}]},\"ID\":\"9vxwqyzsiehxqhe2w9pyi39n4\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"PreviousSpec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Replicated\":{\"Replicas\":1}},\"Name\":\"timur-staging_app\",\"TaskTemplate\":{\"ContainerSpec\":{\"Args\":[\"bash\",\"-c\",\"set -e\\nexport METRICS_PW=\\\"$(cat /run/secrets/metrics-pw)\\\"\\nexec /bin/deploy.sh migrate -- /app/bin/puma.sh\\n\"],\"Configs\":[{\"ConfigID\":\"kyzf7xy96uv6ip5x65lgjf1wf\",\"ConfigName\":\"etna.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/env.yml\",\"UID\":\"0\"}},{\"ConfigID\":\"qn484g1c0bmaaw2n1fkueyc8e\",\"ConfigName\":\"timur.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/config.yml\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"ETNA__PRODUCTION_FILE=/app/env.yml\",\"ETNA__PRODUCTION__DB__PASSWORD_FILE=/run/secrets/db-password\",\"ETNA__PRODUCTION__ROLLBAR__ACCESS_TOKEN=/run/secrets/rollbar-access-token\",\"ETNA__PRODUCTION__USER_HASH_SECRET=/run/secrets/user-hash-secret\",\"TIMUR_ENV=production\"],\"Healthcheck\":{\"Interval\":10000000000,\"Retries\":3,\"StartPeriod\":1000000000,\"Test\":[\"CMD-SHELL\",\"bash -c 'curl http://localhost:3000 || exit 1'\"],\"Timeout\":5000000000},\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"/var/node_exporter/metrics.prom\",\"Target\":\"/tmp/metrics.prom\",\"Type\":\"bind\"}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"metrics-pw\",\"UID\":\"0\"},\"SecretID\":\"6adzt6tvilj2msj5m4vsy1eug\",\"SecretName\":\"metrics-pw\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"db-password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"user-hash-secret\",\"UID\":\"0\"},\"SecretID\":\"nqdn03euckbucxx1d7brr0gde\",\"SecretName\":\"user-hash-secret\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app\"],\"Target\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Aliases\":[\"app\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Aliases\":[\"timur_app\",\"app\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"Runtime\":\"container\"},\"UpdateConfig\":{\"FailureAction\":\"pause\",\"MaxFailureRatio\":0,\"Order\":\"start-first\",\"Parallelism\":1}},\"Spec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Replicated\":{\"Replicas\":1}},\"Name\":\"timur-staging_app\",\"TaskTemplate\":{\"ContainerSpec\":{\"Args\":[\"bash\",\"-c\",\"set -e\\nexport METRICS_PW=\\\"$(cat /run/secrets/metrics-pw)\\\"\\nexec /bin/deploy.sh migrate -- /app/bin/puma.sh\\n\"],\"Configs\":[{\"ConfigID\":\"kyzf7xy96uv6ip5x65lgjf1wf\",\"ConfigName\":\"etna.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/env.yml\",\"UID\":\"0\"}},{\"ConfigID\":\"v708ckky9705nzt3rv6gya39l\",\"ConfigName\":\"timur.staging.yml_1641333336\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/config.yml\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"ETNA__PRODUCTION_FILE=/app/env.yml\",\"ETNA__PRODUCTION__DB__PASSWORD_FILE=/run/secrets/db-password\",\"ETNA__PRODUCTION__ROLLBAR__ACCESS_TOKEN=/run/secrets/rollbar-access-token\",\"ETNA__PRODUCTION__USER_HASH_SECRET=/run/secrets/user-hash-secret\",\"TIMUR_ENV=production\"],\"Healthcheck\":{\"Interval\":10000000000,\"Retries\":3,\"StartPeriod\":1000000000,\"Test\":[\"CMD-SHELL\",\"bash -c 'curl http://localhost:3000 || exit 1'\"],\"Timeout\":5000000000},\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"/var/node_exporter/metrics.prom\",\"Target\":\"/tmp/metrics.prom\",\"Type\":\"bind\"}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"metrics-pw\",\"UID\":\"0\"},\"SecretID\":\"6adzt6tvilj2msj5m4vsy1eug\",\"SecretName\":\"metrics-pw\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"db-password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"user-hash-secret\",\"UID\":\"0\"},\"SecretID\":\"nqdn03euckbucxx1d7brr0gde\",\"SecretName\":\"user-hash-secret\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app\"],\"Target\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Aliases\":[\"app\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Aliases\":[\"timur_app\",\"app\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"Runtime\":\"container\"},\"UpdateConfig\":{\"FailureAction\":\"pause\",\"MaxFailureRatio\":0,\"Order\":\"start-first\",\"Parallelism\":1}},\"UpdateStatus\":{\"Message\":\"update in progress\",\"StartedAt\":\"2022-01-04T21:55:48.092741259Z\",\"State\":\"updating\"},\"UpdatedAt\":\"2022-01-04T21:55:48.09277362Z\",\"Version\":{\"Index\":10057278}},{\"CreatedAt\":\"2022-01-03T23:20:41.23437548Z\",\"Endpoint\":{\"Spec\":{\"Mode\":\"vip\"},\"VirtualIPs\":[{\"Addr\":\"10.0.20.2/24\",\"NetworkID\":\"m52fcusnqimfjqpnrnqrq34gs\"}]},\"ID\":\"qgjxwctj8zxsu5i6ux5bf40j2\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"PreviousSpec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Global\":{}},\"Name\":\"timur-staging_app_assets_deployer\",\"TaskTemplate\":{\"ContainerSpec\":{\"Args\":[\"/bin/deploy.sh\",\"syncAssets\",\"--\",\"true\"],\"Env\":[\"APP_NAME=timur\",\"TIMUR_ENV=production\"],\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur-staging_app_public\",\"Target\":\"/sync-assets\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null}},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app_assets_deployer\"],\"Target\":\"m52fcusnqimfjqpnrnqrq34gs\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_app_public == true\"],\"MaxReplicas\":1,\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"RestartPolicy\":{\"Condition\":\"none\",\"MaxAttempts\":0},\"Runtime\":\"container\"}},\"Spec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Global\":{}},\"Name\":\"timur-staging_app_assets_deployer\",\"TaskTemplate\":{\"ContainerSpec\":{\"Args\":[\"/bin/deploy.sh\",\"syncAssets\",\"--\",\"true\"],\"Env\":[\"APP_NAME=timur\",\"TIMUR_ENV=production\"],\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur-staging_app_public\",\"Target\":\"/sync-assets\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null}},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app_assets_deployer\"],\"Target\":\"m52fcusnqimfjqpnrnqrq34gs\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_app_public == true\"],\"MaxReplicas\":1,\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"RestartPolicy\":{\"Condition\":\"none\",\"MaxAttempts\":0},\"Runtime\":\"container\"}},\"UpdatedAt\":\"2022-01-04T21:55:45.413437387Z\",\"Version\":{\"Index\":10057271}},{\"CreatedAt\":\"2022-01-03T23:20:39.571206988Z\",\"Endpoint\":{\"Spec\":{\"Mode\":\"vip\"},\"VirtualIPs\":[{\"Addr\":\"10.0.3.214/24\",\"NetworkID\":\"wl9z0sp3su5p6za45i3klgtn6\"},{\"Addr\":\"10.0.19.2/24\",\"NetworkID\":\"r1u6c0bclbl6wyl1g8478x91v\"}]},\"ID\":\"y8mocvq0olbq809713v3ey9hd\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"PreviousSpec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur_app_fe:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Replicated\":{\"Replicas\":1}},\"Name\":\"timur-staging_app_fe\",\"TaskTemplate\":{\"ContainerSpec\":{\"Configs\":[{\"ConfigID\":\"efyi8cnelo5i809bnga85ozje\",\"ConfigName\":\"browser.system.include\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/usr/opt/httpd.conf.d/browser.system.include\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"TIMUR_ENV=production\"],\"Image\":\"etnaagent/timur_app_fe:staging@sha256:f3527445b7147a4fba3923abc4f308f12457ffcf120021c7d9a0e234e7e048a3\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur-staging_app_public\",\"Target\":\"/app/public\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"User\":\"0:3000\"},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app_fe\"],\"Target\":\"wl9z0sp3su5p6za45i3klgtn6\"},{\"Aliases\":[\"app_fe\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_app_public == true\"],\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"RestartPolicy\":{\"Condition\":\"none\",\"MaxAttempts\":0},\"Runtime\":\"container\"}},\"Spec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur_app_fe:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Replicated\":{\"Replicas\":1}},\"Name\":\"timur-staging_app_fe\",\"TaskTemplate\":{\"ContainerSpec\":{\"Configs\":[{\"ConfigID\":\"efyi8cnelo5i809bnga85ozje\",\"ConfigName\":\"browser.system.include\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/usr/opt/httpd.conf.d/browser.system.include\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"TIMUR_ENV=production\"],\"Image\":\"etnaagent/timur_app_fe:staging@sha256:f3527445b7147a4fba3923abc4f308f12457ffcf120021c7d9a0e234e7e048a3\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur-staging_app_public\",\"Target\":\"/app/public\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"User\":\"0:3000\"},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app_fe\"],\"Target\":\"wl9z0sp3su5p6za45i3klgtn6\"},{\"Aliases\":[\"app_fe\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_app_public == true\"],\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"RestartPolicy\":{\"Condition\":\"none\",\"MaxAttempts\":0},\"Runtime\":\"container\"}},\"UpdatedAt\":\"2022-01-04T21:55:49.683887969Z\",\"Version\":{\"Index\":10057286}}]","stderr":"","i":"17 /home/home/monoetna/swarm/swarm-keeper/lib/edit-config-deploy.recording"}
{"cmd":"http","args":["--check-status","--proxy=http:socks5h://127.0.0.1:9090","--proxy=https:socks5h://127.0.0.1:9090","GET","https://portainer.dsco.ucsf.edu/api/endpoints/1/docker/tasks","Authorization: Bearer xxx","filters=={\"service\":[\"timur-staging_app\"],\"desired-state\":[\"shutdown\"]}"],"result":"0","stdin":"","stdout":"[{\"CreatedAt\":\"2022-01-04T21:52:36.602750303Z\",\"DesiredState\":\"shutdown\",\"ID\":\"1mn2vkae0he34q7mtwtwanpak\",\"Labels\":{},\"NetworksAttachments\":[{\"Addresses\":[\"10.0.4.197/24\"],\"Network\":{\"CreatedAt\":\"2021-06-12T00:04:08.851633906Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4100\"}},\"ID\":\"pwqf514t16rtmjpq62shyib7h\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.4.1\",\"Subnet\":\"10.0.4.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"Attachable\":true,\"DriverConfiguration\":{\"Name\":\"overlay\"},\"IPAMOptions\":{\"Driver\":{\"Name\":\"default\"}},\"Labels\":{},\"Name\":\"prometheus\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2021-12-28T20:39:20.053403246Z\",\"Version\":{\"Index\":8635318}}},{\"Addresses\":[\"10.0.21.9/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.74850188Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4117\"}},\"ID\":\"c4ggc3aqae1ost27az5ri3nxz\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.21.1\",\"Subnet\":\"10.0.21.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_db\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.751592118Z\",\"Version\":{\"Index\":9866157}}},{\"Addresses\":[\"10.0.19.6/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.712710437Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4115\"}},\"ID\":\"r1u6c0bclbl6wyl1g8478x91v\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.19.1\",\"Subnet\":\"10.0.19.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_fe\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.715086232Z\",\"Version\":{\"Index\":9866153}}}],\"NodeID\":\"3e634fut8umris4hqblxbgmk0\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"ServiceID\":\"9vxwqyzsiehxqhe2w9pyi39n4\",\"Slot\":1,\"Spec\":{\"ContainerSpec\":{\"Args\":[\"bash\",\"-c\",\"set -e\\nexport METRICS_PW=\\\"$(cat /run/secrets/metrics-pw)\\\"\\nexec /bin/deploy.sh migrate -- /app/bin/puma.sh\\n\"],\"Configs\":[{\"ConfigID\":\"kyzf7xy96uv6ip5x65lgjf1wf\",\"ConfigName\":\"etna.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/env.yml\",\"UID\":\"0\"}},{\"ConfigID\":\"sh4pln0b83bunf130n8v9e42n\",\"ConfigName\":\"timur.staging.yml_1641333148\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/config.yml\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"ETNA__PRODUCTION_FILE=/app/env.yml\",\"ETNA__PRODUCTION__DB__PASSWORD_FILE=/run/secrets/db-password\",\"ETNA__PRODUCTION__ROLLBAR__ACCESS_TOKEN=/run/secrets/rollbar-access-token\",\"ETNA__PRODUCTION__USER_HASH_SECRET=/run/secrets/user-hash-secret\",\"TIMUR_ENV=production\"],\"Healthcheck\":{\"Interval\":10000000000,\"Retries\":3,\"StartPeriod\":1000000000,\"Test\":[\"CMD-SHELL\",\"bash -c 'curl http://localhost:3000 || exit 1'\"],\"Timeout\":5000000000},\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"/var/node_exporter/metrics.prom\",\"Target\":\"/tmp/metrics.prom\",\"Type\":\"bind\"}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"metrics-pw\",\"UID\":\"0\"},\"SecretID\":\"6adzt6tvilj2msj5m4vsy1eug\",\"SecretName\":\"metrics-pw\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"db-password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"user-hash-secret\",\"UID\":\"0\"},\"SecretID\":\"nqdn03euckbucxx1d7brr0gde\",\"SecretName\":\"user-hash-secret\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app\"],\"Target\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Aliases\":[\"app\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Aliases\":[\"timur_app\",\"app\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{}},\"Status\":{\"ContainerStatus\":{\"ContainerID\":\"aaca6f0fdb21b4b33d0e72c46114d197cf1590889a946dfd4c0e84ab88573f31\",\"ExitCode\":1,\"PID\":0},\"Message\":\"shutdown\",\"PortStatus\":{},\"State\":\"shutdown\",\"Timestamp\":\"2022-01-04T21:53:41.895541058Z\"},\"UpdatedAt\":\"2022-01-04T21:53:41.93158238Z\",\"Version\":{\"Index\":10056975}},{\"CreatedAt\":\"2022-01-04T21:48:34.869891753Z\",\"DesiredState\":\"shutdown\",\"ID\":\"fz7aup1fu575twznk2a7lhqkd\",\"Labels\":{},\"NetworksAttachments\":[{\"Addresses\":[\"10.0.4.195/24\"],\"Network\":{\"CreatedAt\":\"2021-06-12T00:04:08.851633906Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4100\"}},\"ID\":\"pwqf514t16rtmjpq62shyib7h\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.4.1\",\"Subnet\":\"10.0.4.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"Attachable\":true,\"DriverConfiguration\":{\"Name\":\"overlay\"},\"IPAMOptions\":{\"Driver\":{\"Name\":\"default\"}},\"Labels\":{},\"Name\":\"prometheus\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2021-12-28T20:39:20.053403246Z\",\"Version\":{\"Index\":8635318}}},{\"Addresses\":[\"10.0.21.7/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.74850188Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4117\"}},\"ID\":\"c4ggc3aqae1ost27az5ri3nxz\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.21.1\",\"Subnet\":\"10.0.21.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_db\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.751592118Z\",\"Version\":{\"Index\":9866157}}},{\"Addresses\":[\"10.0.19.254/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.712710437Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4115\"}},\"ID\":\"r1u6c0bclbl6wyl1g8478x91v\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.19.1\",\"Subnet\":\"10.0.19.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_fe\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.715086232Z\",\"Version\":{\"Index\":9866153}}}],\"NodeID\":\"ybj02s79vhfv0zrcmwjecr3d6\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"ServiceID\":\"9vxwqyzsiehxqhe2w9pyi39n4\",\"Slot\":1,\"Spec\":{\"ContainerSpec\":{\"Args\":[\"bash\",\"-c\",\"set -e\\nexport METRICS_PW=\\\"$(cat /run/secrets/metrics-pw)\\\"\\nexec /bin/deploy.sh migrate -- /app/bin/puma.sh\\n\"],\"Configs\":[{\"ConfigID\":\"kyzf7xy96uv6ip5x65lgjf1wf\",\"ConfigName\":\"etna.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/env.yml\",\"UID\":\"0\"}},{\"ConfigID\":\"x4akplf1vv5h2j46f2hunod67\",\"ConfigName\":\"timur.staging.yml_1641325556_1641332269\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/config.yml\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"ETNA__PRODUCTION_FILE=/app/env.yml\",\"ETNA__PRODUCTION__DB__PASSWORD_FILE=/run/secrets/db-password\",\"ETNA__PRODUCTION__ROLLBAR__ACCESS_TOKEN=/run/secrets/rollbar-access-token\",\"ETNA__PRODUCTION__USER_HASH_SECRET=/run/secrets/user-hash-secret\",\"TIMUR_ENV=production\"],\"Healthcheck\":{\"Interval\":10000000000,\"Retries\":3,\"StartPeriod\":1000000000,\"Test\":[\"CMD-SHELL\",\"bash -c 'curl http://localhost:3000 || exit 1'\"],\"Timeout\":5000000000},\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"/var/node_exporter/metrics.prom\",\"Target\":\"/tmp/metrics.prom\",\"Type\":\"bind\"}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"metrics-pw\",\"UID\":\"0\"},\"SecretID\":\"6adzt6tvilj2msj5m4vsy1eug\",\"SecretName\":\"metrics-pw\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"db-password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"user-hash-secret\",\"UID\":\"0\"},\"SecretID\":\"nqdn03euckbucxx1d7brr0gde\",\"SecretName\":\"user-hash-secret\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app\"],\"Target\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Aliases\":[\"app\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Aliases\":[\"timur_app\",\"app\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{}},\"Status\":{\"ContainerStatus\":{\"ContainerID\":\"28e15f27e3274630586d2342b0a25983920365a860a2ff6745fd158f1d9a5a6b\",\"ExitCode\":1,\"PID\":0},\"Message\":\"shutdown\",\"PortStatus\":{},\"State\":\"shutdown\",\"Timestamp\":\"2022-01-04T21:52:55.827606933Z\"},\"UpdatedAt\":\"2022-01-04T21:52:55.864189786Z\",\"Version\":{\"Index\":10056849}},{\"CreatedAt\":\"2022-01-04T21:47:49.357311198Z\",\"DesiredState\":\"shutdown\",\"ID\":\"wbizxzjv0fml602niqyv4sqem\",\"Labels\":{},\"NetworksAttachments\":[{\"Addresses\":[\"10.0.4.194/24\"],\"Network\":{\"CreatedAt\":\"2021-06-12T00:04:08.851633906Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4100\"}},\"ID\":\"pwqf514t16rtmjpq62shyib7h\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.4.1\",\"Subnet\":\"10.0.4.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"Attachable\":true,\"DriverConfiguration\":{\"Name\":\"overlay\"},\"IPAMOptions\":{\"Driver\":{\"Name\":\"default\"}},\"Labels\":{},\"Name\":\"prometheus\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2021-12-28T20:39:20.053403246Z\",\"Version\":{\"Index\":8635318}}},{\"Addresses\":[\"10.0.21.5/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.74850188Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4117\"}},\"ID\":\"c4ggc3aqae1ost27az5ri3nxz\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.21.1\",\"Subnet\":\"10.0.21.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_db\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.751592118Z\",\"Version\":{\"Index\":9866157}}},{\"Addresses\":[\"10.0.19.252/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.712710437Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4115\"}},\"ID\":\"r1u6c0bclbl6wyl1g8478x91v\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.19.1\",\"Subnet\":\"10.0.19.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_fe\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.715086232Z\",\"Version\":{\"Index\":9866153}}}],\"NodeID\":\"3e634fut8umris4hqblxbgmk0\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"ServiceID\":\"9vxwqyzsiehxqhe2w9pyi39n4\",\"Slot\":1,\"Spec\":{\"ContainerSpec\":{\"Args\":[\"bash\",\"-c\",\"set -e\\nexport METRICS_PW=\\\"$(cat /run/secrets/metrics-pw)\\\"\\nexec /bin/deploy.sh migrate -- /app/bin/puma.sh\\n\"],\"Configs\":[{\"ConfigID\":\"kyzf7xy96uv6ip5x65lgjf1wf\",\"ConfigName\":\"etna.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/env.yml\",\"UID\":\"0\"}},{\"ConfigID\":\"jl1ceyd1c6mt3ei4umpf5ap06\",\"ConfigName\":\"timur.staging.yml_1641325556_1641332269_1641332856\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/config.yml\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"ETNA__PRODUCTION_FILE=/app/env.yml\",\"ETNA__PRODUCTION__DB__PASSWORD_FILE=/run/secrets/db-password\",\"ETNA__PRODUCTION__ROLLBAR__ACCESS_TOKEN=/run/secrets/rollbar-access-token\",\"ETNA__PRODUCTION__USER_HASH_SECRET=/run/secrets/user-hash-secret\",\"TIMUR_ENV=production\"],\"Healthcheck\":{\"Interval\":10000000000,\"Retries\":3,\"StartPeriod\":1000000000,\"Test\":[\"CMD-SHELL\",\"bash -c 'curl http://localhost:3000 || exit 1'\"],\"Timeout\":5000000000},\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"/var/node_exporter/metrics.prom\",\"Target\":\"/tmp/metrics.prom\",\"Type\":\"bind\"}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"metrics-pw\",\"UID\":\"0\"},\"SecretID\":\"6adzt6tvilj2msj5m4vsy1eug\",\"SecretName\":\"metrics-pw\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"db-password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"user-hash-secret\",\"UID\":\"0\"},\"SecretID\":\"nqdn03euckbucxx1d7brr0gde\",\"SecretName\":\"user-hash-secret\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app\"],\"Target\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Aliases\":[\"app\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Aliases\":[\"timur_app\",\"app\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{}},\"Status\":{\"ContainerStatus\":{\"ContainerID\":\"95a714f8efd181042dc60a29236337bc07a92389c91d8df81e3eac038d2ccddb\",\"ExitCode\":1,\"PID\":0},\"Message\":\"shutdown\",\"PortStatus\":{},\"State\":\"shutdown\",\"Timestamp\":\"2022-01-04T21:48:55.80395479Z\"},\"UpdatedAt\":\"2022-01-04T21:48:55.829545767Z\",\"Version\":{\"Index\":10056263}}]","stderr":"","i":"18 /home/home/monoetna/swarm/swarm-keeper/lib/edit-config-deploy.recording"}
{"cmd":"http","args":["--check-status","--proxy=http:socks5h://127.0.0.1:9090","--proxy=https:socks5h://127.0.0.1:9090","GET","https://portainer.dsco.ucsf.edu/api/endpoints/1/docker/services","Authorization: Bearer xxx","filters=={\"name\":[\"timur-staging_app\"]}"],"result":"0","stdin":"","stdout":"[{\"CreatedAt\":\"2022-01-03T23:20:43.937407448Z\",\"Endpoint\":{\"Spec\":{\"Mode\":\"vip\"},\"VirtualIPs\":[{\"Addr\":\"10.0.4.98/24\",\"NetworkID\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Addr\":\"10.0.21.4/24\",\"NetworkID\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Addr\":\"10.0.19.4/24\",\"NetworkID\":\"r1u6c0bclbl6wyl1g8478x91v\"}]},\"ID\":\"9vxwqyzsiehxqhe2w9pyi39n4\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"PreviousSpec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Replicated\":{\"Replicas\":1}},\"Name\":\"timur-staging_app\",\"TaskTemplate\":{\"ContainerSpec\":{\"Args\":[\"bash\",\"-c\",\"set -e\\nexport METRICS_PW=\\\"$(cat /run/secrets/metrics-pw)\\\"\\nexec /bin/deploy.sh migrate -- /app/bin/puma.sh\\n\"],\"Configs\":[{\"ConfigID\":\"kyzf7xy96uv6ip5x65lgjf1wf\",\"ConfigName\":\"etna.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/env.yml\",\"UID\":\"0\"}},{\"ConfigID\":\"qn484g1c0bmaaw2n1fkueyc8e\",\"ConfigName\":\"timur.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/config.yml\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"ETNA__PRODUCTION_FILE=/app/env.yml\",\"ETNA__PRODUCTION__DB__PASSWORD_FILE=/run/secrets/db-password\",\"ETNA__PRODUCTION__ROLLBAR__ACCESS_TOKEN=/run/secrets/rollbar-access-token\",\"ETNA__PRODUCTION__USER_HASH_SECRET=/run/secrets/user-hash-secret\",\"TIMUR_ENV=production\"],\"Healthcheck\":{\"Interval\":10000000000,\"Retries\":3,\"StartPeriod\":1000000000,\"Test\":[\"CMD-SHELL\",\"bash -c 'curl http://localhost:3000 || exit 1'\"],\"Timeout\":5000000000},\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"/var/node_exporter/metrics.prom\",\"Target\":\"/tmp/metrics.prom\",\"Type\":\"bind\"}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"metrics-pw\",\"UID\":\"0\"},\"SecretID\":\"6adzt6tvilj2msj5m4vsy1eug\",\"SecretName\":\"metrics-pw\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"db-password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"user-hash-secret\",\"UID\":\"0\"},\"SecretID\":\"nqdn03euckbucxx1d7brr0gde\",\"SecretName\":\"user-hash-secret\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app\"],\"Target\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Aliases\":[\"app\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Aliases\":[\"timur_app\",\"app\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"Runtime\":\"container\"},\"UpdateConfig\":{\"FailureAction\":\"pause\",\"MaxFailureRatio\":0,\"Order\":\"start-first\",\"Parallelism\":1}},\"Spec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Replicated\":{\"Replicas\":1}},\"Name\":\"timur-staging_app\",\"TaskTemplate\":{\"ContainerSpec\":{\"Args\":[\"bash\",\"-c\",\"set -e\\nexport METRICS_PW=\\\"$(cat /run/secrets/metrics-pw)\\\"\\nexec /bin/deploy.sh migrate -- /app/bin/puma.sh\\n\"],\"Configs\":[{\"ConfigID\":\"kyzf7xy96uv6ip5x65lgjf1wf\",\"ConfigName\":\"etna.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/env.yml\",\"UID\":\"0\"}},{\"ConfigID\":\"v708ckky9705nzt3rv6gya39l\",\"ConfigName\":\"timur.staging.yml_1641333336\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/config.yml\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"ETNA__PRODUCTION_FILE=/app/env.yml\",\"ETNA__PRODUCTION__DB__PASSWORD_FILE=/run/secrets/db-password\",\"ETNA__PRODUCTION__ROLLBAR__ACCESS_TOKEN=/run/secrets/rollbar-access-token\",\"ETNA__PRODUCTION__USER_HASH_SECRET=/run/secrets/user-hash-secret\",\"TIMUR_ENV=production\"],\"Healthcheck\":{\"Interval\":10000000000,\"Retries\":3,\"StartPeriod\":1000000000,\"Test\":[\"CMD-SHELL\",\"bash -c 'curl http://localhost:3000 || exit 1'\"],\"Timeout\":5000000000},\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"/var/node_exporter/metrics.prom\",\"Target\":\"/tmp/metrics.prom\",\"Type\":\"bind\"}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"metrics-pw\",\"UID\":\"0\"},\"SecretID\":\"6adzt6tvilj2msj5m4vsy1eug\",\"SecretName\":\"metrics-pw\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"db-password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"user-hash-secret\",\"UID\":\"0\"},\"SecretID\":\"nqdn03euckbucxx1d7brr0gde\",\"SecretName\":\"user-hash-secret\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app\"],\"Target\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Aliases\":[\"app\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Aliases\":[\"timur_app\",\"app\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"Runtime\":\"container\"},\"UpdateConfig\":{\"FailureAction\":\"pause\",\"MaxFailureRatio\":0,\"Order\":\"start-first\",\"Parallelism\":1}},\"UpdateStatus\":{\"Message\":\"update in progress\",\"StartedAt\":\"2022-01-04T21:55:48.092741259Z\",\"State\":\"updating\"},\"UpdatedAt\":\"2022-01-04T21:55:48.09277362Z\",\"Version\":{\"Index\":10057278}},{\"CreatedAt\":\"2022-01-03T23:20:41.23437548Z\",\"Endpoint\":{\"Spec\":{\"Mode\":\"vip\"},\"VirtualIPs\":[{\"Addr\":\"10.0.20.2/24\",\"NetworkID\":\"m52fcusnqimfjqpnrnqrq34gs\"}]},\"ID\":\"qgjxwctj8zxsu5i6ux5bf40j2\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"PreviousSpec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Global\":{}},\"Name\":\"timur-staging_app_assets_deployer\",\"TaskTemplate\":{\"ContainerSpec\":{\"Args\":[\"/bin/deploy.sh\",\"syncAssets\",\"--\",\"true\"],\"Env\":[\"APP_NAME=timur\",\"TIMUR_ENV=production\"],\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur-staging_app_public\",\"Target\":\"/sync-assets\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null}},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app_assets_deployer\"],\"Target\":\"m52fcusnqimfjqpnrnqrq34gs\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_app_public == true\"],\"MaxReplicas\":1,\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"RestartPolicy\":{\"Condition\":\"none\",\"MaxAttempts\":0},\"Runtime\":\"container\"}},\"Spec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Global\":{}},\"Name\":\"timur-staging_app_assets_deployer\",\"TaskTemplate\":{\"ContainerSpec\":{\"Args\":[\"/bin/deploy.sh\",\"syncAssets\",\"--\",\"true\"],\"Env\":[\"APP_NAME=timur\",\"TIMUR_ENV=production\"],\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur-staging_app_public\",\"Target\":\"/sync-assets\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null}},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app_assets_deployer\"],\"Target\":\"m52fcusnqimfjqpnrnqrq34gs\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_app_public == true\"],\"MaxReplicas\":1,\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"RestartPolicy\":{\"Condition\":\"none\",\"MaxAttempts\":0},\"Runtime\":\"container\"}},\"UpdatedAt\":\"2022-01-04T21:55:45.413437387Z\",\"Version\":{\"Index\":10057271}},{\"CreatedAt\":\"2022-01-03T23:20:39.571206988Z\",\"Endpoint\":{\"Spec\":{\"Mode\":\"vip\"},\"VirtualIPs\":[{\"Addr\":\"10.0.3.214/24\",\"NetworkID\":\"wl9z0sp3su5p6za45i3klgtn6\"},{\"Addr\":\"10.0.19.2/24\",\"NetworkID\":\"r1u6c0bclbl6wyl1g8478x91v\"}]},\"ID\":\"y8mocvq0olbq809713v3ey9hd\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"PreviousSpec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur_app_fe:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Replicated\":{\"Replicas\":1}},\"Name\":\"timur-staging_app_fe\",\"TaskTemplate\":{\"ContainerSpec\":{\"Configs\":[{\"ConfigID\":\"efyi8cnelo5i809bnga85ozje\",\"ConfigName\":\"browser.system.include\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/usr/opt/httpd.conf.d/browser.system.include\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"TIMUR_ENV=production\"],\"Image\":\"etnaagent/timur_app_fe:staging@sha256:f3527445b7147a4fba3923abc4f308f12457ffcf120021c7d9a0e234e7e048a3\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur-staging_app_public\",\"Target\":\"/app/public\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"User\":\"0:3000\"},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app_fe\"],\"Target\":\"wl9z0sp3su5p6za45i3klgtn6\"},{\"Aliases\":[\"app_fe\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_app_public == true\"],\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"RestartPolicy\":{\"Condition\":\"none\",\"MaxAttempts\":0},\"Runtime\":\"container\"}},\"Spec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur_app_fe:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Replicated\":{\"Replicas\":1}},\"Name\":\"timur-staging_app_fe\",\"TaskTemplate\":{\"ContainerSpec\":{\"Configs\":[{\"ConfigID\":\"efyi8cnelo5i809bnga85ozje\",\"ConfigName\":\"browser.system.include\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/usr/opt/httpd.conf.d/browser.system.include\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"TIMUR_ENV=production\"],\"Image\":\"etnaagent/timur_app_fe:staging@sha256:f3527445b7147a4fba3923abc4f308f12457ffcf120021c7d9a0e234e7e048a3\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur-staging_app_public\",\"Target\":\"/app/public\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"User\":\"0:3000\"},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app_fe\"],\"Target\":\"wl9z0sp3su5p6za45i3klgtn6\"},{\"Aliases\":[\"app_fe\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_app_public == true\"],\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"RestartPolicy\":{\"Condition\":\"none\",\"MaxAttempts\":0},\"Runtime\":\"container\"}},\"UpdatedAt\":\"2022-01-04T21:55:49.683887969Z\",\"Version\":{\"Index\":10057286}}]","stderr":"","i":"19 /home/home/monoetna/swarm/swarm-keeper/lib/edit-config-deploy.recording"}
{"cmd":"http","args":["--check-status","--proxy=http:socks5h://127.0.0.1:9090","--proxy=https:socks5h://127.0.0.1:9090","GET","https://portainer.dsco.ucsf.edu/api/endpoints/1/docker/tasks","Authorization: Bearer xxx","filters=={\"service\":[\"timur-staging_app\"],\"desired-state\":[\"shutdown\"]}"],"result":"0","stdin":"","stdout":"[{\"CreatedAt\":\"2022-01-04T21:52:36.602750303Z\",\"DesiredState\":\"shutdown\",\"ID\":\"1mn2vkae0he34q7mtwtwanpak\",\"Labels\":{},\"NetworksAttachments\":[{\"Addresses\":[\"10.0.4.197/24\"],\"Network\":{\"CreatedAt\":\"2021-06-12T00:04:08.851633906Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4100\"}},\"ID\":\"pwqf514t16rtmjpq62shyib7h\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.4.1\",\"Subnet\":\"10.0.4.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"Attachable\":true,\"DriverConfiguration\":{\"Name\":\"overlay\"},\"IPAMOptions\":{\"Driver\":{\"Name\":\"default\"}},\"Labels\":{},\"Name\":\"prometheus\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2021-12-28T20:39:20.053403246Z\",\"Version\":{\"Index\":8635318}}},{\"Addresses\":[\"10.0.21.9/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.74850188Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4117\"}},\"ID\":\"c4ggc3aqae1ost27az5ri3nxz\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.21.1\",\"Subnet\":\"10.0.21.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_db\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.751592118Z\",\"Version\":{\"Index\":9866157}}},{\"Addresses\":[\"10.0.19.6/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.712710437Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4115\"}},\"ID\":\"r1u6c0bclbl6wyl1g8478x91v\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.19.1\",\"Subnet\":\"10.0.19.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_fe\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.715086232Z\",\"Version\":{\"Index\":9866153}}}],\"NodeID\":\"3e634fut8umris4hqblxbgmk0\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"ServiceID\":\"9vxwqyzsiehxqhe2w9pyi39n4\",\"Slot\":1,\"Spec\":{\"ContainerSpec\":{\"Args\":[\"bash\",\"-c\",\"set -e\\nexport METRICS_PW=\\\"$(cat /run/secrets/metrics-pw)\\\"\\nexec /bin/deploy.sh migrate -- /app/bin/puma.sh\\n\"],\"Configs\":[{\"ConfigID\":\"kyzf7xy96uv6ip5x65lgjf1wf\",\"ConfigName\":\"etna.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/env.yml\",\"UID\":\"0\"}},{\"ConfigID\":\"sh4pln0b83bunf130n8v9e42n\",\"ConfigName\":\"timur.staging.yml_1641333148\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/config.yml\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"ETNA__PRODUCTION_FILE=/app/env.yml\",\"ETNA__PRODUCTION__DB__PASSWORD_FILE=/run/secrets/db-password\",\"ETNA__PRODUCTION__ROLLBAR__ACCESS_TOKEN=/run/secrets/rollbar-access-token\",\"ETNA__PRODUCTION__USER_HASH_SECRET=/run/secrets/user-hash-secret\",\"TIMUR_ENV=production\"],\"Healthcheck\":{\"Interval\":10000000000,\"Retries\":3,\"StartPeriod\":1000000000,\"Test\":[\"CMD-SHELL\",\"bash -c 'curl http://localhost:3000 || exit 1'\"],\"Timeout\":5000000000},\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"/var/node_exporter/metrics.prom\",\"Target\":\"/tmp/metrics.prom\",\"Type\":\"bind\"}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"metrics-pw\",\"UID\":\"0\"},\"SecretID\":\"6adzt6tvilj2msj5m4vsy1eug\",\"SecretName\":\"metrics-pw\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"db-password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"user-hash-secret\",\"UID\":\"0\"},\"SecretID\":\"nqdn03euckbucxx1d7brr0gde\",\"SecretName\":\"user-hash-secret\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app\"],\"Target\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Aliases\":[\"app\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Aliases\":[\"timur_app\",\"app\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{}},\"Status\":{\"ContainerStatus\":{\"ContainerID\":\"aaca6f0fdb21b4b33d0e72c46114d197cf1590889a946dfd4c0e84ab88573f31\",\"ExitCode\":1,\"PID\":0},\"Message\":\"shutdown\",\"PortStatus\":{},\"State\":\"shutdown\",\"Timestamp\":\"2022-01-04T21:53:41.895541058Z\"},\"UpdatedAt\":\"2022-01-04T21:53:41.93158238Z\",\"Version\":{\"Index\":10056975}},{\"CreatedAt\":\"2022-01-04T21:48:34.869891753Z\",\"DesiredState\":\"shutdown\",\"ID\":\"fz7aup1fu575twznk2a7lhqkd\",\"Labels\":{},\"NetworksAttachments\":[{\"Addresses\":[\"10.0.4.195/24\"],\"Network\":{\"CreatedAt\":\"2021-06-12T00:04:08.851633906Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4100\"}},\"ID\":\"pwqf514t16rtmjpq62shyib7h\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.4.1\",\"Subnet\":\"10.0.4.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"Attachable\":true,\"DriverConfiguration\":{\"Name\":\"overlay\"},\"IPAMOptions\":{\"Driver\":{\"Name\":\"default\"}},\"Labels\":{},\"Name\":\"prometheus\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2021-12-28T20:39:20.053403246Z\",\"Version\":{\"Index\":8635318}}},{\"Addresses\":[\"10.0.21.7/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.74850188Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4117\"}},\"ID\":\"c4ggc3aqae1ost27az5ri3nxz\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.21.1\",\"Subnet\":\"10.0.21.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_db\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.751592118Z\",\"Version\":{\"Index\":9866157}}},{\"Addresses\":[\"10.0.19.254/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.712710437Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4115\"}},\"ID\":\"r1u6c0bclbl6wyl1g8478x91v\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.19.1\",\"Subnet\":\"10.0.19.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_fe\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.715086232Z\",\"Version\":{\"Index\":9866153}}}],\"NodeID\":\"ybj02s79vhfv0zrcmwjecr3d6\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"ServiceID\":\"9vxwqyzsiehxqhe2w9pyi39n4\",\"Slot\":1,\"Spec\":{\"ContainerSpec\":{\"Args\":[\"bash\",\"-c\",\"set -e\\nexport METRICS_PW=\\\"$(cat /run/secrets/metrics-pw)\\\"\\nexec /bin/deploy.sh migrate -- /app/bin/puma.sh\\n\"],\"Configs\":[{\"ConfigID\":\"kyzf7xy96uv6ip5x65lgjf1wf\",\"ConfigName\":\"etna.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/env.yml\",\"UID\":\"0\"}},{\"ConfigID\":\"x4akplf1vv5h2j46f2hunod67\",\"ConfigName\":\"timur.staging.yml_1641325556_1641332269\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/config.yml\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"ETNA__PRODUCTION_FILE=/app/env.yml\",\"ETNA__PRODUCTION__DB__PASSWORD_FILE=/run/secrets/db-password\",\"ETNA__PRODUCTION__ROLLBAR__ACCESS_TOKEN=/run/secrets/rollbar-access-token\",\"ETNA__PRODUCTION__USER_HASH_SECRET=/run/secrets/user-hash-secret\",\"TIMUR_ENV=production\"],\"Healthcheck\":{\"Interval\":10000000000,\"Retries\":3,\"StartPeriod\":1000000000,\"Test\":[\"CMD-SHELL\",\"bash -c 'curl http://localhost:3000 || exit 1'\"],\"Timeout\":5000000000},\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"/var/node_exporter/metrics.prom\",\"Target\":\"/tmp/metrics.prom\",\"Type\":\"bind\"}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"metrics-pw\",\"UID\":\"0\"},\"SecretID\":\"6adzt6tvilj2msj5m4vsy1eug\",\"SecretName\":\"metrics-pw\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"db-password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"user-hash-secret\",\"UID\":\"0\"},\"SecretID\":\"nqdn03euckbucxx1d7brr0gde\",\"SecretName\":\"user-hash-secret\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app\"],\"Target\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Aliases\":[\"app\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Aliases\":[\"timur_app\",\"app\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{}},\"Status\":{\"ContainerStatus\":{\"ContainerID\":\"28e15f27e3274630586d2342b0a25983920365a860a2ff6745fd158f1d9a5a6b\",\"ExitCode\":1,\"PID\":0},\"Message\":\"shutdown\",\"PortStatus\":{},\"State\":\"shutdown\",\"Timestamp\":\"2022-01-04T21:52:55.827606933Z\"},\"UpdatedAt\":\"2022-01-04T21:52:55.864189786Z\",\"Version\":{\"Index\":10056849}},{\"CreatedAt\":\"2022-01-04T21:47:49.357311198Z\",\"DesiredState\":\"shutdown\",\"ID\":\"wbizxzjv0fml602niqyv4sqem\",\"Labels\":{},\"NetworksAttachments\":[{\"Addresses\":[\"10.0.4.194/24\"],\"Network\":{\"CreatedAt\":\"2021-06-12T00:04:08.851633906Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4100\"}},\"ID\":\"pwqf514t16rtmjpq62shyib7h\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.4.1\",\"Subnet\":\"10.0.4.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"Attachable\":true,\"DriverConfiguration\":{\"Name\":\"overlay\"},\"IPAMOptions\":{\"Driver\":{\"Name\":\"default\"}},\"Labels\":{},\"Name\":\"prometheus\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2021-12-28T20:39:20.053403246Z\",\"Version\":{\"Index\":8635318}}},{\"Addresses\":[\"10.0.21.5/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.74850188Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4117\"}},\"ID\":\"c4ggc3aqae1ost27az5ri3nxz\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.21.1\",\"Subnet\":\"10.0.21.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_db\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.751592118Z\",\"Version\":{\"Index\":9866157}}},{\"Addresses\":[\"10.0.19.252/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.712710437Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4115\"}},\"ID\":\"r1u6c0bclbl6wyl1g8478x91v\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.19.1\",\"Subnet\":\"10.0.19.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_fe\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.715086232Z\",\"Version\":{\"Index\":9866153}}}],\"NodeID\":\"3e634fut8umris4hqblxbgmk0\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"ServiceID\":\"9vxwqyzsiehxqhe2w9pyi39n4\",\"Slot\":1,\"Spec\":{\"ContainerSpec\":{\"Args\":[\"bash\",\"-c\",\"set -e\\nexport METRICS_PW=\\\"$(cat /run/secrets/metrics-pw)\\\"\\nexec /bin/deploy.sh migrate -- /app/bin/puma.sh\\n\"],\"Configs\":[{\"ConfigID\":\"kyzf7xy96uv6ip5x65lgjf1wf\",\"ConfigName\":\"etna.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/env.yml\",\"UID\":\"0\"}},{\"ConfigID\":\"jl1ceyd1c6mt3ei4umpf5ap06\",\"ConfigName\":\"timur.staging.yml_1641325556_1641332269_1641332856\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/config.yml\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"ETNA__PRODUCTION_FILE=/app/env.yml\",\"ETNA__PRODUCTION__DB__PASSWORD_FILE=/run/secrets/db-password\",\"ETNA__PRODUCTION__ROLLBAR__ACCESS_TOKEN=/run/secrets/rollbar-access-token\",\"ETNA__PRODUCTION__USER_HASH_SECRET=/run/secrets/user-hash-secret\",\"TIMUR_ENV=production\"],\"Healthcheck\":{\"Interval\":10000000000,\"Retries\":3,\"StartPeriod\":1000000000,\"Test\":[\"CMD-SHELL\",\"bash -c 'curl http://localhost:3000 || exit 1'\"],\"Timeout\":5000000000},\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"/var/node_exporter/metrics.prom\",\"Target\":\"/tmp/metrics.prom\",\"Type\":\"bind\"}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"metrics-pw\",\"UID\":\"0\"},\"SecretID\":\"6adzt6tvilj2msj5m4vsy1eug\",\"SecretName\":\"metrics-pw\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"db-password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"user-hash-secret\",\"UID\":\"0\"},\"SecretID\":\"nqdn03euckbucxx1d7brr0gde\",\"SecretName\":\"user-hash-secret\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app\"],\"Target\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Aliases\":[\"app\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Aliases\":[\"timur_app\",\"app\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{}},\"Status\":{\"ContainerStatus\":{\"ContainerID\":\"95a714f8efd181042dc60a29236337bc07a92389c91d8df81e3eac038d2ccddb\",\"ExitCode\":1,\"PID\":0},\"Message\":\"shutdown\",\"PortStatus\":{},\"State\":\"shutdown\",\"Timestamp\":\"2022-01-04T21:48:55.80395479Z\"},\"UpdatedAt\":\"2022-01-04T21:48:55.829545767Z\",\"Version\":{\"Index\":10056263}},{\"CreatedAt\":\"2022-01-04T21:53:20.40610415Z\",\"DesiredState\":\"shutdown\",\"ID\":\"z0xbye6o8sfrrp9tvrrvrpspf\",\"Labels\":{},\"NetworksAttachments\":[{\"Addresses\":[\"10.0.4.198/24\"],\"Network\":{\"CreatedAt\":\"2021-06-12T00:04:08.851633906Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4100\"}},\"ID\":\"pwqf514t16rtmjpq62shyib7h\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.4.1\",\"Subnet\":\"10.0.4.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"Attachable\":true,\"DriverConfiguration\":{\"Name\":\"overlay\"},\"IPAMOptions\":{\"Driver\":{\"Name\":\"default\"}},\"Labels\":{},\"Name\":\"prometheus\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2021-12-28T20:39:20.053403246Z\",\"Version\":{\"Index\":8635318}}},{\"Addresses\":[\"10.0.21.11/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.74850188Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4117\"}},\"ID\":\"c4ggc3aqae1ost27az5ri3nxz\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.21.1\",\"Subnet\":\"10.0.21.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_db\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.751592118Z\",\"Version\":{\"Index\":9866157}}},{\"Addresses\":[\"10.0.19.8/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.712710437Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4115\"}},\"ID\":\"r1u6c0bclbl6wyl1g8478x91v\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.19.1\",\"Subnet\":\"10.0.19.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_fe\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.715086232Z\",\"Version\":{\"Index\":9866153}}}],\"NodeID\":\"ybj02s79vhfv0zrcmwjecr3d6\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"ServiceID\":\"9vxwqyzsiehxqhe2w9pyi39n4\",\"Slot\":1,\"Spec\":{\"ContainerSpec\":{\"Args\":[\"bash\",\"-c\",\"set -e\\nexport METRICS_PW=\\\"$(cat /run/secrets/metrics-pw)\\\"\\nexec /bin/deploy.sh migrate -- /app/bin/puma.sh\\n\"],\"Configs\":[{\"ConfigID\":\"kyzf7xy96uv6ip5x65lgjf1wf\",\"ConfigName\":\"etna.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/env.yml\",\"UID\":\"0\"}},{\"ConfigID\":\"qn484g1c0bmaaw2n1fkueyc8e\",\"ConfigName\":\"timur.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/config.yml\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"ETNA__PRODUCTION_FILE=/app/env.yml\",\"ETNA__PRODUCTION__DB__PASSWORD_FILE=/run/secrets/db-password\",\"ETNA__PRODUCTION__ROLLBAR__ACCESS_TOKEN=/run/secrets/rollbar-access-token\",\"ETNA__PRODUCTION__USER_HASH_SECRET=/run/secrets/user-hash-secret\",\"TIMUR_ENV=production\"],\"Healthcheck\":{\"Interval\":10000000000,\"Retries\":3,\"StartPeriod\":1000000000,\"Test\":[\"CMD-SHELL\",\"bash -c 'curl http://localhost:3000 || exit 1'\"],\"Timeout\":5000000000},\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"/var/node_exporter/metrics.prom\",\"Target\":\"/tmp/metrics.prom\",\"Type\":\"bind\"}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"metrics-pw\",\"UID\":\"0\"},\"SecretID\":\"6adzt6tvilj2msj5m4vsy1eug\",\"SecretName\":\"metrics-pw\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"db-password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"user-hash-secret\",\"UID\":\"0\"},\"SecretID\":\"nqdn03euckbucxx1d7brr0gde\",\"SecretName\":\"user-hash-secret\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app\"],\"Target\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Aliases\":[\"app\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Aliases\":[\"timur_app\",\"app\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{}},\"Status\":{\"ContainerStatus\":{\"ContainerID\":\"9b86e192529d164b80087dbb180858e52f7db86027237dd2d4e6f6db5998505b\",\"ExitCode\":-1,\"PID\":18838},\"Message\":\"started\",\"PortStatus\":{},\"State\":\"running\",\"Timestamp\":\"2022-01-04T21:56:02.77959745Z\"},\"UpdatedAt\":\"2022-01-04T21:56:02.871122334Z\",\"Version\":{\"Index\":10057322}}]","stderr":"","i":"20 /home/home/monoetna/swarm/swarm-keeper/lib/edit-config-deploy.recording"}
{"cmd":"http","args":["--check-status","--proxy=http:socks5h://127.0.0.1:9090","--proxy=https:socks5h://127.0.0.1:9090","GET","https://portainer.dsco.ucsf.edu/api/endpoints/1/docker/services","Authorization: Bearer xxx","filters=={\"name\":[\"timur-staging_app\"]}"],"result":"0","stdin":"","stdout":"[{\"CreatedAt\":\"2022-01-03T23:20:43.937407448Z\",\"Endpoint\":{\"Spec\":{\"Mode\":\"vip\"},\"VirtualIPs\":[{\"Addr\":\"10.0.4.98/24\",\"NetworkID\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Addr\":\"10.0.21.4/24\",\"NetworkID\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Addr\":\"10.0.19.4/24\",\"NetworkID\":\"r1u6c0bclbl6wyl1g8478x91v\"}]},\"ID\":\"9vxwqyzsiehxqhe2w9pyi39n4\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"PreviousSpec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Replicated\":{\"Replicas\":1}},\"Name\":\"timur-staging_app\",\"TaskTemplate\":{\"ContainerSpec\":{\"Args\":[\"bash\",\"-c\",\"set -e\\nexport METRICS_PW=\\\"$(cat /run/secrets/metrics-pw)\\\"\\nexec /bin/deploy.sh migrate -- /app/bin/puma.sh\\n\"],\"Configs\":[{\"ConfigID\":\"kyzf7xy96uv6ip5x65lgjf1wf\",\"ConfigName\":\"etna.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/env.yml\",\"UID\":\"0\"}},{\"ConfigID\":\"qn484g1c0bmaaw2n1fkueyc8e\",\"ConfigName\":\"timur.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/config.yml\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"ETNA__PRODUCTION_FILE=/app/env.yml\",\"ETNA__PRODUCTION__DB__PASSWORD_FILE=/run/secrets/db-password\",\"ETNA__PRODUCTION__ROLLBAR__ACCESS_TOKEN=/run/secrets/rollbar-access-token\",\"ETNA__PRODUCTION__USER_HASH_SECRET=/run/secrets/user-hash-secret\",\"TIMUR_ENV=production\"],\"Healthcheck\":{\"Interval\":10000000000,\"Retries\":3,\"StartPeriod\":1000000000,\"Test\":[\"CMD-SHELL\",\"bash -c 'curl http://localhost:3000 || exit 1'\"],\"Timeout\":5000000000},\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"/var/node_exporter/metrics.prom\",\"Target\":\"/tmp/metrics.prom\",\"Type\":\"bind\"}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"metrics-pw\",\"UID\":\"0\"},\"SecretID\":\"6adzt6tvilj2msj5m4vsy1eug\",\"SecretName\":\"metrics-pw\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"db-password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"user-hash-secret\",\"UID\":\"0\"},\"SecretID\":\"nqdn03euckbucxx1d7brr0gde\",\"SecretName\":\"user-hash-secret\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app\"],\"Target\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Aliases\":[\"app\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Aliases\":[\"timur_app\",\"app\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"Runtime\":\"container\"},\"UpdateConfig\":{\"FailureAction\":\"pause\",\"MaxFailureRatio\":0,\"Order\":\"start-first\",\"Parallelism\":1}},\"Spec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Replicated\":{\"Replicas\":1}},\"Name\":\"timur-staging_app\",\"TaskTemplate\":{\"ContainerSpec\":{\"Args\":[\"bash\",\"-c\",\"set -e\\nexport METRICS_PW=\\\"$(cat /run/secrets/metrics-pw)\\\"\\nexec /bin/deploy.sh migrate -- /app/bin/puma.sh\\n\"],\"Configs\":[{\"ConfigID\":\"kyzf7xy96uv6ip5x65lgjf1wf\",\"ConfigName\":\"etna.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/env.yml\",\"UID\":\"0\"}},{\"ConfigID\":\"v708ckky9705nzt3rv6gya39l\",\"ConfigName\":\"timur.staging.yml_1641333336\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/config.yml\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"ETNA__PRODUCTION_FILE=/app/env.yml\",\"ETNA__PRODUCTION__DB__PASSWORD_FILE=/run/secrets/db-password\",\"ETNA__PRODUCTION__ROLLBAR__ACCESS_TOKEN=/run/secrets/rollbar-access-token\",\"ETNA__PRODUCTION__USER_HASH_SECRET=/run/secrets/user-hash-secret\",\"TIMUR_ENV=production\"],\"Healthcheck\":{\"Interval\":10000000000,\"Retries\":3,\"StartPeriod\":1000000000,\"Test\":[\"CMD-SHELL\",\"bash -c 'curl http://localhost:3000 || exit 1'\"],\"Timeout\":5000000000},\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"/var/node_exporter/metrics.prom\",\"Target\":\"/tmp/metrics.prom\",\"Type\":\"bind\"}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"metrics-pw\",\"UID\":\"0\"},\"SecretID\":\"6adzt6tvilj2msj5m4vsy1eug\",\"SecretName\":\"metrics-pw\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"db-password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"user-hash-secret\",\"UID\":\"0\"},\"SecretID\":\"nqdn03euckbucxx1d7brr0gde\",\"SecretName\":\"user-hash-secret\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app\"],\"Target\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Aliases\":[\"app\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Aliases\":[\"timur_app\",\"app\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"Runtime\":\"container\"},\"UpdateConfig\":{\"FailureAction\":\"pause\",\"MaxFailureRatio\":0,\"Order\":\"start-first\",\"Parallelism\":1}},\"UpdateStatus\":{\"CompletedAt\":\"2022-01-04T21:56:07.678108652Z\",\"Message\":\"update completed\",\"StartedAt\":\"2022-01-04T21:55:48.092741259Z\",\"State\":\"completed\"},\"UpdatedAt\":\"2022-01-04T21:56:07.678148525Z\",\"Version\":{\"Index\":10057336}},{\"CreatedAt\":\"2022-01-03T23:20:41.23437548Z\",\"Endpoint\":{\"Spec\":{\"Mode\":\"vip\"},\"VirtualIPs\":[{\"Addr\":\"10.0.20.2/24\",\"NetworkID\":\"m52fcusnqimfjqpnrnqrq34gs\"}]},\"ID\":\"qgjxwctj8zxsu5i6ux5bf40j2\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"PreviousSpec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Global\":{}},\"Name\":\"timur-staging_app_assets_deployer\",\"TaskTemplate\":{\"ContainerSpec\":{\"Args\":[\"/bin/deploy.sh\",\"syncAssets\",\"--\",\"true\"],\"Env\":[\"APP_NAME=timur\",\"TIMUR_ENV=production\"],\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur-staging_app_public\",\"Target\":\"/sync-assets\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null}},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app_assets_deployer\"],\"Target\":\"m52fcusnqimfjqpnrnqrq34gs\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_app_public == true\"],\"MaxReplicas\":1,\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"RestartPolicy\":{\"Condition\":\"none\",\"MaxAttempts\":0},\"Runtime\":\"container\"}},\"Spec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Global\":{}},\"Name\":\"timur-staging_app_assets_deployer\",\"TaskTemplate\":{\"ContainerSpec\":{\"Args\":[\"/bin/deploy.sh\",\"syncAssets\",\"--\",\"true\"],\"Env\":[\"APP_NAME=timur\",\"TIMUR_ENV=production\"],\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur-staging_app_public\",\"Target\":\"/sync-assets\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null}},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app_assets_deployer\"],\"Target\":\"m52fcusnqimfjqpnrnqrq34gs\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_app_public == true\"],\"MaxReplicas\":1,\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"RestartPolicy\":{\"Condition\":\"none\",\"MaxAttempts\":0},\"Runtime\":\"container\"}},\"UpdatedAt\":\"2022-01-04T21:55:45.413437387Z\",\"Version\":{\"Index\":10057271}},{\"CreatedAt\":\"2022-01-03T23:20:39.571206988Z\",\"Endpoint\":{\"Spec\":{\"Mode\":\"vip\"},\"VirtualIPs\":[{\"Addr\":\"10.0.3.214/24\",\"NetworkID\":\"wl9z0sp3su5p6za45i3klgtn6\"},{\"Addr\":\"10.0.19.2/24\",\"NetworkID\":\"r1u6c0bclbl6wyl1g8478x91v\"}]},\"ID\":\"y8mocvq0olbq809713v3ey9hd\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"PreviousSpec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur_app_fe:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Replicated\":{\"Replicas\":1}},\"Name\":\"timur-staging_app_fe\",\"TaskTemplate\":{\"ContainerSpec\":{\"Configs\":[{\"ConfigID\":\"efyi8cnelo5i809bnga85ozje\",\"ConfigName\":\"browser.system.include\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/usr/opt/httpd.conf.d/browser.system.include\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"TIMUR_ENV=production\"],\"Image\":\"etnaagent/timur_app_fe:staging@sha256:f3527445b7147a4fba3923abc4f308f12457ffcf120021c7d9a0e234e7e048a3\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur-staging_app_public\",\"Target\":\"/app/public\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"User\":\"0:3000\"},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app_fe\"],\"Target\":\"wl9z0sp3su5p6za45i3klgtn6\"},{\"Aliases\":[\"app_fe\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_app_public == true\"],\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"RestartPolicy\":{\"Condition\":\"none\",\"MaxAttempts\":0},\"Runtime\":\"container\"}},\"Spec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur_app_fe:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Replicated\":{\"Replicas\":1}},\"Name\":\"timur-staging_app_fe\",\"TaskTemplate\":{\"ContainerSpec\":{\"Configs\":[{\"ConfigID\":\"efyi8cnelo5i809bnga85ozje\",\"ConfigName\":\"browser.system.include\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/usr/opt/httpd.conf.d/browser.system.include\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"TIMUR_ENV=production\"],\"Image\":\"etnaagent/timur_app_fe:staging@sha256:f3527445b7147a4fba3923abc4f308f12457ffcf120021c7d9a0e234e7e048a3\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur-staging_app_public\",\"Target\":\"/app/public\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"User\":\"0:3000\"},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app_fe\"],\"Target\":\"wl9z0sp3su5p6za45i3klgtn6\"},{\"Aliases\":[\"app_fe\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_app_public == true\"],\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"RestartPolicy\":{\"Condition\":\"none\",\"MaxAttempts\":0},\"Runtime\":\"container\"}},\"UpdatedAt\":\"2022-01-04T21:55:49.683887969Z\",\"Version\":{\"Index\":10057286}}]","stderr":"","i":"21 /home/home/monoetna/swarm/swarm-keeper/lib/edit-config-deploy.recording"}
{"cmd":"http","args":["--check-status","--proxy=http:socks5h://127.0.0.1:9090","--proxy=https:socks5h://127.0.0.1:9090","GET","https://portainer.dsco.ucsf.edu/api/endpoints/1/docker/tasks","Authorization: Bearer xxx","filters=={\"service\":[\"timur-staging_app\"],\"desired-state\":[\"shutdown\"]}"],"result":"0","stdin":"","stdout":"[{\"CreatedAt\":\"2022-01-04T21:52:36.602750303Z\",\"DesiredState\":\"shutdown\",\"ID\":\"1mn2vkae0he34q7mtwtwanpak\",\"Labels\":{},\"NetworksAttachments\":[{\"Addresses\":[\"10.0.4.197/24\"],\"Network\":{\"CreatedAt\":\"2021-06-12T00:04:08.851633906Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4100\"}},\"ID\":\"pwqf514t16rtmjpq62shyib7h\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.4.1\",\"Subnet\":\"10.0.4.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"Attachable\":true,\"DriverConfiguration\":{\"Name\":\"overlay\"},\"IPAMOptions\":{\"Driver\":{\"Name\":\"default\"}},\"Labels\":{},\"Name\":\"prometheus\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2021-12-28T20:39:20.053403246Z\",\"Version\":{\"Index\":8635318}}},{\"Addresses\":[\"10.0.21.9/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.74850188Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4117\"}},\"ID\":\"c4ggc3aqae1ost27az5ri3nxz\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.21.1\",\"Subnet\":\"10.0.21.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_db\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.751592118Z\",\"Version\":{\"Index\":9866157}}},{\"Addresses\":[\"10.0.19.6/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.712710437Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4115\"}},\"ID\":\"r1u6c0bclbl6wyl1g8478x91v\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.19.1\",\"Subnet\":\"10.0.19.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_fe\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.715086232Z\",\"Version\":{\"Index\":9866153}}}],\"NodeID\":\"3e634fut8umris4hqblxbgmk0\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"ServiceID\":\"9vxwqyzsiehxqhe2w9pyi39n4\",\"Slot\":1,\"Spec\":{\"ContainerSpec\":{\"Args\":[\"bash\",\"-c\",\"set -e\\nexport METRICS_PW=\\\"$(cat /run/secrets/metrics-pw)\\\"\\nexec /bin/deploy.sh migrate -- /app/bin/puma.sh\\n\"],\"Configs\":[{\"ConfigID\":\"kyzf7xy96uv6ip5x65lgjf1wf\",\"ConfigName\":\"etna.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/env.yml\",\"UID\":\"0\"}},{\"ConfigID\":\"sh4pln0b83bunf130n8v9e42n\",\"ConfigName\":\"timur.staging.yml_1641333148\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/config.yml\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"ETNA__PRODUCTION_FILE=/app/env.yml\",\"ETNA__PRODUCTION__DB__PASSWORD_FILE=/run/secrets/db-password\",\"ETNA__PRODUCTION__ROLLBAR__ACCESS_TOKEN=/run/secrets/rollbar-access-token\",\"ETNA__PRODUCTION__USER_HASH_SECRET=/run/secrets/user-hash-secret\",\"TIMUR_ENV=production\"],\"Healthcheck\":{\"Interval\":10000000000,\"Retries\":3,\"StartPeriod\":1000000000,\"Test\":[\"CMD-SHELL\",\"bash -c 'curl http://localhost:3000 || exit 1'\"],\"Timeout\":5000000000},\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"/var/node_exporter/metrics.prom\",\"Target\":\"/tmp/metrics.prom\",\"Type\":\"bind\"}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"metrics-pw\",\"UID\":\"0\"},\"SecretID\":\"6adzt6tvilj2msj5m4vsy1eug\",\"SecretName\":\"metrics-pw\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"db-password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"user-hash-secret\",\"UID\":\"0\"},\"SecretID\":\"nqdn03euckbucxx1d7brr0gde\",\"SecretName\":\"user-hash-secret\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app\"],\"Target\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Aliases\":[\"app\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Aliases\":[\"timur_app\",\"app\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{}},\"Status\":{\"ContainerStatus\":{\"ContainerID\":\"aaca6f0fdb21b4b33d0e72c46114d197cf1590889a946dfd4c0e84ab88573f31\",\"ExitCode\":1,\"PID\":0},\"Message\":\"shutdown\",\"PortStatus\":{},\"State\":\"shutdown\",\"Timestamp\":\"2022-01-04T21:53:41.895541058Z\"},\"UpdatedAt\":\"2022-01-04T21:53:41.93158238Z\",\"Version\":{\"Index\":10056975}},{\"CreatedAt\":\"2022-01-04T21:48:34.869891753Z\",\"DesiredState\":\"shutdown\",\"ID\":\"fz7aup1fu575twznk2a7lhqkd\",\"Labels\":{},\"NetworksAttachments\":[{\"Addresses\":[\"10.0.4.195/24\"],\"Network\":{\"CreatedAt\":\"2021-06-12T00:04:08.851633906Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4100\"}},\"ID\":\"pwqf514t16rtmjpq62shyib7h\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.4.1\",\"Subnet\":\"10.0.4.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"Attachable\":true,\"DriverConfiguration\":{\"Name\":\"overlay\"},\"IPAMOptions\":{\"Driver\":{\"Name\":\"default\"}},\"Labels\":{},\"Name\":\"prometheus\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2021-12-28T20:39:20.053403246Z\",\"Version\":{\"Index\":8635318}}},{\"Addresses\":[\"10.0.21.7/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.74850188Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4117\"}},\"ID\":\"c4ggc3aqae1ost27az5ri3nxz\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.21.1\",\"Subnet\":\"10.0.21.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_db\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.751592118Z\",\"Version\":{\"Index\":9866157}}},{\"Addresses\":[\"10.0.19.254/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.712710437Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4115\"}},\"ID\":\"r1u6c0bclbl6wyl1g8478x91v\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.19.1\",\"Subnet\":\"10.0.19.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_fe\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.715086232Z\",\"Version\":{\"Index\":9866153}}}],\"NodeID\":\"ybj02s79vhfv0zrcmwjecr3d6\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"ServiceID\":\"9vxwqyzsiehxqhe2w9pyi39n4\",\"Slot\":1,\"Spec\":{\"ContainerSpec\":{\"Args\":[\"bash\",\"-c\",\"set -e\\nexport METRICS_PW=\\\"$(cat /run/secrets/metrics-pw)\\\"\\nexec /bin/deploy.sh migrate -- /app/bin/puma.sh\\n\"],\"Configs\":[{\"ConfigID\":\"kyzf7xy96uv6ip5x65lgjf1wf\",\"ConfigName\":\"etna.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/env.yml\",\"UID\":\"0\"}},{\"ConfigID\":\"x4akplf1vv5h2j46f2hunod67\",\"ConfigName\":\"timur.staging.yml_1641325556_1641332269\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/config.yml\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"ETNA__PRODUCTION_FILE=/app/env.yml\",\"ETNA__PRODUCTION__DB__PASSWORD_FILE=/run/secrets/db-password\",\"ETNA__PRODUCTION__ROLLBAR__ACCESS_TOKEN=/run/secrets/rollbar-access-token\",\"ETNA__PRODUCTION__USER_HASH_SECRET=/run/secrets/user-hash-secret\",\"TIMUR_ENV=production\"],\"Healthcheck\":{\"Interval\":10000000000,\"Retries\":3,\"StartPeriod\":1000000000,\"Test\":[\"CMD-SHELL\",\"bash -c 'curl http://localhost:3000 || exit 1'\"],\"Timeout\":5000000000},\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"/var/node_exporter/metrics.prom\",\"Target\":\"/tmp/metrics.prom\",\"Type\":\"bind\"}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"metrics-pw\",\"UID\":\"0\"},\"SecretID\":\"6adzt6tvilj2msj5m4vsy1eug\",\"SecretName\":\"metrics-pw\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"db-password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"user-hash-secret\",\"UID\":\"0\"},\"SecretID\":\"nqdn03euckbucxx1d7brr0gde\",\"SecretName\":\"user-hash-secret\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app\"],\"Target\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Aliases\":[\"app\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Aliases\":[\"timur_app\",\"app\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{}},\"Status\":{\"ContainerStatus\":{\"ContainerID\":\"28e15f27e3274630586d2342b0a25983920365a860a2ff6745fd158f1d9a5a6b\",\"ExitCode\":1,\"PID\":0},\"Message\":\"shutdown\",\"PortStatus\":{},\"State\":\"shutdown\",\"Timestamp\":\"2022-01-04T21:52:55.827606933Z\"},\"UpdatedAt\":\"2022-01-04T21:52:55.864189786Z\",\"Version\":{\"Index\":10056849}},{\"CreatedAt\":\"2022-01-04T21:47:49.357311198Z\",\"DesiredState\":\"shutdown\",\"ID\":\"wbizxzjv0fml602niqyv4sqem\",\"Labels\":{},\"NetworksAttachments\":[{\"Addresses\":[\"10.0.4.194/24\"],\"Network\":{\"CreatedAt\":\"2021-06-12T00:04:08.851633906Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4100\"}},\"ID\":\"pwqf514t16rtmjpq62shyib7h\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.4.1\",\"Subnet\":\"10.0.4.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"Attachable\":true,\"DriverConfiguration\":{\"Name\":\"overlay\"},\"IPAMOptions\":{\"Driver\":{\"Name\":\"default\"}},\"Labels\":{},\"Name\":\"prometheus\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2021-12-28T20:39:20.053403246Z\",\"Version\":{\"Index\":8635318}}},{\"Addresses\":[\"10.0.21.5/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.74850188Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4117\"}},\"ID\":\"c4ggc3aqae1ost27az5ri3nxz\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.21.1\",\"Subnet\":\"10.0.21.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_db\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.751592118Z\",\"Version\":{\"Index\":9866157}}},{\"Addresses\":[\"10.0.19.252/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.712710437Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4115\"}},\"ID\":\"r1u6c0bclbl6wyl1g8478x91v\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.19.1\",\"Subnet\":\"10.0.19.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_fe\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.715086232Z\",\"Version\":{\"Index\":9866153}}}],\"NodeID\":\"3e634fut8umris4hqblxbgmk0\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"ServiceID\":\"9vxwqyzsiehxqhe2w9pyi39n4\",\"Slot\":1,\"Spec\":{\"ContainerSpec\":{\"Args\":[\"bash\",\"-c\",\"set -e\\nexport METRICS_PW=\\\"$(cat /run/secrets/metrics-pw)\\\"\\nexec /bin/deploy.sh migrate -- /app/bin/puma.sh\\n\"],\"Configs\":[{\"ConfigID\":\"kyzf7xy96uv6ip5x65lgjf1wf\",\"ConfigName\":\"etna.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/env.yml\",\"UID\":\"0\"}},{\"ConfigID\":\"jl1ceyd1c6mt3ei4umpf5ap06\",\"ConfigName\":\"timur.staging.yml_1641325556_1641332269_1641332856\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/config.yml\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"ETNA__PRODUCTION_FILE=/app/env.yml\",\"ETNA__PRODUCTION__DB__PASSWORD_FILE=/run/secrets/db-password\",\"ETNA__PRODUCTION__ROLLBAR__ACCESS_TOKEN=/run/secrets/rollbar-access-token\",\"ETNA__PRODUCTION__USER_HASH_SECRET=/run/secrets/user-hash-secret\",\"TIMUR_ENV=production\"],\"Healthcheck\":{\"Interval\":10000000000,\"Retries\":3,\"StartPeriod\":1000000000,\"Test\":[\"CMD-SHELL\",\"bash -c 'curl http://localhost:3000 || exit 1'\"],\"Timeout\":5000000000},\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"/var/node_exporter/metrics.prom\",\"Target\":\"/tmp/metrics.prom\",\"Type\":\"bind\"}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"metrics-pw\",\"UID\":\"0\"},\"SecretID\":\"6adzt6tvilj2msj5m4vsy1eug\",\"SecretName\":\"metrics-pw\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"db-password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"user-hash-secret\",\"UID\":\"0\"},\"SecretID\":\"nqdn03euckbucxx1d7brr0gde\",\"SecretName\":\"user-hash-secret\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app\"],\"Target\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Aliases\":[\"app\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Aliases\":[\"timur_app\",\"app\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{}},\"Status\":{\"ContainerStatus\":{\"ContainerID\":\"95a714f8efd181042dc60a29236337bc07a92389c91d8df81e3eac038d2ccddb\",\"ExitCode\":1,\"PID\":0},\"Message\":\"shutdown\",\"PortStatus\":{},\"State\":\"shutdown\",\"Timestamp\":\"2022-01-04T21:48:55.80395479Z\"},\"UpdatedAt\":\"2022-01-04T21:48:55.829545767Z\",\"Version\":{\"Index\":10056263}},{\"CreatedAt\":\"2022-01-04T21:53:20.40610415Z\",\"DesiredState\":\"shutdown\",\"ID\":\"z0xbye6o8sfrrp9tvrrvrpspf\",\"Labels\":{},\"NetworksAttachments\":[{\"Addresses\":[\"10.0.4.198/24\"],\"Network\":{\"CreatedAt\":\"2021-06-12T00:04:08.851633906Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4100\"}},\"ID\":\"pwqf514t16rtmjpq62shyib7h\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.4.1\",\"Subnet\":\"10.0.4.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"Attachable\":true,\"DriverConfiguration\":{\"Name\":\"overlay\"},\"IPAMOptions\":{\"Driver\":{\"Name\":\"default\"}},\"Labels\":{},\"Name\":\"prometheus\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2021-12-28T20:39:20.053403246Z\",\"Version\":{\"Index\":8635318}}},{\"Addresses\":[\"10.0.21.11/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.74850188Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4117\"}},\"ID\":\"c4ggc3aqae1ost27az5ri3nxz\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.21.1\",\"Subnet\":\"10.0.21.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_db\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.751592118Z\",\"Version\":{\"Index\":9866157}}},{\"Addresses\":[\"10.0.19.8/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.712710437Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4115\"}},\"ID\":\"r1u6c0bclbl6wyl1g8478x91v\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.19.1\",\"Subnet\":\"10.0.19.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_fe\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.715086232Z\",\"Version\":{\"Index\":9866153}}}],\"NodeID\":\"ybj02s79vhfv0zrcmwjecr3d6\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"ServiceID\":\"9vxwqyzsiehxqhe2w9pyi39n4\",\"Slot\":1,\"Spec\":{\"ContainerSpec\":{\"Args\":[\"bash\",\"-c\",\"set -e\\nexport METRICS_PW=\\\"$(cat /run/secrets/metrics-pw)\\\"\\nexec /bin/deploy.sh migrate -- /app/bin/puma.sh\\n\"],\"Configs\":[{\"ConfigID\":\"kyzf7xy96uv6ip5x65lgjf1wf\",\"ConfigName\":\"etna.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/env.yml\",\"UID\":\"0\"}},{\"ConfigID\":\"qn484g1c0bmaaw2n1fkueyc8e\",\"ConfigName\":\"timur.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/config.yml\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"ETNA__PRODUCTION_FILE=/app/env.yml\",\"ETNA__PRODUCTION__DB__PASSWORD_FILE=/run/secrets/db-password\",\"ETNA__PRODUCTION__ROLLBAR__ACCESS_TOKEN=/run/secrets/rollbar-access-token\",\"ETNA__PRODUCTION__USER_HASH_SECRET=/run/secrets/user-hash-secret\",\"TIMUR_ENV=production\"],\"Healthcheck\":{\"Interval\":10000000000,\"Retries\":3,\"StartPeriod\":1000000000,\"Test\":[\"CMD-SHELL\",\"bash -c 'curl http://localhost:3000 || exit 1'\"],\"Timeout\":5000000000},\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"/var/node_exporter/metrics.prom\",\"Target\":\"/tmp/metrics.prom\",\"Type\":\"bind\"}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"metrics-pw\",\"UID\":\"0\"},\"SecretID\":\"6adzt6tvilj2msj5m4vsy1eug\",\"SecretName\":\"metrics-pw\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"db-password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"user-hash-secret\",\"UID\":\"0\"},\"SecretID\":\"nqdn03euckbucxx1d7brr0gde\",\"SecretName\":\"user-hash-secret\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app\"],\"Target\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Aliases\":[\"app\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Aliases\":[\"timur_app\",\"app\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{}},\"Status\":{\"ContainerStatus\":{\"ContainerID\":\"9b86e192529d164b80087dbb180858e52f7db86027237dd2d4e6f6db5998505b\",\"ExitCode\":1,\"PID\":0},\"Message\":\"shutdown\",\"PortStatus\":{},\"State\":\"shutdown\",\"Timestamp\":\"2022-01-04T21:56:07.135526801Z\"},\"UpdatedAt\":\"2022-01-04T21:56:07.224862998Z\",\"Version\":{\"Index\":10057332}}]","stderr":"","i":"22 /home/home/monoetna/swarm/swarm-keeper/lib/edit-config-deploy.recording"}
{"cmd":"http","args":["--check-status","--proxy=http:socks5h://127.0.0.1:9090","--proxy=https:socks5h://127.0.0.1:9090","GET","https://portainer.dsco.ucsf.edu/api/endpoints/1/docker/services","Authorization: Bearer xxx","filters=={\"name\":[\"timur-staging_postgres\"]}"],"result":"0","stdin":"","stdout":"[{\"CreatedAt\":\"2022-01-03T23:20:42.40988215Z\",\"Endpoint\":{\"Spec\":{\"Mode\":\"vip\"},\"VirtualIPs\":[{\"Addr\":\"10.0.21.2/24\",\"NetworkID\":\"c4ggc3aqae1ost27az5ri3nxz\"}]},\"ID\":\"l8z4f6ubn3a07ldj5mscerbog\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"PreviousSpec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"com.docker.stack.image\":\"postgres:10.19\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Replicated\":{\"Replicas\":1}},\"Name\":\"timur-staging_postgres\",\"TaskTemplate\":{\"ContainerSpec\":{\"Env\":[\"POSTGRES_DB=timur\",\"POSTGRES_PASSWORD_FILE=/run/secrets/password\",\"POSTGRES_USER=developer\"],\"Image\":\"postgres:10.19@sha256:ac0b1670c906d610741e93a517e6492979b7b0ad2127862c8a574ce265dc8804\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur_staging_db\",\"Target\":\"/var/lib/postgresql/data\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"postgres\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_db == true\"],\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"},{\"OS\":\"linux\"},{\"OS\":\"linux\"},{\"Architecture\":\"arm64\",\"OS\":\"linux\"},{\"Architecture\":\"386\",\"OS\":\"linux\"}]},\"Resources\":{},\"Runtime\":\"container\"}},\"Spec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"com.docker.stack.image\":\"postgres:10.19\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Replicated\":{\"Replicas\":1}},\"Name\":\"timur-staging_postgres\",\"TaskTemplate\":{\"ContainerSpec\":{\"Env\":[\"POSTGRES_DB=timur\",\"POSTGRES_PASSWORD_FILE=/run/secrets/password\",\"POSTGRES_USER=developer\"],\"Image\":\"postgres:10.19@sha256:ac0b1670c906d610741e93a517e6492979b7b0ad2127862c8a574ce265dc8804\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur_staging_db\",\"Target\":\"/var/lib/postgresql/data\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"postgres\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_db == true\"],\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"},{\"OS\":\"linux\"},{\"OS\":\"linux\"},{\"Architecture\":\"arm64\",\"OS\":\"linux\"},{\"Architecture\":\"386\",\"OS\":\"linux\"}]},\"Resources\":{},\"Runtime\":\"container\"}},\"UpdatedAt\":\"2022-01-04T21:55:46.585093564Z\",\"Version\":{\"Index\":10057273}}]","stderr":"","i":"23 /home/home/monoetna/swarm/swarm-keeper/lib/edit-config-deploy.recording"}
{"cmd":"http","args":["--check-status","--proxy=http:socks5h://127.0.0.1:9090","--proxy=https:socks5h://127.0.0.1:9090","GET","https://portainer.dsco.ucsf.edu/api/endpoints/1/docker/tasks","Authorization: Bearer xxx","filters=={\"service\":[\"timur-staging_postgres\"],\"desired-state\":[\"shutdown\"]}"],"result":"0","stdin":"","stdout":"[{\"CreatedAt\":\"2022-01-04T00:26:25.994684423Z\",\"DesiredState\":\"shutdown\",\"ID\":\"37lq721bd53i4l8i44b4vod4i\",\"Labels\":{},\"NetworksAttachments\":[{\"Addresses\":[\"10.0.21.152/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.74850188Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4117\"}},\"ID\":\"c4ggc3aqae1ost27az5ri3nxz\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.21.1\",\"Subnet\":\"10.0.21.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_db\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.751592118Z\",\"Version\":{\"Index\":9866157}}}],\"NodeID\":\"g1u5emqok8xewkg6k4g2t6ra9\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"ServiceID\":\"l8z4f6ubn3a07ldj5mscerbog\",\"Slot\":1,\"Spec\":{\"ContainerSpec\":{\"Env\":[\"POSTGRES_DB=timur\",\"POSTGRES_PASSWORD_FILE=/run/secrets/password\",\"POSTGRES_USER=developer\"],\"Image\":\"postgres:10.19@sha256:e7efcc5f6a9cd97b0346ce76ffc444dd6692bde07cf35265860655fa01f24da8\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur_staging_db\",\"Target\":\"/var/lib/postgresql/data\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"postgres\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_db == true\"],\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"},{\"OS\":\"linux\"},{\"OS\":\"linux\"},{\"Architecture\":\"arm64\",\"OS\":\"linux\"},{\"Architecture\":\"386\",\"OS\":\"linux\"}]},\"Resources\":{}},\"Status\":{\"ContainerStatus\":{\"ContainerID\":\"dfa1d67faeb912af362c8574b7af5b160b83ca8b8cf6c8d1b5cb8c965bb205df\",\"ExitCode\":0,\"PID\":0},\"Message\":\"shutdown\",\"PortStatus\":{},\"State\":\"shutdown\",\"Timestamp\":\"2022-01-04T19:46:08.190644587Z\"},\"UpdatedAt\":\"2022-01-04T19:46:08.245789154Z\",\"Version\":{\"Index\":10039119}},{\"CreatedAt\":\"2022-01-03T23:29:34.697196592Z\",\"DesiredState\":\"shutdown\",\"ID\":\"j4dkpw4foytlxyh0upu296e27\",\"Labels\":{},\"NetworksAttachments\":[{\"Addresses\":[\"10.0.21.44/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.74850188Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4117\"}},\"ID\":\"c4ggc3aqae1ost27az5ri3nxz\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.21.1\",\"Subnet\":\"10.0.21.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_db\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.751592118Z\",\"Version\":{\"Index\":9866157}}}],\"NodeID\":\"g1u5emqok8xewkg6k4g2t6ra9\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"ServiceID\":\"l8z4f6ubn3a07ldj5mscerbog\",\"Slot\":1,\"Spec\":{\"ContainerSpec\":{\"Env\":[\"POSTGRES_DB=timur\",\"POSTGRES_PASSWORD_FILE=/run/secrets/password\",\"POSTGRES_USER=developer\"],\"Image\":\"docker.io/postgres:10.19@sha256:e7efcc5f6a9cd97b0346ce76ffc444dd6692bde07cf35265860655fa01f24da8\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur_staging_db\",\"Target\":\"/var/lib/postgresql/data\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"postgres\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_db == true\"],\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"},{\"OS\":\"linux\"},{\"OS\":\"linux\"},{\"Architecture\":\"arm64\",\"OS\":\"linux\"},{\"Architecture\":\"386\",\"OS\":\"linux\"}]},\"Resources\":{\"Limits\":{},\"Reservations\":{}}},\"Status\":{\"ContainerStatus\":{\"ContainerID\":\"4538933ffa8fd5d6d81554c6ed088651dd63b15c274339c83cb876e5cb64c7f2\",\"ExitCode\":0,\"PID\":0},\"Message\":\"shutdown\",\"PortStatus\":{},\"State\":\"shutdown\",\"Timestamp\":\"2022-01-04T00:26:29.631343719Z\"},\"UpdatedAt\":\"2022-01-04T00:26:29.744551684Z\",\"Version\":{\"Index\":9879380}}]","stderr":"","i":"24 /home/home/monoetna/swarm/swarm-keeper/lib/edit-config-deploy.recording"}
{"cmd":"http","args":["--check-status","--proxy=http:socks5h://127.0.0.1:9090","--proxy=https:socks5h://127.0.0.1:9090","GET","https://portainer.dsco.ucsf.edu/api/endpoints/1/docker/services","Authorization: Bearer xxx","filters=={\"name\":[\"timur-staging_app_assets_deployer\"]}"],"result":"0","stdin":"","stdout":"[{\"CreatedAt\":\"2022-01-03T23:20:41.23437548Z\",\"Endpoint\":{\"Spec\":{\"Mode\":\"vip\"},\"VirtualIPs\":[{\"Addr\":\"10.0.20.2/24\",\"NetworkID\":\"m52fcusnqimfjqpnrnqrq34gs\"}]},\"ID\":\"qgjxwctj8zxsu5i6ux5bf40j2\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"PreviousSpec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Global\":{}},\"Name\":\"timur-staging_app_assets_deployer\",\"TaskTemplate\":{\"ContainerSpec\":{\"Args\":[\"/bin/deploy.sh\",\"syncAssets\",\"--\",\"true\"],\"Env\":[\"APP_NAME=timur\",\"TIMUR_ENV=production\"],\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur-staging_app_public\",\"Target\":\"/sync-assets\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null}},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app_assets_deployer\"],\"Target\":\"m52fcusnqimfjqpnrnqrq34gs\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_app_public == true\"],\"MaxReplicas\":1,\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"RestartPolicy\":{\"Condition\":\"none\",\"MaxAttempts\":0},\"Runtime\":\"container\"}},\"Spec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Global\":{}},\"Name\":\"timur-staging_app_assets_deployer\",\"TaskTemplate\":{\"ContainerSpec\":{\"Args\":[\"/bin/deploy.sh\",\"syncAssets\",\"--\",\"true\"],\"Env\":[\"APP_NAME=timur\",\"TIMUR_ENV=production\"],\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur-staging_app_public\",\"Target\":\"/sync-assets\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null}},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app_assets_deployer\"],\"Target\":\"m52fcusnqimfjqpnrnqrq34gs\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_app_public == true\"],\"MaxReplicas\":1,\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"RestartPolicy\":{\"Condition\":\"none\",\"MaxAttempts\":0},\"Runtime\":\"container\"}},\"UpdatedAt\":\"2022-01-04T21:55:45.413437387Z\",\"Version\":{\"Index\":10057271}}]","stderr":"","i":"25 /home/home/monoetna/swarm/swarm-keeper/lib/edit-config-deploy.recording"}
{"cmd":"http","args":["--check-status","--proxy=http:socks5h://127.0.0.1:9090","--proxy=https:socks5h://127.0.0.1:9090","GET","https://portainer.dsco.ucsf.edu/api/endpoints/1/docker/tasks","Authorization: Bearer xxx","filters=={\"service\":[\"timur-staging_app_assets_deployer\"],\"desired-state\":[\"shutdown\"]}"],"result":"0","stdin":"","stdout":"[{\"CreatedAt\":\"2022-01-03T23:30:26.983452827Z\",\"DesiredState\":\"shutdown\",\"ID\":\"rgac3os26dn9kdz36273cffys\",\"Labels\":{},\"NetworksAttachments\":[{\"Addresses\":[\"10.0.20.3/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.740552509Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4116\"}},\"ID\":\"m52fcusnqimfjqpnrnqrq34gs\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.20.1\",\"Subnet\":\"10.0.20.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_default\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.743252018Z\",\"Version\":{\"Index\":9866155}}}],\"NodeID\":\"g1u5emqok8xewkg6k4g2t6ra9\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"ServiceID\":\"qgjxwctj8zxsu5i6ux5bf40j2\",\"Spec\":{\"ContainerSpec\":{\"Args\":[\"/bin/deploy.sh\",\"syncAssets\",\"--\",\"true\"],\"Env\":[\"APP_NAME=timur\",\"TIMUR_ENV=production\"],\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur-staging_app_public\",\"Target\":\"/sync-assets\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null}},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app_assets_deployer\"],\"Target\":\"m52fcusnqimfjqpnrnqrq34gs\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_app_public == true\"],\"MaxReplicas\":1,\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"RestartPolicy\":{\"Condition\":\"none\",\"MaxAttempts\":0}},\"Status\":{\"ContainerStatus\":{\"ContainerID\":\"48c899487b87f0357c8a7290994853b5845d6bd678286c887221b14cb2962aa7\",\"ExitCode\":0,\"PID\":0},\"Message\":\"finished\",\"PortStatus\":{},\"State\":\"complete\",\"Timestamp\":\"2022-01-03T23:31:40.659571482Z\"},\"UpdatedAt\":\"2022-01-03T23:31:40.933472801Z\",\"Version\":{\"Index\":9868625}}]","stderr":"","i":"26 /home/home/monoetna/swarm/swarm-keeper/lib/edit-config-deploy.recording"}
{"cmd":"http","args":["--check-status","--proxy=http:socks5h://127.0.0.1:9090","--proxy=https:socks5h://127.0.0.1:9090","GET","https://portainer.dsco.ucsf.edu/api/endpoints/1/docker/services","Authorization: Bearer xxx","filters=={\"name\":[\"timur-staging_app_fe\"]}"],"result":"0","stdin":"","stdout":"[{\"CreatedAt\":\"2022-01-03T23:20:39.571206988Z\",\"Endpoint\":{\"Spec\":{\"Mode\":\"vip\"},\"VirtualIPs\":[{\"Addr\":\"10.0.3.214/24\",\"NetworkID\":\"wl9z0sp3su5p6za45i3klgtn6\"},{\"Addr\":\"10.0.19.2/24\",\"NetworkID\":\"r1u6c0bclbl6wyl1g8478x91v\"}]},\"ID\":\"y8mocvq0olbq809713v3ey9hd\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"PreviousSpec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur_app_fe:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Replicated\":{\"Replicas\":1}},\"Name\":\"timur-staging_app_fe\",\"TaskTemplate\":{\"ContainerSpec\":{\"Configs\":[{\"ConfigID\":\"efyi8cnelo5i809bnga85ozje\",\"ConfigName\":\"browser.system.include\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/usr/opt/httpd.conf.d/browser.system.include\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"TIMUR_ENV=production\"],\"Image\":\"etnaagent/timur_app_fe:staging@sha256:f3527445b7147a4fba3923abc4f308f12457ffcf120021c7d9a0e234e7e048a3\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur-staging_app_public\",\"Target\":\"/app/public\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"User\":\"0:3000\"},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app_fe\"],\"Target\":\"wl9z0sp3su5p6za45i3klgtn6\"},{\"Aliases\":[\"app_fe\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_app_public == true\"],\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"RestartPolicy\":{\"Condition\":\"none\",\"MaxAttempts\":0},\"Runtime\":\"container\"}},\"Spec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur_app_fe:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Replicated\":{\"Replicas\":1}},\"Name\":\"timur-staging_app_fe\",\"TaskTemplate\":{\"ContainerSpec\":{\"Configs\":[{\"ConfigID\":\"efyi8cnelo5i809bnga85ozje\",\"ConfigName\":\"browser.system.include\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/usr/opt/httpd.conf.d/browser.system.include\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"TIMUR_ENV=production\"],\"Image\":\"etnaagent/timur_app_fe:staging@sha256:f3527445b7147a4fba3923abc4f308f12457ffcf120021c7d9a0e234e7e048a3\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur-staging_app_public\",\"Target\":\"/app/public\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"User\":\"0:3000\"},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app_fe\"],\"Target\":\"wl9z0sp3su5p6za45i3klgtn6\"},{\"Aliases\":[\"app_fe\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_app_public == true\"],\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"RestartPolicy\":{\"Condition\":\"none\",\"MaxAttempts\":0},\"Runtime\":\"container\"}},\"UpdatedAt\":\"2022-01-04T21:55:49.683887969Z\",\"Version\":{\"Index\":10057286}}]","stderr":"","i":"27 /home/home/monoetna/swarm/swarm-keeper/lib/edit-config-deploy.recording"}
{"cmd":"http","args":["--check-status","--proxy=http:socks5h://127.0.0.1:9090","--proxy=https:socks5h://127.0.0.1:9090","GET","https://portainer.dsco.ucsf.edu/api/endpoints/1/docker/tasks","Authorization: Bearer xxx","filters=={\"service\":[\"timur-staging_app_fe\"],\"desired-state\":[\"shutdown\"]}"],"result":"0","stdin":"","stdout":"[]","stderr":"","i":"28 /home/home/monoetna/swarm/swarm-keeper/lib/edit-config-deploy.recording"}
{"cmd":"http","args":["--check-status","--proxy=http:socks5h://127.0.0.1:9090","--proxy=https:socks5h://127.0.0.1:9090","GET","https://portainer.dsco.ucsf.edu/api/endpoints/1/docker/configs","Authorization: Bearer xxx","filters=={\"name\":[\"timur.staging.yml\"]}"],"result":"0","stdin":"","stdout":"[{\"CreatedAt\":\"2022-01-04T21:53:07.844544002Z\",\"ID\":\"qn484g1c0bmaaw2n1fkueyc8e\",\"Portainer\":{\"ResourceControl\":{\"Id\":236,\"ResourceId\":\"qn484g1c0bmaaw2n1fkueyc8e\",\"SubResourceIds\":[],\"Type\":7,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"Spec\":{\"Data\":\"LS0tCjpwcm9kdWN0aW9uOgogIDpkYjoKICAgIDphZGFwdGVyOiBwb3N0Z3Jlc3FsCiAgICA6ZW5jb2Rpbmc6IHVuaWNvZGUKICAgIDp1c2VyOiBkZXZlbG9wZXIKICAgIDpob3N0OiB0aW11ci1zdGFnaW5nX3Bvc3RncmVzCiAgICA6cG9ydDogNTQzMgogICAgOnBvb2w6IDUKICAgIDp0aW1lb3V0OiA1MDAwCiAgICA6ZGF0YWJhc2U6IHRpbXVyCiAgICA6c2VhcmNoX3BhdGg6CiAgICAtIHByaXZhdGU=\",\"Labels\":{\"canon\":\"timur.staging.yml\",\"replaces\":\"timur.staging.yml_1641333148\"},\"Name\":\"timur.staging.yml\"},\"UpdatedAt\":\"2022-01-04T21:53:07.844544002Z\",\"Version\":{\"Index\":10056888}},{\"CreatedAt\":\"2022-01-04T21:52:28.943648138Z\",\"ID\":\"sh4pln0b83bunf130n8v9e42n\",\"Portainer\":{\"ResourceControl\":{\"Id\":235,\"ResourceId\":\"sh4pln0b83bunf130n8v9e42n\",\"SubResourceIds\":[],\"Type\":7,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"Spec\":{\"Data\":\"LS0tCjpwcm9kdWN0aW9uOgogIDpkYjoKICAgIDphZGFwdGVyOiBwb3N0Z3Jlc3FsCiAgICA6ZW5jb2Rpbmc6IHVuaWNvZGUKICAgIDp1c2VyOiBkZXZlbG9wZXIKICAgIDpob3N0OiB0aW11ci1zdGFnaW5nX3Bvc3RncmVzCiAgICA6cG9ydDogNTQzMgogICAgOnBvb2w6IDUKICAgIDp0aW1lb3V0OiA1MDAwCiAgICA6ZGF0YWJhc2U6IHRpbXVyCiAgICA6c2VhcmNoX3BhdGg6CiAgICAtIHByaXZhdGU=\",\"Labels\":{\"canon\":\"timur.staging.yml\",\"replaces\":\"timur.staging.yml\"},\"Name\":\"timur.staging.yml_1641333148\"},\"UpdatedAt\":\"2022-01-04T21:52:28.943648138Z\",\"Version\":{\"Index\":10056765}},{\"CreatedAt\":\"2022-01-04T21:55:36.743578474Z\",\"ID\":\"v708ckky9705nzt3rv6gya39l\",\"Portainer\":{\"ResourceControl\":{\"Id\":237,\"ResourceId\":\"v708ckky9705nzt3rv6gya39l\",\"SubResourceIds\":[],\"Type\":7,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"Spec\":{\"Data\":\"LS0tCjpwcm9kdWN0aW9uOgogIDpkYjoKICAgIDphZGFwdGVyOiBwb3N0Z3Jlc3FsCiAgICA6ZW5jb2Rpbmc6IHVuaWNvZGUKICAgIDp1c2VyOiBkZXZlbG9wZXIKICAgIDpob3N0OiB0aW11ci1zdGFnaW5nX3Bvc3RncmVzCiAgICA6cG9ydDogNTQzMgogICAgOnBvb2w6IDUKICAgIDp0aW1lb3V0OiA1MDAwCiAgICA6ZGF0YWJhc2U6IHRpbXVyCiAgICA6c2VhcmNoX3BhdGg6CiAgICAtIHByaXZhdGU=\",\"Labels\":{\"canon\":\"timur.staging.yml\",\"replaces\":\"timur.staging.yml\"},\"Name\":\"timur.staging.yml_1641333336\"},\"UpdatedAt\":\"2022-01-04T21:55:36.743578474Z\",\"Version\":{\"Index\":10057248}}]","stderr":"","i":"29 /home/home/monoetna/swarm/swarm-keeper/lib/edit-config-deploy.recording"}
{"cmd":"http","args":["--check-status","--proxy=http:socks5h://127.0.0.1:9090","--proxy=https:socks5h://127.0.0.1:9090","DELETE","https://portainer.dsco.ucsf.edu/api/endpoints/1/docker/configs/qn484g1c0bmaaw2n1fkueyc8e","Authorization: Bearer xxx"],"result":"0","stdin":"","stdout":"","stderr":"","i":"30 /home/home/monoetna/swarm/swarm-keeper/lib/edit-config-deploy.recording"}
{"cmd":"http","args":["--check-status","--proxy=http:socks5h://127.0.0.1:9090","--proxy=https:socks5h://127.0.0.1:9090","GET","https://portainer.dsco.ucsf.edu/api/endpoints/1/docker/configs","Authorization: Bearer xxx","filters=={\"name\":[\"timur.staging.yml_1641333336\"]}"],"result":"0","stdin":"","stdout":"[{\"CreatedAt\":\"2022-01-04T21:55:36.743578474Z\",\"ID\":\"v708ckky9705nzt3rv6gya39l\",\"Portainer\":{\"ResourceControl\":{\"Id\":237,\"ResourceId\":\"v708ckky9705nzt3rv6gya39l\",\"SubResourceIds\":[],\"Type\":7,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"Spec\":{\"Data\":\"LS0tCjpwcm9kdWN0aW9uOgogIDpkYjoKICAgIDphZGFwdGVyOiBwb3N0Z3Jlc3FsCiAgICA6ZW5jb2Rpbmc6IHVuaWNvZGUKICAgIDp1c2VyOiBkZXZlbG9wZXIKICAgIDpob3N0OiB0aW11ci1zdGFnaW5nX3Bvc3RncmVzCiAgICA6cG9ydDogNTQzMgogICAgOnBvb2w6IDUKICAgIDp0aW1lb3V0OiA1MDAwCiAgICA6ZGF0YWJhc2U6IHRpbXVyCiAgICA6c2VhcmNoX3BhdGg6CiAgICAtIHByaXZhdGU=\",\"Labels\":{\"canon\":\"timur.staging.yml\",\"replaces\":\"timur.staging.yml\"},\"Name\":\"timur.staging.yml_1641333336\"},\"UpdatedAt\":\"2022-01-04T21:55:36.743578474Z\",\"Version\":{\"Index\":10057248}}]","stderr":"","i":"31 /home/home/monoetna/swarm/swarm-keeper/lib/edit-config-deploy.recording"}
{"cmd":"date","args":["+%s"],"result":"0","stdin":"","stdout":"1641333382","stderr":"","i":"32 /home/home/monoetna/swarm/swarm-keeper/lib/edit-config-deploy.recording"}
{"cmd":"http","args":["--check-status","--proxy=http:socks5h://127.0.0.1:9090","--proxy=https:socks5h://127.0.0.1:9090","POST","https://portainer.dsco.ucsf.edu/api/endpoints/1/docker/configs/create","Authorization: Bearer xxx","Name=timur.staging.yml","Data=LS0tCjpwcm9kdWN0aW9uOgogIDpkYjoKICAgIDphZGFwdGVyOiBwb3N0Z3Jlc3FsCiAgICA6ZW5jb2Rpbmc6IHVuaWNvZGUKICAgIDp1c2VyOiBkZXZlbG9wZXIKICAgIDpob3N0OiB0aW11ci1zdGFnaW5nX3Bvc3RncmVzCiAgICA6cG9ydDogNTQzMgogICAgOnBvb2w6IDUKICAgIDp0aW1lb3V0OiA1MDAwCiAgICA6ZGF0YWJhc2U6IHRpbXVyCiAgICA6c2VhcmNoX3BhdGg6CiAgICAtIHByaXZhdGU=","Labels:={","  \"canon\": \"timur.staging.yml\",","  \"replaces\": \"timur.staging.yml_1641333336\"","}"],"result":"0","stdin":"","stdout":"{\"ID\":\"da9539n2gpyfoszjf2o6scc7n\",\"Portainer\":{\"ResourceControl\":{\"Id\":238,\"ResourceId\":\"da9539n2gpyfoszjf2o6scc7n\",\"SubResourceIds\":[],\"Type\":7,\"UserAccesses\":[{\"UserId\":1,\"AccessLevel\":1}],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":false,\"System\":false}}}","stderr":"","i":"33 /home/home/monoetna/swarm/swarm-keeper/lib/edit-config-deploy.recording"}
{"cmd":"http","args":["--check-status","--proxy=http:socks5h://127.0.0.1:9090","--proxy=https:socks5h://127.0.0.1:9090","GET","https://portainer.dsco.ucsf.edu/api/endpoints/1/docker/configs/da9539n2gpyfoszjf2o6scc7n","Authorization: Bearer xxx"],"result":"0","stdin":"","stdout":"{\"CreatedAt\":\"2022-01-04T21:56:23.465311643Z\",\"ID\":\"da9539n2gpyfoszjf2o6scc7n\",\"Portainer\":{\"ResourceControl\":{\"Id\":238,\"ResourceId\":\"da9539n2gpyfoszjf2o6scc7n\",\"SubResourceIds\":[],\"Type\":7,\"UserAccesses\":[{\"UserId\":1,\"AccessLevel\":1}],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":false,\"System\":false}},\"Spec\":{\"Data\":\"LS0tCjpwcm9kdWN0aW9uOgogIDpkYjoKICAgIDphZGFwdGVyOiBwb3N0Z3Jlc3FsCiAgICA6ZW5jb2Rpbmc6IHVuaWNvZGUKICAgIDp1c2VyOiBkZXZlbG9wZXIKICAgIDpob3N0OiB0aW11ci1zdGFnaW5nX3Bvc3RncmVzCiAgICA6cG9ydDogNTQzMgogICAgOnBvb2w6IDUKICAgIDp0aW1lb3V0OiA1MDAwCiAgICA6ZGF0YWJhc2U6IHRpbXVyCiAgICA6c2VhcmNoX3BhdGg6CiAgICAtIHByaXZhdGU=\",\"Labels\":{\"canon\":\"timur.staging.yml\",\"replaces\":\"timur.staging.yml_1641333336\"},\"Name\":\"timur.staging.yml\"},\"UpdatedAt\":\"2022-01-04T21:56:23.465311643Z\",\"Version\":{\"Index\":10057374}}","stderr":"","i":"34 /home/home/monoetna/swarm/swarm-keeper/lib/edit-config-deploy.recording"}
{"cmd":"http","args":["--check-status","--proxy=http:socks5h://127.0.0.1:9090","--proxy=https:socks5h://127.0.0.1:9090","PUT","https://portainer.dsco.ucsf.edu/api/resource_controls/238","Authorization: Bearer xxx","AdministratorsOnly:=true","Public:=false","Teams:=[]","Users:=[]"],"result":"0","stdin":"","stdout":"{\"Id\":238,\"ResourceId\":\"da9539n2gpyfoszjf2o6scc7n\",\"SubResourceIds\":[],\"Type\":7,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}","stderr":"","i":"35 /home/home/monoetna/swarm/swarm-keeper/lib/edit-config-deploy.recording"}
{"cmd":"http","args":["--check-status","--proxy=http:socks5h://127.0.0.1:9090","--proxy=https:socks5h://127.0.0.1:9090","GET","https://portainer.dsco.ucsf.edu/api/endpoints/1/docker/configs","Authorization: Bearer xxx","filters=={\"name\":[\"timur.staging.yml\"]}"],"result":"0","stdin":"","stdout":"[{\"CreatedAt\":\"2022-01-04T21:56:23.465311643Z\",\"ID\":\"da9539n2gpyfoszjf2o6scc7n\",\"Portainer\":{\"ResourceControl\":{\"Id\":238,\"ResourceId\":\"da9539n2gpyfoszjf2o6scc7n\",\"SubResourceIds\":[],\"Type\":7,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"Spec\":{\"Data\":\"LS0tCjpwcm9kdWN0aW9uOgogIDpkYjoKICAgIDphZGFwdGVyOiBwb3N0Z3Jlc3FsCiAgICA6ZW5jb2Rpbmc6IHVuaWNvZGUKICAgIDp1c2VyOiBkZXZlbG9wZXIKICAgIDpob3N0OiB0aW11ci1zdGFnaW5nX3Bvc3RncmVzCiAgICA6cG9ydDogNTQzMgogICAgOnBvb2w6IDUKICAgIDp0aW1lb3V0OiA1MDAwCiAgICA6ZGF0YWJhc2U6IHRpbXVyCiAgICA6c2VhcmNoX3BhdGg6CiAgICAtIHByaXZhdGU=\",\"Labels\":{\"canon\":\"timur.staging.yml\",\"replaces\":\"timur.staging.yml_1641333336\"},\"Name\":\"timur.staging.yml\"},\"UpdatedAt\":\"2022-01-04T21:56:23.465311643Z\",\"Version\":{\"Index\":10057374}},{\"CreatedAt\":\"2022-01-04T21:52:28.943648138Z\",\"ID\":\"sh4pln0b83bunf130n8v9e42n\",\"Portainer\":{\"ResourceControl\":{\"Id\":235,\"ResourceId\":\"sh4pln0b83bunf130n8v9e42n\",\"SubResourceIds\":[],\"Type\":7,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"Spec\":{\"Data\":\"LS0tCjpwcm9kdWN0aW9uOgogIDpkYjoKICAgIDphZGFwdGVyOiBwb3N0Z3Jlc3FsCiAgICA6ZW5jb2Rpbmc6IHVuaWNvZGUKICAgIDp1c2VyOiBkZXZlbG9wZXIKICAgIDpob3N0OiB0aW11ci1zdGFnaW5nX3Bvc3RncmVzCiAgICA6cG9ydDogNTQzMgogICAgOnBvb2w6IDUKICAgIDp0aW1lb3V0OiA1MDAwCiAgICA6ZGF0YWJhc2U6IHRpbXVyCiAgICA6c2VhcmNoX3BhdGg6CiAgICAtIHByaXZhdGU=\",\"Labels\":{\"canon\":\"timur.staging.yml\",\"replaces\":\"timur.staging.yml\"},\"Name\":\"timur.staging.yml_1641333148\"},\"UpdatedAt\":\"2022-01-04T21:52:28.943648138Z\",\"Version\":{\"Index\":10056765}},{\"CreatedAt\":\"2022-01-04T21:55:36.743578474Z\",\"ID\":\"v708ckky9705nzt3rv6gya39l\",\"Portainer\":{\"ResourceControl\":{\"Id\":237,\"ResourceId\":\"v708ckky9705nzt3rv6gya39l\",\"SubResourceIds\":[],\"Type\":7,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"Spec\":{\"Data\":\"LS0tCjpwcm9kdWN0aW9uOgogIDpkYjoKICAgIDphZGFwdGVyOiBwb3N0Z3Jlc3FsCiAgICA6ZW5jb2Rpbmc6IHVuaWNvZGUKICAgIDp1c2VyOiBkZXZlbG9wZXIKICAgIDpob3N0OiB0aW11ci1zdGFnaW5nX3Bvc3RncmVzCiAgICA6cG9ydDogNTQzMgogICAgOnBvb2w6IDUKICAgIDp0aW1lb3V0OiA1MDAwCiAgICA6ZGF0YWJhc2U6IHRpbXVyCiAgICA6c2VhcmNoX3BhdGg6CiAgICAtIHByaXZhdGU=\",\"Labels\":{\"canon\":\"timur.staging.yml\",\"replaces\":\"timur.staging.yml\"},\"Name\":\"timur.staging.yml_1641333336\"},\"UpdatedAt\":\"2022-01-04T21:55:36.743578474Z\",\"Version\":{\"Index\":10057248}}]","stderr":"","i":"36 /home/home/monoetna/swarm/swarm-keeper/lib/edit-config-deploy.recording"}
{"cmd":"http","args":["--check-status","--proxy=http:socks5h://127.0.0.1:9090","--proxy=https:socks5h://127.0.0.1:9090","GET","https://portainer.dsco.ucsf.edu/api/stacks","Authorization: Bearer xxx"],"result":"0","stdin":"","stdout":"[{\"Id\":2,\"Name\":\"redis-ha\",\"Type\":1,\"EndpointId\":1,\"SwarmId\":\"npcpmkzm9t2zp6gfq9o96wogc\",\"EntryPoint\":\"swarm/redis.yml\",\"Env\":[],\"ResourceControl\":{\"Id\":3,\"ResourceId\":\"1_redis-ha\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false},\"Status\":1,\"ProjectPath\":\"/data/compose/2\",\"CreationDate\":1629483058,\"CreatedBy\":\"etna\",\"UpdateDate\":1630428797,\"UpdatedBy\":\"etna\",\"AdditionalFiles\":null,\"AutoUpdate\":null,\"GitConfig\":{\"URL\":\"https://github.com/mountetna/monoetna.git\",\"ReferenceName\":\"refs/heads/swarm/stacks\",\"ConfigFilePath\":\"swarm/redis.yml\",\"Authentication\":null,\"ConfigHash\":\"\"},\"Namespace\":\"\",\"IsComposeFormat\":false},{\"Id\":4,\"Name\":\"edge\",\"Type\":1,\"EndpointId\":1,\"SwarmId\":\"npcpmkzm9t2zp6gfq9o96wogc\",\"EntryPoint\":\"swarm/edge.yml\",\"Env\":[],\"ResourceControl\":{\"Id\":7,\"ResourceId\":\"1_edge\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[{\"TeamId\":1,\"AccessLevel\":1}],\"Public\":false,\"AdministratorsOnly\":false,\"System\":false},\"Status\":1,\"ProjectPath\":\"/data/compose/4\",\"CreationDate\":1629765680,\"CreatedBy\":\"etna\",\"UpdateDate\":1641113620,\"UpdatedBy\":\"etna\",\"AdditionalFiles\":null,\"AutoUpdate\":null,\"GitConfig\":{\"URL\":\"https://github.com/mountetna/monoetna.git\",\"ReferenceName\":\"refs/heads/swarm/stacks\",\"ConfigFilePath\":\"swarm/edge.yml\",\"Authentication\":null,\"ConfigHash\":\"14c58939ab6b51d3b377fcbb2b68ffaaa528088a\"},\"Namespace\":\"\",\"IsComposeFormat\":false},{\"Id\":7,\"Name\":\"agents\",\"Type\":1,\"EndpointId\":1,\"SwarmId\":\"npcpmkzm9t2zp6gfq9o96wogc\",\"EntryPoint\":\"swarm/agents.yml\",\"Env\":[],\"ResourceControl\":{\"Id\":36,\"ResourceId\":\"1_agents\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false},\"Status\":1,\"ProjectPath\":\"/data/compose/7\",\"CreationDate\":1630378503,\"CreatedBy\":\"etna\",\"UpdateDate\":1641112224,\"UpdatedBy\":\"etna\",\"AdditionalFiles\":null,\"AutoUpdate\":null,\"GitConfig\":{\"URL\":\"https://github.com/mountetna/monoetna.git\",\"ReferenceName\":\"refs/heads/swarm/stacks\",\"ConfigFilePath\":\"swarm/agents.yml\",\"Authentication\":null,\"ConfigHash\":\"6d09a4082adb027ef6389e65215608f34b691e5a\"},\"Namespace\":\"\",\"IsComposeFormat\":false},{\"Id\":12,\"Name\":\"monitor\",\"Type\":1,\"EndpointId\":1,\"SwarmId\":\"npcpmkzm9t2zp6gfq9o96wogc\",\"EntryPoint\":\"swarm/monitor.yml\",\"Env\":[],\"ResourceControl\":{\"Id\":49,\"ResourceId\":\"1_monitor\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false},\"Status\":1,\"ProjectPath\":\"/data/compose/12\",\"CreationDate\":1630445964,\"CreatedBy\":\"etna\",\"UpdateDate\":1641113950,\"UpdatedBy\":\"etna\",\"AdditionalFiles\":null,\"AutoUpdate\":null,\"GitConfig\":{\"URL\":\"https://github.com/mountetna/monoetna.git\",\"ReferenceName\":\"refs/heads/swarm/stacks\",\"ConfigFilePath\":\"swarm/monitor.yml\",\"Authentication\":null,\"ConfigHash\":\"\"},\"Namespace\":\"\",\"IsComposeFormat\":false},{\"Id\":15,\"Name\":\"airflow\",\"Type\":1,\"EndpointId\":1,\"SwarmId\":\"npcpmkzm9t2zp6gfq9o96wogc\",\"EntryPoint\":\"swarm/airflow.yml\",\"Env\":[{\"name\":\"_AIRFLOW_WWW_USER_USERNAME\",\"value\":\"etna\"},{\"name\":\"_AIRFLOW_WWW_USER_PASSWORD\",\"value\":\"etnapassword\"}],\"ResourceControl\":{\"Id\":54,\"ResourceId\":\"1_airflow\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false},\"Status\":1,\"ProjectPath\":\"/data/compose/15\",\"CreationDate\":1630648397,\"CreatedBy\":\"etna\",\"UpdateDate\":1640831223,\"UpdatedBy\":\"etna\",\"AdditionalFiles\":null,\"AutoUpdate\":null,\"GitConfig\":{\"URL\":\"https://github.com/mountetna/monoetna.git\",\"ReferenceName\":\"refs/heads/swarm/stacks\",\"ConfigFilePath\":\"swarm/airflow.yml\",\"Authentication\":null,\"ConfigHash\":\"\"},\"Namespace\":\"\",\"IsComposeFormat\":false},{\"Id\":17,\"Name\":\"vulcan\",\"Type\":1,\"EndpointId\":1,\"SwarmId\":\"npcpmkzm9t2zp6gfq9o96wogc\",\"EntryPoint\":\"swarm/vulcan.yml\",\"Env\":[],\"ResourceControl\":{\"Id\":59,\"ResourceId\":\"1_vulcan\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false},\"Status\":1,\"ProjectPath\":\"/data/compose/17\",\"CreationDate\":1630827434,\"CreatedBy\":\"etna\",\"UpdateDate\":1641241242,\"UpdatedBy\":\"etna\",\"AdditionalFiles\":null,\"AutoUpdate\":{\"Interval\":\"\",\"Webhook\":\"\",\"JobID\":\"\"},\"GitConfig\":{\"URL\":\"https://github.com/mountetna/monoetna.git\",\"ReferenceName\":\"refs/heads/swarm/stacks\",\"ConfigFilePath\":\"swarm/vulcan.yml\",\"Authentication\":null,\"ConfigHash\":\"\"},\"Namespace\":\"\",\"IsComposeFormat\":false},{\"Id\":28,\"Name\":\"janus-staging\",\"Type\":1,\"EndpointId\":1,\"SwarmId\":\"npcpmkzm9t2zp6gfq9o96wogc\",\"EntryPoint\":\"swarm/janus-staging.yml\",\"Env\":[{\"name\":\"APP_NAME\",\"value\":\"janus\"},{\"name\":\"ENV\",\"value\":\"staging\"},{\"name\":\"APP_ENV\",\"value\":\"JANUS_ENV\"},{\"name\":\"APP_CONFIG\",\"value\":\"janus.staging.yml\"},{\"name\":\"ENV_CONFIG\",\"value\":\"etna.staging.yml\"}],\"ResourceControl\":{\"Id\":83,\"ResourceId\":\"1_janus-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false},\"Status\":1,\"ProjectPath\":\"/data/compose/28\",\"CreationDate\":1638227821,\"CreatedBy\":\"etna\",\"UpdateDate\":1641330711,\"UpdatedBy\":\"etna\",\"AdditionalFiles\":null,\"AutoUpdate\":{\"Interval\":\"\",\"Webhook\":\"\",\"JobID\":\"\"},\"GitConfig\":{\"URL\":\"https://github.com/mountetna/monoetna.git\",\"ReferenceName\":\"refs/heads/swarm/stacks\",\"ConfigFilePath\":\"swarm/janus-staging.yml\",\"Authentication\":null,\"ConfigHash\":\"\"},\"Namespace\":\"\",\"IsComposeFormat\":false},{\"Id\":30,\"Name\":\"polyphemus-staging\",\"Type\":1,\"EndpointId\":1,\"SwarmId\":\"npcpmkzm9t2zp6gfq9o96wogc\",\"EntryPoint\":\"swarm/polyphemus-staging.yml\",\"Env\":[{\"name\":\"APP_ENV\",\"value\":\"POLYPHEMUS_ENV\"},{\"name\":\"APP_NAME\",\"value\":\"polyphemus\"},{\"name\":\"ENV\",\"value\":\"staging\"},{\"name\":\"APP_CONFIG\",\"value\":\"polyphemus.staging.yml\"},{\"name\":\"ENV_CONFIG\",\"value\":\"etna.staging.yml\"}],\"ResourceControl\":{\"Id\":140,\"ResourceId\":\"1_polyphemus-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false},\"Status\":1,\"ProjectPath\":\"/data/compose/30\",\"CreationDate\":1640813746,\"CreatedBy\":\"etna\",\"UpdateDate\":1641254093,\"UpdatedBy\":\"etna\",\"AdditionalFiles\":[],\"AutoUpdate\":{\"Interval\":\"\",\"Webhook\":\"\",\"JobID\":\"\"},\"GitConfig\":{\"URL\":\"https://github.com/mountetna/monoetna\",\"ReferenceName\":\"refs/heads/swarm/stacks\",\"ConfigFilePath\":\"swarm/polyphemus-staging.yml\",\"Authentication\":null,\"ConfigHash\":\"14c58939ab6b51d3b377fcbb2b68ffaaa528088a\"},\"Namespace\":\"\",\"IsComposeFormat\":false},{\"Id\":36,\"Name\":\"timur-staging\",\"Type\":1,\"EndpointId\":1,\"SwarmId\":\"npcpmkzm9t2zp6gfq9o96wogc\",\"EntryPoint\":\"swarm/timur-staging.yml\",\"Env\":[{\"name\":\"APP_NAME\",\"value\":\"timur\"},{\"name\":\"ENV\",\"value\":\"staging\"},{\"name\":\"APP_ENV\",\"value\":\"TIMUR_ENV\"},{\"name\":\"APP_CONFIG\",\"value\":\"timur.staging.yml_1641333336\"},{\"name\":\"ENV_CONFIG\",\"value\":\"etna.staging.yml\"}],\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false},\"Status\":1,\"ProjectPath\":\"/data/compose/36\",\"CreationDate\":1641252002,\"CreatedBy\":\"etna\",\"UpdateDate\":1641333349,\"UpdatedBy\":\"etna\",\"AdditionalFiles\":[],\"AutoUpdate\":{\"Interval\":\"\",\"Webhook\":\"\",\"JobID\":\"\"},\"GitConfig\":{\"URL\":\"https://github.com/mountetna/monoetna.git\",\"ReferenceName\":\"refs/heads/swarm/stacks\",\"ConfigFilePath\":\"swarm/timur-staging.yml\",\"Authentication\":null,\"ConfigHash\":\"c0b611a840bdf74165e6042683b3cc57f7c57a25\"},\"Namespace\":\"\",\"IsComposeFormat\":false}]","stderr":"","i":"37 /home/home/monoetna/swarm/swarm-keeper/lib/edit-config-deploy.recording"}
{"cmd":"http","args":["--check-status","--proxy=http:socks5h://127.0.0.1:9090","--proxy=https:socks5h://127.0.0.1:9090","GET","https://portainer.dsco.ucsf.edu/api/stacks/36/file","Authorization: Bearer xxx"],"result":"0","stdin":"","stdout":"{\"StackFileContent\":\"version: '3.8'\\n\\nservices:\\n  postgres:\\n    image: postgres:10.19\\n    environment:\\n      POSTGRES_DB: \\\"${APP_NAME}\\\"\\n      POSTGRES_PASSWORD_FILE: /run/secrets/password\\n      POSTGRES_USER: developer\\n    volumes:\\n      - db:/var/lib/postgresql/data\\n    deploy:\\n      placement:\\n        constraints:\\n          - node.labels.volumes.${APP_NAME}_${ENV}_db == true\\n    networks:\\n      - db\\n    secrets:\\n      - source: db-pw\\n        target: password\\n\\n  app:\\n    environment:\\n      - APP_NAME=${APP_NAME}\\n      - ${APP_ENV}=production\\n      - ETNA__PRODUCTION_FILE=/app/env.yml\\n      - ETNA__PRODUCTION__DB__PASSWORD_FILE=/run/secrets/db-password\\n      - ETNA__PRODUCTION__ROLLBAR__ACCESS_TOKEN=/run/secrets/rollbar-access-token\\n      - ETNA__PRODUCTION__USER_HASH_SECRET=/run/secrets/user-hash-secret\\n      #- ETNA__PRODUCTION__HMAC_KEYS__METIS_FILE=/run/secrets/staging-metis-hmac\\n      #- ETNA__PRODUCTION__HMAC_KEYS__MAGMA_FILE=/run/secrets/staging-metis-hmac\\n    command:\\n      - bash\\n      - -c\\n      - |\\n        set -e\\n        export METRICS_PW=\\\"$$(cat /run/secrets/metrics-pw)\\\"\\n        exec /bin/deploy.sh migrate -- /app/bin/puma.sh\\n    image: etnaagent/${APP_NAME}:${ENV}\\n    volumes:\\n      #- ${DATA_SOURCE}/${APP_NAME}/:/app/data/${APP_NAME}\\n      - /var/node_exporter/metrics.prom:/tmp/metrics.prom\\n    #user: ${APP_UID}:999 # metis:docker\\n    deploy:\\n      update_config:\\n        parallelism: 1\\n        order: start-first\\n      labels:\\n        - autoupdate=true\\n      #placement:\\n        #constraints:\\n          #- node.labels.volumes.${APP_NAME}_${ENV}_data == true\\n    healthcheck:\\n      interval: 10s\\n      retries: 3\\n      start_period: 1s\\n      test: bash -c 'curl http://localhost:3000 || exit 1'\\n      timeout: 5s\\n    configs:\\n      - source: config\\n        target: /app/config.yml\\n      - source: env\\n        target: /app/env.yml\\n    networks:\\n      db:\\n      prometheus:\\n      fe:\\n        aliases:\\n          - ${APP_NAME}_app\\n    secrets:\\n      #- staging-metis-hmac\\n      #- staging-magma-hmac\\n      - metrics-pw\\n      - user-hash-secret\\n      - source: db-pw\\n        target: db-password\\n      #- rollbar-access-token\\n\\n  app_fe:\\n    environment:\\n      - APP_NAME=${APP_NAME}\\n      - ${APP_ENV}=production\\n    image: etnaagent/${APP_NAME}_app_fe:${ENV}\\n    networks:\\n      - edge_bridge\\n      - fe\\n    volumes:\\n      - app_public:/app/public\\n      #- ${DATA_SOURCE}/${APP_NAME}/:/app/data/${APP_NAME}:ro\\n    # Notably, apache needs to start as super user but it immediately downgrades\\n    # its own user permissions after bootup.  See the includes.\\n    user: 0:3000 # su:browser\\n    configs:\\n      - source: browser.system.include\\n        target: /usr/opt/httpd.conf.d/browser.system.include\\n    deploy:\\n      labels:\\n        - autoupdate=true\\n      restart_policy:\\n        condition: none\\n      placement:\\n        constraints:\\n          - node.labels.volumes.${APP_NAME}_${ENV}_app_public == true\\n          #- node.labels.volumes.${APP_NAME}_${ENV}_data == true\\n\\n  app_assets_deployer:\\n    environment:\\n      - APP_NAME=${APP_NAME}\\n      - ${APP_ENV}=production\\n\\n    command: /bin/deploy.sh syncAssets -- true # Sync the assets to the shared data volume and stop.\\n    image: etnaagent/${APP_NAME}:${ENV}\\n    volumes:\\n      - app_public:/sync-assets:rw\\n\\n    deploy:\\n      labels:\\n        - autoupdate=true\\n      restart_policy:\\n        condition: none\\n      mode: global\\n      placement:\\n        max_replicas_per_node: 1\\n        constraints:\\n          - node.labels.volumes.${APP_NAME}_${ENV}_app_public == true\\n\\nvolumes:\\n  app_public:\\n  db:\\n    name: \\\"${APP_NAME}_${ENV}_db\\\"\\n\\nconfigs:\\n  browser.system.include:\\n    name: ${BROWSER_SYSTEM_INCLUDE:-browser.system.include}\\n    external: true\\n  config:\\n    external: true\\n    name: ${APP_CONFIG:-timur.staging.yml}\\n  env:\\n    external: true\\n    name: ${ENV_CONFIG:-etna.staging.yml}\\n\\nsecrets:\\n  user-hash-secret:\\n    external: true\\n  metrics-pw:\\n    external: true\\n  staging-metis-hmac:\\n    external: true\\n  staging-magma-hmac:\\n    external: true\\n  db-pw:\\n    external: true\\n    name: \\\"${APP_NAME}_${ENV}_db_password\\\"\\n\\nnetworks:\\n  fe:\\n  db:\\n  edge_bridge:\\n    external: true\\n  prometheus:\\n    external: true\"}","stderr":"","i":"38 /home/home/monoetna/swarm/swarm-keeper/lib/edit-config-deploy.recording"}
{"cmd":"http","args":["--check-status","--proxy=http:socks5h://127.0.0.1:9090","--proxy=https:socks5h://127.0.0.1:9090","PUT","https://portainer.dsco.ucsf.edu/api/stacks/36?endpointId=1","Authorization: Bearer xxx"],"result":"0","stdin":"{\"stackFileContent\":\"version: '3.8'\\n\\nservices:\\n  postgres:\\n    image: postgres:10.19\\n    environment:\\n      POSTGRES_DB: \\\"${APP_NAME}\\\"\\n      POSTGRES_PASSWORD_FILE: /run/secrets/password\\n      POSTGRES_USER: developer\\n    volumes:\\n      - db:/var/lib/postgresql/data\\n    deploy:\\n      placement:\\n        constraints:\\n          - node.labels.volumes.${APP_NAME}_${ENV}_db == true\\n    networks:\\n      - db\\n    secrets:\\n      - source: db-pw\\n        target: password\\n\\n  app:\\n    environment:\\n      - APP_NAME=${APP_NAME}\\n      - ${APP_ENV}=production\\n      - ETNA__PRODUCTION_FILE=/app/env.yml\\n      - ETNA__PRODUCTION__DB__PASSWORD_FILE=/run/secrets/db-password\\n      - ETNA__PRODUCTION__ROLLBAR__ACCESS_TOKEN=/run/secrets/rollbar-access-token\\n      - ETNA__PRODUCTION__USER_HASH_SECRET=/run/secrets/user-hash-secret\\n      #- ETNA__PRODUCTION__HMAC_KEYS__METIS_FILE=/run/secrets/staging-metis-hmac\\n      #- ETNA__PRODUCTION__HMAC_KEYS__MAGMA_FILE=/run/secrets/staging-metis-hmac\\n    command:\\n      - bash\\n      - -c\\n      - |\\n        set -e\\n        export METRICS_PW=\\\"$$(cat /run/secrets/metrics-pw)\\\"\\n        exec /bin/deploy.sh migrate -- /app/bin/puma.sh\\n    image: etnaagent/${APP_NAME}:${ENV}\\n    volumes:\\n      #- ${DATA_SOURCE}/${APP_NAME}/:/app/data/${APP_NAME}\\n      - /var/node_exporter/metrics.prom:/tmp/metrics.prom\\n    #user: ${APP_UID}:999 # metis:docker\\n    deploy:\\n      update_config:\\n        parallelism: 1\\n        order: start-first\\n      labels:\\n        - autoupdate=true\\n      #placement:\\n        #constraints:\\n          #- node.labels.volumes.${APP_NAME}_${ENV}_data == true\\n    healthcheck:\\n      interval: 10s\\n      retries: 3\\n      start_period: 1s\\n      test: bash -c 'curl http://localhost:3000 || exit 1'\\n      timeout: 5s\\n    configs:\\n      - source: config\\n        target: /app/config.yml\\n      - source: env\\n        target: /app/env.yml\\n    networks:\\n      db:\\n      prometheus:\\n      fe:\\n        aliases:\\n          - ${APP_NAME}_app\\n    secrets:\\n      #- staging-metis-hmac\\n      #- staging-magma-hmac\\n      - metrics-pw\\n      - user-hash-secret\\n      - source: db-pw\\n        target: db-password\\n      #- rollbar-access-token\\n\\n  app_fe:\\n    environment:\\n      - APP_NAME=${APP_NAME}\\n      - ${APP_ENV}=production\\n    image: etnaagent/${APP_NAME}_app_fe:${ENV}\\n    networks:\\n      - edge_bridge\\n      - fe\\n    volumes:\\n      - app_public:/app/public\\n      #- ${DATA_SOURCE}/${APP_NAME}/:/app/data/${APP_NAME}:ro\\n    # Notably, apache needs to start as super user but it immediately downgrades\\n    # its own user permissions after bootup.  See the includes.\\n    user: 0:3000 # su:browser\\n    configs:\\n      - source: browser.system.include\\n        target: /usr/opt/httpd.conf.d/browser.system.include\\n    deploy:\\n      labels:\\n        - autoupdate=true\\n      restart_policy:\\n        condition: none\\n      placement:\\n        constraints:\\n          - node.labels.volumes.${APP_NAME}_${ENV}_app_public == true\\n          #- node.labels.volumes.${APP_NAME}_${ENV}_data == true\\n\\n  app_assets_deployer:\\n    environment:\\n      - APP_NAME=${APP_NAME}\\n      - ${APP_ENV}=production\\n\\n    command: /bin/deploy.sh syncAssets -- true # Sync the assets to the shared data volume and stop.\\n    image: etnaagent/${APP_NAME}:${ENV}\\n    volumes:\\n      - app_public:/sync-assets:rw\\n\\n    deploy:\\n      labels:\\n        - autoupdate=true\\n      restart_policy:\\n        condition: none\\n      mode: global\\n      placement:\\n        max_replicas_per_node: 1\\n        constraints:\\n          - node.labels.volumes.${APP_NAME}_${ENV}_app_public == true\\n\\nvolumes:\\n  app_public:\\n  db:\\n    name: \\\"${APP_NAME}_${ENV}_db\\\"\\n\\nconfigs:\\n  browser.system.include:\\n    name: ${BROWSER_SYSTEM_INCLUDE:-browser.system.include}\\n    external: true\\n  config:\\n    external: true\\n    name: ${APP_CONFIG:-timur.staging.yml}\\n  env:\\n    external: true\\n    name: ${ENV_CONFIG:-etna.staging.yml}\\n\\nsecrets:\\n  user-hash-secret:\\n    external: true\\n  metrics-pw:\\n    external: true\\n  staging-metis-hmac:\\n    external: true\\n  staging-magma-hmac:\\n    external: true\\n  db-pw:\\n    external: true\\n    name: \\\"${APP_NAME}_${ENV}_db_password\\\"\\n\\nnetworks:\\n  fe:\\n  db:\\n  edge_bridge:\\n    external: true\\n  prometheus:\\n    external: true\",\"prune\":true,\"env\":[{\"name\":\"APP_NAME\",\"value\":\"timur\"},{\"name\":\"ENV\",\"value\":\"staging\"},{\"name\":\"APP_ENV\",\"value\":\"TIMUR_ENV\"},{\"name\":\"APP_CONFIG\",\"value\":\"timur.staging.yml\"},{\"name\":\"ENV_CONFIG\",\"value\":\"etna.staging.yml\"}]}","stdout":"{\"Id\":36,\"Name\":\"timur-staging\",\"Type\":1,\"EndpointId\":1,\"SwarmId\":\"npcpmkzm9t2zp6gfq9o96wogc\",\"EntryPoint\":\"swarm/timur-staging.yml\",\"Env\":[{\"name\":\"APP_NAME\",\"value\":\"timur\"},{\"name\":\"ENV\",\"value\":\"staging\"},{\"name\":\"APP_ENV\",\"value\":\"TIMUR_ENV\"},{\"name\":\"APP_CONFIG\",\"value\":\"timur.staging.yml\"},{\"name\":\"ENV_CONFIG\",\"value\":\"etna.staging.yml\"}],\"ResourceControl\":null,\"Status\":1,\"ProjectPath\":\"/data/compose/36\",\"CreationDate\":1641252002,\"CreatedBy\":\"etna\",\"UpdateDate\":1641333396,\"UpdatedBy\":\"etna\",\"AdditionalFiles\":[],\"AutoUpdate\":{\"Interval\":\"\",\"Webhook\":\"\",\"JobID\":\"\"},\"GitConfig\":{\"URL\":\"https://github.com/mountetna/monoetna.git\",\"ReferenceName\":\"refs/heads/swarm/stacks\",\"ConfigFilePath\":\"swarm/timur-staging.yml\",\"Authentication\":null,\"ConfigHash\":\"c0b611a840bdf74165e6042683b3cc57f7c57a25\"},\"Namespace\":\"\",\"IsComposeFormat\":false}","stderr":"","i":"39 /home/home/monoetna/swarm/swarm-keeper/lib/edit-config-deploy.recording"}
{"cmd":"http","args":["--check-status","--proxy=http:socks5h://127.0.0.1:9090","--proxy=https:socks5h://127.0.0.1:9090","GET","https://portainer.dsco.ucsf.edu/api/endpoints/1/docker/services","Authorization: Bearer xxx","filters=={\"label\":[\"com.docker.stack.namespace=timur-staging\"]}"],"result":"0","stdin":"","stdout":"[{\"CreatedAt\":\"2022-01-03T23:20:43.937407448Z\",\"Endpoint\":{\"Spec\":{\"Mode\":\"vip\"},\"VirtualIPs\":[{\"Addr\":\"10.0.4.98/24\",\"NetworkID\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Addr\":\"10.0.21.4/24\",\"NetworkID\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Addr\":\"10.0.19.4/24\",\"NetworkID\":\"r1u6c0bclbl6wyl1g8478x91v\"}]},\"ID\":\"9vxwqyzsiehxqhe2w9pyi39n4\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"PreviousSpec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Replicated\":{\"Replicas\":1}},\"Name\":\"timur-staging_app\",\"TaskTemplate\":{\"ContainerSpec\":{\"Args\":[\"bash\",\"-c\",\"set -e\\nexport METRICS_PW=\\\"$(cat /run/secrets/metrics-pw)\\\"\\nexec /bin/deploy.sh migrate -- /app/bin/puma.sh\\n\"],\"Configs\":[{\"ConfigID\":\"kyzf7xy96uv6ip5x65lgjf1wf\",\"ConfigName\":\"etna.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/env.yml\",\"UID\":\"0\"}},{\"ConfigID\":\"v708ckky9705nzt3rv6gya39l\",\"ConfigName\":\"timur.staging.yml_1641333336\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/config.yml\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"ETNA__PRODUCTION_FILE=/app/env.yml\",\"ETNA__PRODUCTION__DB__PASSWORD_FILE=/run/secrets/db-password\",\"ETNA__PRODUCTION__ROLLBAR__ACCESS_TOKEN=/run/secrets/rollbar-access-token\",\"ETNA__PRODUCTION__USER_HASH_SECRET=/run/secrets/user-hash-secret\",\"TIMUR_ENV=production\"],\"Healthcheck\":{\"Interval\":10000000000,\"Retries\":3,\"StartPeriod\":1000000000,\"Test\":[\"CMD-SHELL\",\"bash -c 'curl http://localhost:3000 || exit 1'\"],\"Timeout\":5000000000},\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"/var/node_exporter/metrics.prom\",\"Target\":\"/tmp/metrics.prom\",\"Type\":\"bind\"}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"metrics-pw\",\"UID\":\"0\"},\"SecretID\":\"6adzt6tvilj2msj5m4vsy1eug\",\"SecretName\":\"metrics-pw\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"db-password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"user-hash-secret\",\"UID\":\"0\"},\"SecretID\":\"nqdn03euckbucxx1d7brr0gde\",\"SecretName\":\"user-hash-secret\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app\"],\"Target\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Aliases\":[\"app\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Aliases\":[\"timur_app\",\"app\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"Runtime\":\"container\"},\"UpdateConfig\":{\"FailureAction\":\"pause\",\"MaxFailureRatio\":0,\"Order\":\"start-first\",\"Parallelism\":1}},\"Spec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Replicated\":{\"Replicas\":1}},\"Name\":\"timur-staging_app\",\"TaskTemplate\":{\"ContainerSpec\":{\"Args\":[\"bash\",\"-c\",\"set -e\\nexport METRICS_PW=\\\"$(cat /run/secrets/metrics-pw)\\\"\\nexec /bin/deploy.sh migrate -- /app/bin/puma.sh\\n\"],\"Configs\":[{\"ConfigID\":\"kyzf7xy96uv6ip5x65lgjf1wf\",\"ConfigName\":\"etna.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/env.yml\",\"UID\":\"0\"}},{\"ConfigID\":\"da9539n2gpyfoszjf2o6scc7n\",\"ConfigName\":\"timur.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/config.yml\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"ETNA__PRODUCTION_FILE=/app/env.yml\",\"ETNA__PRODUCTION__DB__PASSWORD_FILE=/run/secrets/db-password\",\"ETNA__PRODUCTION__ROLLBAR__ACCESS_TOKEN=/run/secrets/rollbar-access-token\",\"ETNA__PRODUCTION__USER_HASH_SECRET=/run/secrets/user-hash-secret\",\"TIMUR_ENV=production\"],\"Healthcheck\":{\"Interval\":10000000000,\"Retries\":3,\"StartPeriod\":1000000000,\"Test\":[\"CMD-SHELL\",\"bash -c 'curl http://localhost:3000 || exit 1'\"],\"Timeout\":5000000000},\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"/var/node_exporter/metrics.prom\",\"Target\":\"/tmp/metrics.prom\",\"Type\":\"bind\"}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"metrics-pw\",\"UID\":\"0\"},\"SecretID\":\"6adzt6tvilj2msj5m4vsy1eug\",\"SecretName\":\"metrics-pw\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"db-password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"user-hash-secret\",\"UID\":\"0\"},\"SecretID\":\"nqdn03euckbucxx1d7brr0gde\",\"SecretName\":\"user-hash-secret\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app\"],\"Target\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Aliases\":[\"app\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Aliases\":[\"timur_app\",\"app\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"Runtime\":\"container\"},\"UpdateConfig\":{\"FailureAction\":\"pause\",\"MaxFailureRatio\":0,\"Order\":\"start-first\",\"Parallelism\":1}},\"UpdateStatus\":{\"Message\":\"update in progress\",\"StartedAt\":\"2022-01-04T21:56:36.479368664Z\",\"State\":\"updating\"},\"UpdatedAt\":\"2022-01-04T21:56:36.479454604Z\",\"Version\":{\"Index\":10057410}},{\"CreatedAt\":\"2022-01-03T23:20:42.40988215Z\",\"Endpoint\":{\"Spec\":{\"Mode\":\"vip\"},\"VirtualIPs\":[{\"Addr\":\"10.0.21.2/24\",\"NetworkID\":\"c4ggc3aqae1ost27az5ri3nxz\"}]},\"ID\":\"l8z4f6ubn3a07ldj5mscerbog\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"PreviousSpec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"com.docker.stack.image\":\"postgres:10.19\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Replicated\":{\"Replicas\":1}},\"Name\":\"timur-staging_postgres\",\"TaskTemplate\":{\"ContainerSpec\":{\"Env\":[\"POSTGRES_DB=timur\",\"POSTGRES_PASSWORD_FILE=/run/secrets/password\",\"POSTGRES_USER=developer\"],\"Image\":\"postgres:10.19@sha256:ac0b1670c906d610741e93a517e6492979b7b0ad2127862c8a574ce265dc8804\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur_staging_db\",\"Target\":\"/var/lib/postgresql/data\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"postgres\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_db == true\"],\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"},{\"OS\":\"linux\"},{\"OS\":\"linux\"},{\"Architecture\":\"arm64\",\"OS\":\"linux\"},{\"Architecture\":\"386\",\"OS\":\"linux\"}]},\"Resources\":{},\"Runtime\":\"container\"}},\"Spec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"com.docker.stack.image\":\"postgres:10.19\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Replicated\":{\"Replicas\":1}},\"Name\":\"timur-staging_postgres\",\"TaskTemplate\":{\"ContainerSpec\":{\"Env\":[\"POSTGRES_DB=timur\",\"POSTGRES_PASSWORD_FILE=/run/secrets/password\",\"POSTGRES_USER=developer\"],\"Image\":\"postgres:10.19@sha256:ac0b1670c906d610741e93a517e6492979b7b0ad2127862c8a574ce265dc8804\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur_staging_db\",\"Target\":\"/var/lib/postgresql/data\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"postgres\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_db == true\"],\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"},{\"OS\":\"linux\"},{\"OS\":\"linux\"},{\"Architecture\":\"arm64\",\"OS\":\"linux\"},{\"Architecture\":\"386\",\"OS\":\"linux\"}]},\"Resources\":{},\"Runtime\":\"container\"}},\"UpdatedAt\":\"2022-01-04T21:56:34.893497012Z\",\"Version\":{\"Index\":10057407}},{\"CreatedAt\":\"2022-01-03T23:20:41.23437548Z\",\"Endpoint\":{\"Spec\":{\"Mode\":\"vip\"},\"VirtualIPs\":[{\"Addr\":\"10.0.20.2/24\",\"NetworkID\":\"m52fcusnqimfjqpnrnqrq34gs\"}]},\"ID\":\"qgjxwctj8zxsu5i6ux5bf40j2\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"PreviousSpec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Global\":{}},\"Name\":\"timur-staging_app_assets_deployer\",\"TaskTemplate\":{\"ContainerSpec\":{\"Args\":[\"/bin/deploy.sh\",\"syncAssets\",\"--\",\"true\"],\"Env\":[\"APP_NAME=timur\",\"TIMUR_ENV=production\"],\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur-staging_app_public\",\"Target\":\"/sync-assets\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null}},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app_assets_deployer\"],\"Target\":\"m52fcusnqimfjqpnrnqrq34gs\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_app_public == true\"],\"MaxReplicas\":1,\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"RestartPolicy\":{\"Condition\":\"none\",\"MaxAttempts\":0},\"Runtime\":\"container\"}},\"Spec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Global\":{}},\"Name\":\"timur-staging_app_assets_deployer\",\"TaskTemplate\":{\"ContainerSpec\":{\"Args\":[\"/bin/deploy.sh\",\"syncAssets\",\"--\",\"true\"],\"Env\":[\"APP_NAME=timur\",\"TIMUR_ENV=production\"],\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur-staging_app_public\",\"Target\":\"/sync-assets\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null}},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app_assets_deployer\"],\"Target\":\"m52fcusnqimfjqpnrnqrq34gs\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_app_public == true\"],\"MaxReplicas\":1,\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"RestartPolicy\":{\"Condition\":\"none\",\"MaxAttempts\":0},\"Runtime\":\"container\"}},\"UpdatedAt\":\"2022-01-04T21:56:33.664230534Z\",\"Version\":{\"Index\":10057398}},{\"CreatedAt\":\"2022-01-03T23:20:39.571206988Z\",\"Endpoint\":{\"Spec\":{\"Mode\":\"vip\"},\"VirtualIPs\":[{\"Addr\":\"10.0.3.214/24\",\"NetworkID\":\"wl9z0sp3su5p6za45i3klgtn6\"},{\"Addr\":\"10.0.19.2/24\",\"NetworkID\":\"r1u6c0bclbl6wyl1g8478x91v\"}]},\"ID\":\"y8mocvq0olbq809713v3ey9hd\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"PreviousSpec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur_app_fe:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Replicated\":{\"Replicas\":1}},\"Name\":\"timur-staging_app_fe\",\"TaskTemplate\":{\"ContainerSpec\":{\"Configs\":[{\"ConfigID\":\"efyi8cnelo5i809bnga85ozje\",\"ConfigName\":\"browser.system.include\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/usr/opt/httpd.conf.d/browser.system.include\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"TIMUR_ENV=production\"],\"Image\":\"etnaagent/timur_app_fe:staging@sha256:f3527445b7147a4fba3923abc4f308f12457ffcf120021c7d9a0e234e7e048a3\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur-staging_app_public\",\"Target\":\"/app/public\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"User\":\"0:3000\"},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app_fe\"],\"Target\":\"wl9z0sp3su5p6za45i3klgtn6\"},{\"Aliases\":[\"app_fe\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_app_public == true\"],\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"RestartPolicy\":{\"Condition\":\"none\",\"MaxAttempts\":0},\"Runtime\":\"container\"}},\"Spec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur_app_fe:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Replicated\":{\"Replicas\":1}},\"Name\":\"timur-staging_app_fe\",\"TaskTemplate\":{\"ContainerSpec\":{\"Configs\":[{\"ConfigID\":\"efyi8cnelo5i809bnga85ozje\",\"ConfigName\":\"browser.system.include\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/usr/opt/httpd.conf.d/browser.system.include\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"TIMUR_ENV=production\"],\"Image\":\"etnaagent/timur_app_fe:staging@sha256:f3527445b7147a4fba3923abc4f308f12457ffcf120021c7d9a0e234e7e048a3\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur-staging_app_public\",\"Target\":\"/app/public\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"User\":\"0:3000\"},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app_fe\"],\"Target\":\"wl9z0sp3su5p6za45i3klgtn6\"},{\"Aliases\":[\"app_fe\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_app_public == true\"],\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"RestartPolicy\":{\"Condition\":\"none\",\"MaxAttempts\":0},\"Runtime\":\"container\"}},\"UpdatedAt\":\"2022-01-04T21:56:32.103949457Z\",\"Version\":{\"Index\":10057396}}]","stderr":"","i":"40 /home/home/monoetna/swarm/swarm-keeper/lib/edit-config-deploy.recording"}
{"cmd":"http","args":["--check-status","--proxy=http:socks5h://127.0.0.1:9090","--proxy=https:socks5h://127.0.0.1:9090","GET","https://portainer.dsco.ucsf.edu/api/endpoints/1/docker/services","Authorization: Bearer xxx","filters=={\"name\":[\"timur-staging_app\"]}"],"result":"0","stdin":"","stdout":"[{\"CreatedAt\":\"2022-01-03T23:20:43.937407448Z\",\"Endpoint\":{\"Spec\":{\"Mode\":\"vip\"},\"VirtualIPs\":[{\"Addr\":\"10.0.4.98/24\",\"NetworkID\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Addr\":\"10.0.21.4/24\",\"NetworkID\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Addr\":\"10.0.19.4/24\",\"NetworkID\":\"r1u6c0bclbl6wyl1g8478x91v\"}]},\"ID\":\"9vxwqyzsiehxqhe2w9pyi39n4\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"PreviousSpec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Replicated\":{\"Replicas\":1}},\"Name\":\"timur-staging_app\",\"TaskTemplate\":{\"ContainerSpec\":{\"Args\":[\"bash\",\"-c\",\"set -e\\nexport METRICS_PW=\\\"$(cat /run/secrets/metrics-pw)\\\"\\nexec /bin/deploy.sh migrate -- /app/bin/puma.sh\\n\"],\"Configs\":[{\"ConfigID\":\"kyzf7xy96uv6ip5x65lgjf1wf\",\"ConfigName\":\"etna.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/env.yml\",\"UID\":\"0\"}},{\"ConfigID\":\"v708ckky9705nzt3rv6gya39l\",\"ConfigName\":\"timur.staging.yml_1641333336\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/config.yml\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"ETNA__PRODUCTION_FILE=/app/env.yml\",\"ETNA__PRODUCTION__DB__PASSWORD_FILE=/run/secrets/db-password\",\"ETNA__PRODUCTION__ROLLBAR__ACCESS_TOKEN=/run/secrets/rollbar-access-token\",\"ETNA__PRODUCTION__USER_HASH_SECRET=/run/secrets/user-hash-secret\",\"TIMUR_ENV=production\"],\"Healthcheck\":{\"Interval\":10000000000,\"Retries\":3,\"StartPeriod\":1000000000,\"Test\":[\"CMD-SHELL\",\"bash -c 'curl http://localhost:3000 || exit 1'\"],\"Timeout\":5000000000},\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"/var/node_exporter/metrics.prom\",\"Target\":\"/tmp/metrics.prom\",\"Type\":\"bind\"}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"metrics-pw\",\"UID\":\"0\"},\"SecretID\":\"6adzt6tvilj2msj5m4vsy1eug\",\"SecretName\":\"metrics-pw\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"db-password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"user-hash-secret\",\"UID\":\"0\"},\"SecretID\":\"nqdn03euckbucxx1d7brr0gde\",\"SecretName\":\"user-hash-secret\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app\"],\"Target\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Aliases\":[\"app\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Aliases\":[\"timur_app\",\"app\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"Runtime\":\"container\"},\"UpdateConfig\":{\"FailureAction\":\"pause\",\"MaxFailureRatio\":0,\"Order\":\"start-first\",\"Parallelism\":1}},\"Spec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Replicated\":{\"Replicas\":1}},\"Name\":\"timur-staging_app\",\"TaskTemplate\":{\"ContainerSpec\":{\"Args\":[\"bash\",\"-c\",\"set -e\\nexport METRICS_PW=\\\"$(cat /run/secrets/metrics-pw)\\\"\\nexec /bin/deploy.sh migrate -- /app/bin/puma.sh\\n\"],\"Configs\":[{\"ConfigID\":\"kyzf7xy96uv6ip5x65lgjf1wf\",\"ConfigName\":\"etna.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/env.yml\",\"UID\":\"0\"}},{\"ConfigID\":\"da9539n2gpyfoszjf2o6scc7n\",\"ConfigName\":\"timur.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/config.yml\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"ETNA__PRODUCTION_FILE=/app/env.yml\",\"ETNA__PRODUCTION__DB__PASSWORD_FILE=/run/secrets/db-password\",\"ETNA__PRODUCTION__ROLLBAR__ACCESS_TOKEN=/run/secrets/rollbar-access-token\",\"ETNA__PRODUCTION__USER_HASH_SECRET=/run/secrets/user-hash-secret\",\"TIMUR_ENV=production\"],\"Healthcheck\":{\"Interval\":10000000000,\"Retries\":3,\"StartPeriod\":1000000000,\"Test\":[\"CMD-SHELL\",\"bash -c 'curl http://localhost:3000 || exit 1'\"],\"Timeout\":5000000000},\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"/var/node_exporter/metrics.prom\",\"Target\":\"/tmp/metrics.prom\",\"Type\":\"bind\"}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"metrics-pw\",\"UID\":\"0\"},\"SecretID\":\"6adzt6tvilj2msj5m4vsy1eug\",\"SecretName\":\"metrics-pw\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"db-password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"user-hash-secret\",\"UID\":\"0\"},\"SecretID\":\"nqdn03euckbucxx1d7brr0gde\",\"SecretName\":\"user-hash-secret\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app\"],\"Target\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Aliases\":[\"app\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Aliases\":[\"timur_app\",\"app\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"Runtime\":\"container\"},\"UpdateConfig\":{\"FailureAction\":\"pause\",\"MaxFailureRatio\":0,\"Order\":\"start-first\",\"Parallelism\":1}},\"UpdateStatus\":{\"Message\":\"update in progress\",\"StartedAt\":\"2022-01-04T21:56:36.479368664Z\",\"State\":\"updating\"},\"UpdatedAt\":\"2022-01-04T21:56:36.479454604Z\",\"Version\":{\"Index\":10057410}},{\"CreatedAt\":\"2022-01-03T23:20:41.23437548Z\",\"Endpoint\":{\"Spec\":{\"Mode\":\"vip\"},\"VirtualIPs\":[{\"Addr\":\"10.0.20.2/24\",\"NetworkID\":\"m52fcusnqimfjqpnrnqrq34gs\"}]},\"ID\":\"qgjxwctj8zxsu5i6ux5bf40j2\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"PreviousSpec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Global\":{}},\"Name\":\"timur-staging_app_assets_deployer\",\"TaskTemplate\":{\"ContainerSpec\":{\"Args\":[\"/bin/deploy.sh\",\"syncAssets\",\"--\",\"true\"],\"Env\":[\"APP_NAME=timur\",\"TIMUR_ENV=production\"],\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur-staging_app_public\",\"Target\":\"/sync-assets\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null}},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app_assets_deployer\"],\"Target\":\"m52fcusnqimfjqpnrnqrq34gs\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_app_public == true\"],\"MaxReplicas\":1,\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"RestartPolicy\":{\"Condition\":\"none\",\"MaxAttempts\":0},\"Runtime\":\"container\"}},\"Spec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Global\":{}},\"Name\":\"timur-staging_app_assets_deployer\",\"TaskTemplate\":{\"ContainerSpec\":{\"Args\":[\"/bin/deploy.sh\",\"syncAssets\",\"--\",\"true\"],\"Env\":[\"APP_NAME=timur\",\"TIMUR_ENV=production\"],\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur-staging_app_public\",\"Target\":\"/sync-assets\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null}},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app_assets_deployer\"],\"Target\":\"m52fcusnqimfjqpnrnqrq34gs\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_app_public == true\"],\"MaxReplicas\":1,\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"RestartPolicy\":{\"Condition\":\"none\",\"MaxAttempts\":0},\"Runtime\":\"container\"}},\"UpdatedAt\":\"2022-01-04T21:56:33.664230534Z\",\"Version\":{\"Index\":10057398}},{\"CreatedAt\":\"2022-01-03T23:20:39.571206988Z\",\"Endpoint\":{\"Spec\":{\"Mode\":\"vip\"},\"VirtualIPs\":[{\"Addr\":\"10.0.3.214/24\",\"NetworkID\":\"wl9z0sp3su5p6za45i3klgtn6\"},{\"Addr\":\"10.0.19.2/24\",\"NetworkID\":\"r1u6c0bclbl6wyl1g8478x91v\"}]},\"ID\":\"y8mocvq0olbq809713v3ey9hd\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"PreviousSpec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur_app_fe:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Replicated\":{\"Replicas\":1}},\"Name\":\"timur-staging_app_fe\",\"TaskTemplate\":{\"ContainerSpec\":{\"Configs\":[{\"ConfigID\":\"efyi8cnelo5i809bnga85ozje\",\"ConfigName\":\"browser.system.include\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/usr/opt/httpd.conf.d/browser.system.include\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"TIMUR_ENV=production\"],\"Image\":\"etnaagent/timur_app_fe:staging@sha256:f3527445b7147a4fba3923abc4f308f12457ffcf120021c7d9a0e234e7e048a3\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur-staging_app_public\",\"Target\":\"/app/public\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"User\":\"0:3000\"},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app_fe\"],\"Target\":\"wl9z0sp3su5p6za45i3klgtn6\"},{\"Aliases\":[\"app_fe\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_app_public == true\"],\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"RestartPolicy\":{\"Condition\":\"none\",\"MaxAttempts\":0},\"Runtime\":\"container\"}},\"Spec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur_app_fe:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Replicated\":{\"Replicas\":1}},\"Name\":\"timur-staging_app_fe\",\"TaskTemplate\":{\"ContainerSpec\":{\"Configs\":[{\"ConfigID\":\"efyi8cnelo5i809bnga85ozje\",\"ConfigName\":\"browser.system.include\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/usr/opt/httpd.conf.d/browser.system.include\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"TIMUR_ENV=production\"],\"Image\":\"etnaagent/timur_app_fe:staging@sha256:f3527445b7147a4fba3923abc4f308f12457ffcf120021c7d9a0e234e7e048a3\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur-staging_app_public\",\"Target\":\"/app/public\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"User\":\"0:3000\"},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app_fe\"],\"Target\":\"wl9z0sp3su5p6za45i3klgtn6\"},{\"Aliases\":[\"app_fe\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_app_public == true\"],\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"RestartPolicy\":{\"Condition\":\"none\",\"MaxAttempts\":0},\"Runtime\":\"container\"}},\"UpdatedAt\":\"2022-01-04T21:56:32.103949457Z\",\"Version\":{\"Index\":10057396}}]","stderr":"","i":"41 /home/home/monoetna/swarm/swarm-keeper/lib/edit-config-deploy.recording"}
{"cmd":"http","args":["--check-status","--proxy=http:socks5h://127.0.0.1:9090","--proxy=https:socks5h://127.0.0.1:9090","GET","https://portainer.dsco.ucsf.edu/api/endpoints/1/docker/tasks","Authorization: Bearer xxx","filters=={\"service\":[\"timur-staging_app\"],\"desired-state\":[\"shutdown\"]}"],"result":"0","stdin":"","stdout":"[{\"CreatedAt\":\"2022-01-04T21:52:36.602750303Z\",\"DesiredState\":\"shutdown\",\"ID\":\"1mn2vkae0he34q7mtwtwanpak\",\"Labels\":{},\"NetworksAttachments\":[{\"Addresses\":[\"10.0.4.197/24\"],\"Network\":{\"CreatedAt\":\"2021-06-12T00:04:08.851633906Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4100\"}},\"ID\":\"pwqf514t16rtmjpq62shyib7h\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.4.1\",\"Subnet\":\"10.0.4.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"Attachable\":true,\"DriverConfiguration\":{\"Name\":\"overlay\"},\"IPAMOptions\":{\"Driver\":{\"Name\":\"default\"}},\"Labels\":{},\"Name\":\"prometheus\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2021-12-28T20:39:20.053403246Z\",\"Version\":{\"Index\":8635318}}},{\"Addresses\":[\"10.0.21.9/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.74850188Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4117\"}},\"ID\":\"c4ggc3aqae1ost27az5ri3nxz\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.21.1\",\"Subnet\":\"10.0.21.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_db\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.751592118Z\",\"Version\":{\"Index\":9866157}}},{\"Addresses\":[\"10.0.19.6/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.712710437Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4115\"}},\"ID\":\"r1u6c0bclbl6wyl1g8478x91v\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.19.1\",\"Subnet\":\"10.0.19.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_fe\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.715086232Z\",\"Version\":{\"Index\":9866153}}}],\"NodeID\":\"3e634fut8umris4hqblxbgmk0\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"ServiceID\":\"9vxwqyzsiehxqhe2w9pyi39n4\",\"Slot\":1,\"Spec\":{\"ContainerSpec\":{\"Args\":[\"bash\",\"-c\",\"set -e\\nexport METRICS_PW=\\\"$(cat /run/secrets/metrics-pw)\\\"\\nexec /bin/deploy.sh migrate -- /app/bin/puma.sh\\n\"],\"Configs\":[{\"ConfigID\":\"kyzf7xy96uv6ip5x65lgjf1wf\",\"ConfigName\":\"etna.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/env.yml\",\"UID\":\"0\"}},{\"ConfigID\":\"sh4pln0b83bunf130n8v9e42n\",\"ConfigName\":\"timur.staging.yml_1641333148\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/config.yml\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"ETNA__PRODUCTION_FILE=/app/env.yml\",\"ETNA__PRODUCTION__DB__PASSWORD_FILE=/run/secrets/db-password\",\"ETNA__PRODUCTION__ROLLBAR__ACCESS_TOKEN=/run/secrets/rollbar-access-token\",\"ETNA__PRODUCTION__USER_HASH_SECRET=/run/secrets/user-hash-secret\",\"TIMUR_ENV=production\"],\"Healthcheck\":{\"Interval\":10000000000,\"Retries\":3,\"StartPeriod\":1000000000,\"Test\":[\"CMD-SHELL\",\"bash -c 'curl http://localhost:3000 || exit 1'\"],\"Timeout\":5000000000},\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"/var/node_exporter/metrics.prom\",\"Target\":\"/tmp/metrics.prom\",\"Type\":\"bind\"}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"metrics-pw\",\"UID\":\"0\"},\"SecretID\":\"6adzt6tvilj2msj5m4vsy1eug\",\"SecretName\":\"metrics-pw\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"db-password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"user-hash-secret\",\"UID\":\"0\"},\"SecretID\":\"nqdn03euckbucxx1d7brr0gde\",\"SecretName\":\"user-hash-secret\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app\"],\"Target\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Aliases\":[\"app\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Aliases\":[\"timur_app\",\"app\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{}},\"Status\":{\"ContainerStatus\":{\"ContainerID\":\"aaca6f0fdb21b4b33d0e72c46114d197cf1590889a946dfd4c0e84ab88573f31\",\"ExitCode\":1,\"PID\":0},\"Message\":\"shutdown\",\"PortStatus\":{},\"State\":\"shutdown\",\"Timestamp\":\"2022-01-04T21:53:41.895541058Z\"},\"UpdatedAt\":\"2022-01-04T21:53:41.93158238Z\",\"Version\":{\"Index\":10056975}},{\"CreatedAt\":\"2022-01-04T21:48:34.869891753Z\",\"DesiredState\":\"shutdown\",\"ID\":\"fz7aup1fu575twznk2a7lhqkd\",\"Labels\":{},\"NetworksAttachments\":[{\"Addresses\":[\"10.0.4.195/24\"],\"Network\":{\"CreatedAt\":\"2021-06-12T00:04:08.851633906Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4100\"}},\"ID\":\"pwqf514t16rtmjpq62shyib7h\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.4.1\",\"Subnet\":\"10.0.4.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"Attachable\":true,\"DriverConfiguration\":{\"Name\":\"overlay\"},\"IPAMOptions\":{\"Driver\":{\"Name\":\"default\"}},\"Labels\":{},\"Name\":\"prometheus\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2021-12-28T20:39:20.053403246Z\",\"Version\":{\"Index\":8635318}}},{\"Addresses\":[\"10.0.21.7/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.74850188Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4117\"}},\"ID\":\"c4ggc3aqae1ost27az5ri3nxz\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.21.1\",\"Subnet\":\"10.0.21.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_db\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.751592118Z\",\"Version\":{\"Index\":9866157}}},{\"Addresses\":[\"10.0.19.254/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.712710437Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4115\"}},\"ID\":\"r1u6c0bclbl6wyl1g8478x91v\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.19.1\",\"Subnet\":\"10.0.19.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_fe\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.715086232Z\",\"Version\":{\"Index\":9866153}}}],\"NodeID\":\"ybj02s79vhfv0zrcmwjecr3d6\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"ServiceID\":\"9vxwqyzsiehxqhe2w9pyi39n4\",\"Slot\":1,\"Spec\":{\"ContainerSpec\":{\"Args\":[\"bash\",\"-c\",\"set -e\\nexport METRICS_PW=\\\"$(cat /run/secrets/metrics-pw)\\\"\\nexec /bin/deploy.sh migrate -- /app/bin/puma.sh\\n\"],\"Configs\":[{\"ConfigID\":\"kyzf7xy96uv6ip5x65lgjf1wf\",\"ConfigName\":\"etna.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/env.yml\",\"UID\":\"0\"}},{\"ConfigID\":\"x4akplf1vv5h2j46f2hunod67\",\"ConfigName\":\"timur.staging.yml_1641325556_1641332269\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/config.yml\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"ETNA__PRODUCTION_FILE=/app/env.yml\",\"ETNA__PRODUCTION__DB__PASSWORD_FILE=/run/secrets/db-password\",\"ETNA__PRODUCTION__ROLLBAR__ACCESS_TOKEN=/run/secrets/rollbar-access-token\",\"ETNA__PRODUCTION__USER_HASH_SECRET=/run/secrets/user-hash-secret\",\"TIMUR_ENV=production\"],\"Healthcheck\":{\"Interval\":10000000000,\"Retries\":3,\"StartPeriod\":1000000000,\"Test\":[\"CMD-SHELL\",\"bash -c 'curl http://localhost:3000 || exit 1'\"],\"Timeout\":5000000000},\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"/var/node_exporter/metrics.prom\",\"Target\":\"/tmp/metrics.prom\",\"Type\":\"bind\"}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"metrics-pw\",\"UID\":\"0\"},\"SecretID\":\"6adzt6tvilj2msj5m4vsy1eug\",\"SecretName\":\"metrics-pw\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"db-password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"user-hash-secret\",\"UID\":\"0\"},\"SecretID\":\"nqdn03euckbucxx1d7brr0gde\",\"SecretName\":\"user-hash-secret\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app\"],\"Target\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Aliases\":[\"app\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Aliases\":[\"timur_app\",\"app\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{}},\"Status\":{\"ContainerStatus\":{\"ContainerID\":\"28e15f27e3274630586d2342b0a25983920365a860a2ff6745fd158f1d9a5a6b\",\"ExitCode\":1,\"PID\":0},\"Message\":\"shutdown\",\"PortStatus\":{},\"State\":\"shutdown\",\"Timestamp\":\"2022-01-04T21:52:55.827606933Z\"},\"UpdatedAt\":\"2022-01-04T21:52:55.864189786Z\",\"Version\":{\"Index\":10056849}},{\"CreatedAt\":\"2022-01-04T21:53:20.40610415Z\",\"DesiredState\":\"shutdown\",\"ID\":\"z0xbye6o8sfrrp9tvrrvrpspf\",\"Labels\":{},\"NetworksAttachments\":[{\"Addresses\":[\"10.0.4.198/24\"],\"Network\":{\"CreatedAt\":\"2021-06-12T00:04:08.851633906Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4100\"}},\"ID\":\"pwqf514t16rtmjpq62shyib7h\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.4.1\",\"Subnet\":\"10.0.4.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"Attachable\":true,\"DriverConfiguration\":{\"Name\":\"overlay\"},\"IPAMOptions\":{\"Driver\":{\"Name\":\"default\"}},\"Labels\":{},\"Name\":\"prometheus\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2021-12-28T20:39:20.053403246Z\",\"Version\":{\"Index\":8635318}}},{\"Addresses\":[\"10.0.21.11/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.74850188Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4117\"}},\"ID\":\"c4ggc3aqae1ost27az5ri3nxz\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.21.1\",\"Subnet\":\"10.0.21.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_db\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.751592118Z\",\"Version\":{\"Index\":9866157}}},{\"Addresses\":[\"10.0.19.8/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.712710437Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4115\"}},\"ID\":\"r1u6c0bclbl6wyl1g8478x91v\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.19.1\",\"Subnet\":\"10.0.19.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_fe\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.715086232Z\",\"Version\":{\"Index\":9866153}}}],\"NodeID\":\"ybj02s79vhfv0zrcmwjecr3d6\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"ServiceID\":\"9vxwqyzsiehxqhe2w9pyi39n4\",\"Slot\":1,\"Spec\":{\"ContainerSpec\":{\"Args\":[\"bash\",\"-c\",\"set -e\\nexport METRICS_PW=\\\"$(cat /run/secrets/metrics-pw)\\\"\\nexec /bin/deploy.sh migrate -- /app/bin/puma.sh\\n\"],\"Configs\":[{\"ConfigID\":\"kyzf7xy96uv6ip5x65lgjf1wf\",\"ConfigName\":\"etna.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/env.yml\",\"UID\":\"0\"}},{\"ConfigID\":\"qn484g1c0bmaaw2n1fkueyc8e\",\"ConfigName\":\"timur.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/config.yml\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"ETNA__PRODUCTION_FILE=/app/env.yml\",\"ETNA__PRODUCTION__DB__PASSWORD_FILE=/run/secrets/db-password\",\"ETNA__PRODUCTION__ROLLBAR__ACCESS_TOKEN=/run/secrets/rollbar-access-token\",\"ETNA__PRODUCTION__USER_HASH_SECRET=/run/secrets/user-hash-secret\",\"TIMUR_ENV=production\"],\"Healthcheck\":{\"Interval\":10000000000,\"Retries\":3,\"StartPeriod\":1000000000,\"Test\":[\"CMD-SHELL\",\"bash -c 'curl http://localhost:3000 || exit 1'\"],\"Timeout\":5000000000},\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"/var/node_exporter/metrics.prom\",\"Target\":\"/tmp/metrics.prom\",\"Type\":\"bind\"}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"metrics-pw\",\"UID\":\"0\"},\"SecretID\":\"6adzt6tvilj2msj5m4vsy1eug\",\"SecretName\":\"metrics-pw\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"db-password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"user-hash-secret\",\"UID\":\"0\"},\"SecretID\":\"nqdn03euckbucxx1d7brr0gde\",\"SecretName\":\"user-hash-secret\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app\"],\"Target\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Aliases\":[\"app\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Aliases\":[\"timur_app\",\"app\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{}},\"Status\":{\"ContainerStatus\":{\"ContainerID\":\"9b86e192529d164b80087dbb180858e52f7db86027237dd2d4e6f6db5998505b\",\"ExitCode\":1,\"PID\":0},\"Message\":\"shutdown\",\"PortStatus\":{},\"State\":\"shutdown\",\"Timestamp\":\"2022-01-04T21:56:07.135526801Z\"},\"UpdatedAt\":\"2022-01-04T21:56:07.224862998Z\",\"Version\":{\"Index\":10057332}}]","stderr":"","i":"42 /home/home/monoetna/swarm/swarm-keeper/lib/edit-config-deploy.recording"}
{"cmd":"http","args":["--check-status","--proxy=http:socks5h://127.0.0.1:9090","--proxy=https:socks5h://127.0.0.1:9090","GET","https://portainer.dsco.ucsf.edu/api/endpoints/1/docker/services","Authorization: Bearer xxx","filters=={\"name\":[\"timur-staging_app\"]}"],"result":"0","stdin":"","stdout":"[{\"CreatedAt\":\"2022-01-03T23:20:43.937407448Z\",\"Endpoint\":{\"Spec\":{\"Mode\":\"vip\"},\"VirtualIPs\":[{\"Addr\":\"10.0.4.98/24\",\"NetworkID\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Addr\":\"10.0.21.4/24\",\"NetworkID\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Addr\":\"10.0.19.4/24\",\"NetworkID\":\"r1u6c0bclbl6wyl1g8478x91v\"}]},\"ID\":\"9vxwqyzsiehxqhe2w9pyi39n4\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"PreviousSpec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Replicated\":{\"Replicas\":1}},\"Name\":\"timur-staging_app\",\"TaskTemplate\":{\"ContainerSpec\":{\"Args\":[\"bash\",\"-c\",\"set -e\\nexport METRICS_PW=\\\"$(cat /run/secrets/metrics-pw)\\\"\\nexec /bin/deploy.sh migrate -- /app/bin/puma.sh\\n\"],\"Configs\":[{\"ConfigID\":\"kyzf7xy96uv6ip5x65lgjf1wf\",\"ConfigName\":\"etna.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/env.yml\",\"UID\":\"0\"}},{\"ConfigID\":\"v708ckky9705nzt3rv6gya39l\",\"ConfigName\":\"timur.staging.yml_1641333336\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/config.yml\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"ETNA__PRODUCTION_FILE=/app/env.yml\",\"ETNA__PRODUCTION__DB__PASSWORD_FILE=/run/secrets/db-password\",\"ETNA__PRODUCTION__ROLLBAR__ACCESS_TOKEN=/run/secrets/rollbar-access-token\",\"ETNA__PRODUCTION__USER_HASH_SECRET=/run/secrets/user-hash-secret\",\"TIMUR_ENV=production\"],\"Healthcheck\":{\"Interval\":10000000000,\"Retries\":3,\"StartPeriod\":1000000000,\"Test\":[\"CMD-SHELL\",\"bash -c 'curl http://localhost:3000 || exit 1'\"],\"Timeout\":5000000000},\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"/var/node_exporter/metrics.prom\",\"Target\":\"/tmp/metrics.prom\",\"Type\":\"bind\"}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"metrics-pw\",\"UID\":\"0\"},\"SecretID\":\"6adzt6tvilj2msj5m4vsy1eug\",\"SecretName\":\"metrics-pw\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"db-password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"user-hash-secret\",\"UID\":\"0\"},\"SecretID\":\"nqdn03euckbucxx1d7brr0gde\",\"SecretName\":\"user-hash-secret\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app\"],\"Target\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Aliases\":[\"app\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Aliases\":[\"timur_app\",\"app\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"Runtime\":\"container\"},\"UpdateConfig\":{\"FailureAction\":\"pause\",\"MaxFailureRatio\":0,\"Order\":\"start-first\",\"Parallelism\":1}},\"Spec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Replicated\":{\"Replicas\":1}},\"Name\":\"timur-staging_app\",\"TaskTemplate\":{\"ContainerSpec\":{\"Args\":[\"bash\",\"-c\",\"set -e\\nexport METRICS_PW=\\\"$(cat /run/secrets/metrics-pw)\\\"\\nexec /bin/deploy.sh migrate -- /app/bin/puma.sh\\n\"],\"Configs\":[{\"ConfigID\":\"kyzf7xy96uv6ip5x65lgjf1wf\",\"ConfigName\":\"etna.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/env.yml\",\"UID\":\"0\"}},{\"ConfigID\":\"da9539n2gpyfoszjf2o6scc7n\",\"ConfigName\":\"timur.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/config.yml\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"ETNA__PRODUCTION_FILE=/app/env.yml\",\"ETNA__PRODUCTION__DB__PASSWORD_FILE=/run/secrets/db-password\",\"ETNA__PRODUCTION__ROLLBAR__ACCESS_TOKEN=/run/secrets/rollbar-access-token\",\"ETNA__PRODUCTION__USER_HASH_SECRET=/run/secrets/user-hash-secret\",\"TIMUR_ENV=production\"],\"Healthcheck\":{\"Interval\":10000000000,\"Retries\":3,\"StartPeriod\":1000000000,\"Test\":[\"CMD-SHELL\",\"bash -c 'curl http://localhost:3000 || exit 1'\"],\"Timeout\":5000000000},\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"/var/node_exporter/metrics.prom\",\"Target\":\"/tmp/metrics.prom\",\"Type\":\"bind\"}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"metrics-pw\",\"UID\":\"0\"},\"SecretID\":\"6adzt6tvilj2msj5m4vsy1eug\",\"SecretName\":\"metrics-pw\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"db-password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"user-hash-secret\",\"UID\":\"0\"},\"SecretID\":\"nqdn03euckbucxx1d7brr0gde\",\"SecretName\":\"user-hash-secret\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app\"],\"Target\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Aliases\":[\"app\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Aliases\":[\"timur_app\",\"app\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"Runtime\":\"container\"},\"UpdateConfig\":{\"FailureAction\":\"pause\",\"MaxFailureRatio\":0,\"Order\":\"start-first\",\"Parallelism\":1}},\"UpdateStatus\":{\"Message\":\"update in progress\",\"StartedAt\":\"2022-01-04T21:56:36.479368664Z\",\"State\":\"updating\"},\"UpdatedAt\":\"2022-01-04T21:56:36.479454604Z\",\"Version\":{\"Index\":10057410}},{\"CreatedAt\":\"2022-01-03T23:20:41.23437548Z\",\"Endpoint\":{\"Spec\":{\"Mode\":\"vip\"},\"VirtualIPs\":[{\"Addr\":\"10.0.20.2/24\",\"NetworkID\":\"m52fcusnqimfjqpnrnqrq34gs\"}]},\"ID\":\"qgjxwctj8zxsu5i6ux5bf40j2\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"PreviousSpec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Global\":{}},\"Name\":\"timur-staging_app_assets_deployer\",\"TaskTemplate\":{\"ContainerSpec\":{\"Args\":[\"/bin/deploy.sh\",\"syncAssets\",\"--\",\"true\"],\"Env\":[\"APP_NAME=timur\",\"TIMUR_ENV=production\"],\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur-staging_app_public\",\"Target\":\"/sync-assets\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null}},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app_assets_deployer\"],\"Target\":\"m52fcusnqimfjqpnrnqrq34gs\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_app_public == true\"],\"MaxReplicas\":1,\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"RestartPolicy\":{\"Condition\":\"none\",\"MaxAttempts\":0},\"Runtime\":\"container\"}},\"Spec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Global\":{}},\"Name\":\"timur-staging_app_assets_deployer\",\"TaskTemplate\":{\"ContainerSpec\":{\"Args\":[\"/bin/deploy.sh\",\"syncAssets\",\"--\",\"true\"],\"Env\":[\"APP_NAME=timur\",\"TIMUR_ENV=production\"],\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur-staging_app_public\",\"Target\":\"/sync-assets\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null}},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app_assets_deployer\"],\"Target\":\"m52fcusnqimfjqpnrnqrq34gs\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_app_public == true\"],\"MaxReplicas\":1,\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"RestartPolicy\":{\"Condition\":\"none\",\"MaxAttempts\":0},\"Runtime\":\"container\"}},\"UpdatedAt\":\"2022-01-04T21:56:33.664230534Z\",\"Version\":{\"Index\":10057398}},{\"CreatedAt\":\"2022-01-03T23:20:39.571206988Z\",\"Endpoint\":{\"Spec\":{\"Mode\":\"vip\"},\"VirtualIPs\":[{\"Addr\":\"10.0.3.214/24\",\"NetworkID\":\"wl9z0sp3su5p6za45i3klgtn6\"},{\"Addr\":\"10.0.19.2/24\",\"NetworkID\":\"r1u6c0bclbl6wyl1g8478x91v\"}]},\"ID\":\"y8mocvq0olbq809713v3ey9hd\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"PreviousSpec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur_app_fe:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Replicated\":{\"Replicas\":1}},\"Name\":\"timur-staging_app_fe\",\"TaskTemplate\":{\"ContainerSpec\":{\"Configs\":[{\"ConfigID\":\"efyi8cnelo5i809bnga85ozje\",\"ConfigName\":\"browser.system.include\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/usr/opt/httpd.conf.d/browser.system.include\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"TIMUR_ENV=production\"],\"Image\":\"etnaagent/timur_app_fe:staging@sha256:f3527445b7147a4fba3923abc4f308f12457ffcf120021c7d9a0e234e7e048a3\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur-staging_app_public\",\"Target\":\"/app/public\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"User\":\"0:3000\"},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app_fe\"],\"Target\":\"wl9z0sp3su5p6za45i3klgtn6\"},{\"Aliases\":[\"app_fe\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_app_public == true\"],\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"RestartPolicy\":{\"Condition\":\"none\",\"MaxAttempts\":0},\"Runtime\":\"container\"}},\"Spec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur_app_fe:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Replicated\":{\"Replicas\":1}},\"Name\":\"timur-staging_app_fe\",\"TaskTemplate\":{\"ContainerSpec\":{\"Configs\":[{\"ConfigID\":\"efyi8cnelo5i809bnga85ozje\",\"ConfigName\":\"browser.system.include\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/usr/opt/httpd.conf.d/browser.system.include\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"TIMUR_ENV=production\"],\"Image\":\"etnaagent/timur_app_fe:staging@sha256:f3527445b7147a4fba3923abc4f308f12457ffcf120021c7d9a0e234e7e048a3\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur-staging_app_public\",\"Target\":\"/app/public\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"User\":\"0:3000\"},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app_fe\"],\"Target\":\"wl9z0sp3su5p6za45i3klgtn6\"},{\"Aliases\":[\"app_fe\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_app_public == true\"],\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"RestartPolicy\":{\"Condition\":\"none\",\"MaxAttempts\":0},\"Runtime\":\"container\"}},\"UpdatedAt\":\"2022-01-04T21:56:32.103949457Z\",\"Version\":{\"Index\":10057396}}]","stderr":"","i":"43 /home/home/monoetna/swarm/swarm-keeper/lib/edit-config-deploy.recording"}
{"cmd":"http","args":["--check-status","--proxy=http:socks5h://127.0.0.1:9090","--proxy=https:socks5h://127.0.0.1:9090","GET","https://portainer.dsco.ucsf.edu/api/endpoints/1/docker/tasks","Authorization: Bearer xxx","filters=={\"service\":[\"timur-staging_app\"],\"desired-state\":[\"shutdown\"]}"],"result":"0","stdin":"","stdout":"[{\"CreatedAt\":\"2022-01-04T21:52:36.602750303Z\",\"DesiredState\":\"shutdown\",\"ID\":\"1mn2vkae0he34q7mtwtwanpak\",\"Labels\":{},\"NetworksAttachments\":[{\"Addresses\":[\"10.0.4.197/24\"],\"Network\":{\"CreatedAt\":\"2021-06-12T00:04:08.851633906Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4100\"}},\"ID\":\"pwqf514t16rtmjpq62shyib7h\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.4.1\",\"Subnet\":\"10.0.4.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"Attachable\":true,\"DriverConfiguration\":{\"Name\":\"overlay\"},\"IPAMOptions\":{\"Driver\":{\"Name\":\"default\"}},\"Labels\":{},\"Name\":\"prometheus\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2021-12-28T20:39:20.053403246Z\",\"Version\":{\"Index\":8635318}}},{\"Addresses\":[\"10.0.21.9/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.74850188Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4117\"}},\"ID\":\"c4ggc3aqae1ost27az5ri3nxz\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.21.1\",\"Subnet\":\"10.0.21.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_db\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.751592118Z\",\"Version\":{\"Index\":9866157}}},{\"Addresses\":[\"10.0.19.6/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.712710437Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4115\"}},\"ID\":\"r1u6c0bclbl6wyl1g8478x91v\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.19.1\",\"Subnet\":\"10.0.19.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_fe\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.715086232Z\",\"Version\":{\"Index\":9866153}}}],\"NodeID\":\"3e634fut8umris4hqblxbgmk0\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"ServiceID\":\"9vxwqyzsiehxqhe2w9pyi39n4\",\"Slot\":1,\"Spec\":{\"ContainerSpec\":{\"Args\":[\"bash\",\"-c\",\"set -e\\nexport METRICS_PW=\\\"$(cat /run/secrets/metrics-pw)\\\"\\nexec /bin/deploy.sh migrate -- /app/bin/puma.sh\\n\"],\"Configs\":[{\"ConfigID\":\"kyzf7xy96uv6ip5x65lgjf1wf\",\"ConfigName\":\"etna.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/env.yml\",\"UID\":\"0\"}},{\"ConfigID\":\"sh4pln0b83bunf130n8v9e42n\",\"ConfigName\":\"timur.staging.yml_1641333148\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/config.yml\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"ETNA__PRODUCTION_FILE=/app/env.yml\",\"ETNA__PRODUCTION__DB__PASSWORD_FILE=/run/secrets/db-password\",\"ETNA__PRODUCTION__ROLLBAR__ACCESS_TOKEN=/run/secrets/rollbar-access-token\",\"ETNA__PRODUCTION__USER_HASH_SECRET=/run/secrets/user-hash-secret\",\"TIMUR_ENV=production\"],\"Healthcheck\":{\"Interval\":10000000000,\"Retries\":3,\"StartPeriod\":1000000000,\"Test\":[\"CMD-SHELL\",\"bash -c 'curl http://localhost:3000 || exit 1'\"],\"Timeout\":5000000000},\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"/var/node_exporter/metrics.prom\",\"Target\":\"/tmp/metrics.prom\",\"Type\":\"bind\"}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"metrics-pw\",\"UID\":\"0\"},\"SecretID\":\"6adzt6tvilj2msj5m4vsy1eug\",\"SecretName\":\"metrics-pw\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"db-password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"user-hash-secret\",\"UID\":\"0\"},\"SecretID\":\"nqdn03euckbucxx1d7brr0gde\",\"SecretName\":\"user-hash-secret\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app\"],\"Target\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Aliases\":[\"app\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Aliases\":[\"timur_app\",\"app\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{}},\"Status\":{\"ContainerStatus\":{\"ContainerID\":\"aaca6f0fdb21b4b33d0e72c46114d197cf1590889a946dfd4c0e84ab88573f31\",\"ExitCode\":1,\"PID\":0},\"Message\":\"shutdown\",\"PortStatus\":{},\"State\":\"shutdown\",\"Timestamp\":\"2022-01-04T21:53:41.895541058Z\"},\"UpdatedAt\":\"2022-01-04T21:53:41.93158238Z\",\"Version\":{\"Index\":10056975}},{\"CreatedAt\":\"2022-01-04T21:48:34.869891753Z\",\"DesiredState\":\"shutdown\",\"ID\":\"fz7aup1fu575twznk2a7lhqkd\",\"Labels\":{},\"NetworksAttachments\":[{\"Addresses\":[\"10.0.4.195/24\"],\"Network\":{\"CreatedAt\":\"2021-06-12T00:04:08.851633906Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4100\"}},\"ID\":\"pwqf514t16rtmjpq62shyib7h\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.4.1\",\"Subnet\":\"10.0.4.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"Attachable\":true,\"DriverConfiguration\":{\"Name\":\"overlay\"},\"IPAMOptions\":{\"Driver\":{\"Name\":\"default\"}},\"Labels\":{},\"Name\":\"prometheus\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2021-12-28T20:39:20.053403246Z\",\"Version\":{\"Index\":8635318}}},{\"Addresses\":[\"10.0.21.7/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.74850188Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4117\"}},\"ID\":\"c4ggc3aqae1ost27az5ri3nxz\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.21.1\",\"Subnet\":\"10.0.21.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_db\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.751592118Z\",\"Version\":{\"Index\":9866157}}},{\"Addresses\":[\"10.0.19.254/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.712710437Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4115\"}},\"ID\":\"r1u6c0bclbl6wyl1g8478x91v\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.19.1\",\"Subnet\":\"10.0.19.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_fe\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.715086232Z\",\"Version\":{\"Index\":9866153}}}],\"NodeID\":\"ybj02s79vhfv0zrcmwjecr3d6\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"ServiceID\":\"9vxwqyzsiehxqhe2w9pyi39n4\",\"Slot\":1,\"Spec\":{\"ContainerSpec\":{\"Args\":[\"bash\",\"-c\",\"set -e\\nexport METRICS_PW=\\\"$(cat /run/secrets/metrics-pw)\\\"\\nexec /bin/deploy.sh migrate -- /app/bin/puma.sh\\n\"],\"Configs\":[{\"ConfigID\":\"kyzf7xy96uv6ip5x65lgjf1wf\",\"ConfigName\":\"etna.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/env.yml\",\"UID\":\"0\"}},{\"ConfigID\":\"x4akplf1vv5h2j46f2hunod67\",\"ConfigName\":\"timur.staging.yml_1641325556_1641332269\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/config.yml\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"ETNA__PRODUCTION_FILE=/app/env.yml\",\"ETNA__PRODUCTION__DB__PASSWORD_FILE=/run/secrets/db-password\",\"ETNA__PRODUCTION__ROLLBAR__ACCESS_TOKEN=/run/secrets/rollbar-access-token\",\"ETNA__PRODUCTION__USER_HASH_SECRET=/run/secrets/user-hash-secret\",\"TIMUR_ENV=production\"],\"Healthcheck\":{\"Interval\":10000000000,\"Retries\":3,\"StartPeriod\":1000000000,\"Test\":[\"CMD-SHELL\",\"bash -c 'curl http://localhost:3000 || exit 1'\"],\"Timeout\":5000000000},\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"/var/node_exporter/metrics.prom\",\"Target\":\"/tmp/metrics.prom\",\"Type\":\"bind\"}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"metrics-pw\",\"UID\":\"0\"},\"SecretID\":\"6adzt6tvilj2msj5m4vsy1eug\",\"SecretName\":\"metrics-pw\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"db-password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"user-hash-secret\",\"UID\":\"0\"},\"SecretID\":\"nqdn03euckbucxx1d7brr0gde\",\"SecretName\":\"user-hash-secret\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app\"],\"Target\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Aliases\":[\"app\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Aliases\":[\"timur_app\",\"app\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{}},\"Status\":{\"ContainerStatus\":{\"ContainerID\":\"28e15f27e3274630586d2342b0a25983920365a860a2ff6745fd158f1d9a5a6b\",\"ExitCode\":1,\"PID\":0},\"Message\":\"shutdown\",\"PortStatus\":{},\"State\":\"shutdown\",\"Timestamp\":\"2022-01-04T21:52:55.827606933Z\"},\"UpdatedAt\":\"2022-01-04T21:52:55.864189786Z\",\"Version\":{\"Index\":10056849}},{\"CreatedAt\":\"2022-01-04T21:53:20.40610415Z\",\"DesiredState\":\"shutdown\",\"ID\":\"z0xbye6o8sfrrp9tvrrvrpspf\",\"Labels\":{},\"NetworksAttachments\":[{\"Addresses\":[\"10.0.4.198/24\"],\"Network\":{\"CreatedAt\":\"2021-06-12T00:04:08.851633906Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4100\"}},\"ID\":\"pwqf514t16rtmjpq62shyib7h\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.4.1\",\"Subnet\":\"10.0.4.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"Attachable\":true,\"DriverConfiguration\":{\"Name\":\"overlay\"},\"IPAMOptions\":{\"Driver\":{\"Name\":\"default\"}},\"Labels\":{},\"Name\":\"prometheus\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2021-12-28T20:39:20.053403246Z\",\"Version\":{\"Index\":8635318}}},{\"Addresses\":[\"10.0.21.11/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.74850188Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4117\"}},\"ID\":\"c4ggc3aqae1ost27az5ri3nxz\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.21.1\",\"Subnet\":\"10.0.21.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_db\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.751592118Z\",\"Version\":{\"Index\":9866157}}},{\"Addresses\":[\"10.0.19.8/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.712710437Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4115\"}},\"ID\":\"r1u6c0bclbl6wyl1g8478x91v\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.19.1\",\"Subnet\":\"10.0.19.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_fe\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.715086232Z\",\"Version\":{\"Index\":9866153}}}],\"NodeID\":\"ybj02s79vhfv0zrcmwjecr3d6\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"ServiceID\":\"9vxwqyzsiehxqhe2w9pyi39n4\",\"Slot\":1,\"Spec\":{\"ContainerSpec\":{\"Args\":[\"bash\",\"-c\",\"set -e\\nexport METRICS_PW=\\\"$(cat /run/secrets/metrics-pw)\\\"\\nexec /bin/deploy.sh migrate -- /app/bin/puma.sh\\n\"],\"Configs\":[{\"ConfigID\":\"kyzf7xy96uv6ip5x65lgjf1wf\",\"ConfigName\":\"etna.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/env.yml\",\"UID\":\"0\"}},{\"ConfigID\":\"qn484g1c0bmaaw2n1fkueyc8e\",\"ConfigName\":\"timur.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/config.yml\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"ETNA__PRODUCTION_FILE=/app/env.yml\",\"ETNA__PRODUCTION__DB__PASSWORD_FILE=/run/secrets/db-password\",\"ETNA__PRODUCTION__ROLLBAR__ACCESS_TOKEN=/run/secrets/rollbar-access-token\",\"ETNA__PRODUCTION__USER_HASH_SECRET=/run/secrets/user-hash-secret\",\"TIMUR_ENV=production\"],\"Healthcheck\":{\"Interval\":10000000000,\"Retries\":3,\"StartPeriod\":1000000000,\"Test\":[\"CMD-SHELL\",\"bash -c 'curl http://localhost:3000 || exit 1'\"],\"Timeout\":5000000000},\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"/var/node_exporter/metrics.prom\",\"Target\":\"/tmp/metrics.prom\",\"Type\":\"bind\"}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"metrics-pw\",\"UID\":\"0\"},\"SecretID\":\"6adzt6tvilj2msj5m4vsy1eug\",\"SecretName\":\"metrics-pw\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"db-password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"user-hash-secret\",\"UID\":\"0\"},\"SecretID\":\"nqdn03euckbucxx1d7brr0gde\",\"SecretName\":\"user-hash-secret\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app\"],\"Target\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Aliases\":[\"app\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Aliases\":[\"timur_app\",\"app\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{}},\"Status\":{\"ContainerStatus\":{\"ContainerID\":\"9b86e192529d164b80087dbb180858e52f7db86027237dd2d4e6f6db5998505b\",\"ExitCode\":1,\"PID\":0},\"Message\":\"shutdown\",\"PortStatus\":{},\"State\":\"shutdown\",\"Timestamp\":\"2022-01-04T21:56:07.135526801Z\"},\"UpdatedAt\":\"2022-01-04T21:56:07.224862998Z\",\"Version\":{\"Index\":10057332}}]","stderr":"","i":"44 /home/home/monoetna/swarm/swarm-keeper/lib/edit-config-deploy.recording"}
{"cmd":"http","args":["--check-status","--proxy=http:socks5h://127.0.0.1:9090","--proxy=https:socks5h://127.0.0.1:9090","GET","https://portainer.dsco.ucsf.edu/api/endpoints/1/docker/services","Authorization: Bearer xxx","filters=={\"name\":[\"timur-staging_app\"]}"],"result":"0","stdin":"","stdout":"[{\"CreatedAt\":\"2022-01-03T23:20:43.937407448Z\",\"Endpoint\":{\"Spec\":{\"Mode\":\"vip\"},\"VirtualIPs\":[{\"Addr\":\"10.0.4.98/24\",\"NetworkID\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Addr\":\"10.0.21.4/24\",\"NetworkID\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Addr\":\"10.0.19.4/24\",\"NetworkID\":\"r1u6c0bclbl6wyl1g8478x91v\"}]},\"ID\":\"9vxwqyzsiehxqhe2w9pyi39n4\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"PreviousSpec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Replicated\":{\"Replicas\":1}},\"Name\":\"timur-staging_app\",\"TaskTemplate\":{\"ContainerSpec\":{\"Args\":[\"bash\",\"-c\",\"set -e\\nexport METRICS_PW=\\\"$(cat /run/secrets/metrics-pw)\\\"\\nexec /bin/deploy.sh migrate -- /app/bin/puma.sh\\n\"],\"Configs\":[{\"ConfigID\":\"kyzf7xy96uv6ip5x65lgjf1wf\",\"ConfigName\":\"etna.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/env.yml\",\"UID\":\"0\"}},{\"ConfigID\":\"v708ckky9705nzt3rv6gya39l\",\"ConfigName\":\"timur.staging.yml_1641333336\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/config.yml\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"ETNA__PRODUCTION_FILE=/app/env.yml\",\"ETNA__PRODUCTION__DB__PASSWORD_FILE=/run/secrets/db-password\",\"ETNA__PRODUCTION__ROLLBAR__ACCESS_TOKEN=/run/secrets/rollbar-access-token\",\"ETNA__PRODUCTION__USER_HASH_SECRET=/run/secrets/user-hash-secret\",\"TIMUR_ENV=production\"],\"Healthcheck\":{\"Interval\":10000000000,\"Retries\":3,\"StartPeriod\":1000000000,\"Test\":[\"CMD-SHELL\",\"bash -c 'curl http://localhost:3000 || exit 1'\"],\"Timeout\":5000000000},\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"/var/node_exporter/metrics.prom\",\"Target\":\"/tmp/metrics.prom\",\"Type\":\"bind\"}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"metrics-pw\",\"UID\":\"0\"},\"SecretID\":\"6adzt6tvilj2msj5m4vsy1eug\",\"SecretName\":\"metrics-pw\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"db-password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"user-hash-secret\",\"UID\":\"0\"},\"SecretID\":\"nqdn03euckbucxx1d7brr0gde\",\"SecretName\":\"user-hash-secret\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app\"],\"Target\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Aliases\":[\"app\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Aliases\":[\"timur_app\",\"app\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"Runtime\":\"container\"},\"UpdateConfig\":{\"FailureAction\":\"pause\",\"MaxFailureRatio\":0,\"Order\":\"start-first\",\"Parallelism\":1}},\"Spec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Replicated\":{\"Replicas\":1}},\"Name\":\"timur-staging_app\",\"TaskTemplate\":{\"ContainerSpec\":{\"Args\":[\"bash\",\"-c\",\"set -e\\nexport METRICS_PW=\\\"$(cat /run/secrets/metrics-pw)\\\"\\nexec /bin/deploy.sh migrate -- /app/bin/puma.sh\\n\"],\"Configs\":[{\"ConfigID\":\"kyzf7xy96uv6ip5x65lgjf1wf\",\"ConfigName\":\"etna.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/env.yml\",\"UID\":\"0\"}},{\"ConfigID\":\"da9539n2gpyfoszjf2o6scc7n\",\"ConfigName\":\"timur.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/config.yml\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"ETNA__PRODUCTION_FILE=/app/env.yml\",\"ETNA__PRODUCTION__DB__PASSWORD_FILE=/run/secrets/db-password\",\"ETNA__PRODUCTION__ROLLBAR__ACCESS_TOKEN=/run/secrets/rollbar-access-token\",\"ETNA__PRODUCTION__USER_HASH_SECRET=/run/secrets/user-hash-secret\",\"TIMUR_ENV=production\"],\"Healthcheck\":{\"Interval\":10000000000,\"Retries\":3,\"StartPeriod\":1000000000,\"Test\":[\"CMD-SHELL\",\"bash -c 'curl http://localhost:3000 || exit 1'\"],\"Timeout\":5000000000},\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"/var/node_exporter/metrics.prom\",\"Target\":\"/tmp/metrics.prom\",\"Type\":\"bind\"}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"metrics-pw\",\"UID\":\"0\"},\"SecretID\":\"6adzt6tvilj2msj5m4vsy1eug\",\"SecretName\":\"metrics-pw\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"db-password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"user-hash-secret\",\"UID\":\"0\"},\"SecretID\":\"nqdn03euckbucxx1d7brr0gde\",\"SecretName\":\"user-hash-secret\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app\"],\"Target\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Aliases\":[\"app\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Aliases\":[\"timur_app\",\"app\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"Runtime\":\"container\"},\"UpdateConfig\":{\"FailureAction\":\"pause\",\"MaxFailureRatio\":0,\"Order\":\"start-first\",\"Parallelism\":1}},\"UpdateStatus\":{\"Message\":\"update in progress\",\"StartedAt\":\"2022-01-04T21:56:36.479368664Z\",\"State\":\"updating\"},\"UpdatedAt\":\"2022-01-04T21:56:36.479454604Z\",\"Version\":{\"Index\":10057410}},{\"CreatedAt\":\"2022-01-03T23:20:41.23437548Z\",\"Endpoint\":{\"Spec\":{\"Mode\":\"vip\"},\"VirtualIPs\":[{\"Addr\":\"10.0.20.2/24\",\"NetworkID\":\"m52fcusnqimfjqpnrnqrq34gs\"}]},\"ID\":\"qgjxwctj8zxsu5i6ux5bf40j2\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"PreviousSpec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Global\":{}},\"Name\":\"timur-staging_app_assets_deployer\",\"TaskTemplate\":{\"ContainerSpec\":{\"Args\":[\"/bin/deploy.sh\",\"syncAssets\",\"--\",\"true\"],\"Env\":[\"APP_NAME=timur\",\"TIMUR_ENV=production\"],\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur-staging_app_public\",\"Target\":\"/sync-assets\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null}},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app_assets_deployer\"],\"Target\":\"m52fcusnqimfjqpnrnqrq34gs\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_app_public == true\"],\"MaxReplicas\":1,\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"RestartPolicy\":{\"Condition\":\"none\",\"MaxAttempts\":0},\"Runtime\":\"container\"}},\"Spec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Global\":{}},\"Name\":\"timur-staging_app_assets_deployer\",\"TaskTemplate\":{\"ContainerSpec\":{\"Args\":[\"/bin/deploy.sh\",\"syncAssets\",\"--\",\"true\"],\"Env\":[\"APP_NAME=timur\",\"TIMUR_ENV=production\"],\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur-staging_app_public\",\"Target\":\"/sync-assets\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null}},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app_assets_deployer\"],\"Target\":\"m52fcusnqimfjqpnrnqrq34gs\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_app_public == true\"],\"MaxReplicas\":1,\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"RestartPolicy\":{\"Condition\":\"none\",\"MaxAttempts\":0},\"Runtime\":\"container\"}},\"UpdatedAt\":\"2022-01-04T21:56:33.664230534Z\",\"Version\":{\"Index\":10057398}},{\"CreatedAt\":\"2022-01-03T23:20:39.571206988Z\",\"Endpoint\":{\"Spec\":{\"Mode\":\"vip\"},\"VirtualIPs\":[{\"Addr\":\"10.0.3.214/24\",\"NetworkID\":\"wl9z0sp3su5p6za45i3klgtn6\"},{\"Addr\":\"10.0.19.2/24\",\"NetworkID\":\"r1u6c0bclbl6wyl1g8478x91v\"}]},\"ID\":\"y8mocvq0olbq809713v3ey9hd\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"PreviousSpec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur_app_fe:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Replicated\":{\"Replicas\":1}},\"Name\":\"timur-staging_app_fe\",\"TaskTemplate\":{\"ContainerSpec\":{\"Configs\":[{\"ConfigID\":\"efyi8cnelo5i809bnga85ozje\",\"ConfigName\":\"browser.system.include\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/usr/opt/httpd.conf.d/browser.system.include\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"TIMUR_ENV=production\"],\"Image\":\"etnaagent/timur_app_fe:staging@sha256:f3527445b7147a4fba3923abc4f308f12457ffcf120021c7d9a0e234e7e048a3\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur-staging_app_public\",\"Target\":\"/app/public\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"User\":\"0:3000\"},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app_fe\"],\"Target\":\"wl9z0sp3su5p6za45i3klgtn6\"},{\"Aliases\":[\"app_fe\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_app_public == true\"],\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"RestartPolicy\":{\"Condition\":\"none\",\"MaxAttempts\":0},\"Runtime\":\"container\"}},\"Spec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur_app_fe:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Replicated\":{\"Replicas\":1}},\"Name\":\"timur-staging_app_fe\",\"TaskTemplate\":{\"ContainerSpec\":{\"Configs\":[{\"ConfigID\":\"efyi8cnelo5i809bnga85ozje\",\"ConfigName\":\"browser.system.include\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/usr/opt/httpd.conf.d/browser.system.include\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"TIMUR_ENV=production\"],\"Image\":\"etnaagent/timur_app_fe:staging@sha256:f3527445b7147a4fba3923abc4f308f12457ffcf120021c7d9a0e234e7e048a3\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur-staging_app_public\",\"Target\":\"/app/public\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"User\":\"0:3000\"},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app_fe\"],\"Target\":\"wl9z0sp3su5p6za45i3klgtn6\"},{\"Aliases\":[\"app_fe\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_app_public == true\"],\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"RestartPolicy\":{\"Condition\":\"none\",\"MaxAttempts\":0},\"Runtime\":\"container\"}},\"UpdatedAt\":\"2022-01-04T21:56:32.103949457Z\",\"Version\":{\"Index\":10057396}}]","stderr":"","i":"45 /home/home/monoetna/swarm/swarm-keeper/lib/edit-config-deploy.recording"}
{"cmd":"http","args":["--check-status","--proxy=http:socks5h://127.0.0.1:9090","--proxy=https:socks5h://127.0.0.1:9090","GET","https://portainer.dsco.ucsf.edu/api/endpoints/1/docker/tasks","Authorization: Bearer xxx","filters=={\"service\":[\"timur-staging_app\"],\"desired-state\":[\"shutdown\"]}"],"result":"0","stdin":"","stdout":"[{\"CreatedAt\":\"2022-01-04T21:52:36.602750303Z\",\"DesiredState\":\"shutdown\",\"ID\":\"1mn2vkae0he34q7mtwtwanpak\",\"Labels\":{},\"NetworksAttachments\":[{\"Addresses\":[\"10.0.4.197/24\"],\"Network\":{\"CreatedAt\":\"2021-06-12T00:04:08.851633906Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4100\"}},\"ID\":\"pwqf514t16rtmjpq62shyib7h\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.4.1\",\"Subnet\":\"10.0.4.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"Attachable\":true,\"DriverConfiguration\":{\"Name\":\"overlay\"},\"IPAMOptions\":{\"Driver\":{\"Name\":\"default\"}},\"Labels\":{},\"Name\":\"prometheus\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2021-12-28T20:39:20.053403246Z\",\"Version\":{\"Index\":8635318}}},{\"Addresses\":[\"10.0.21.9/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.74850188Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4117\"}},\"ID\":\"c4ggc3aqae1ost27az5ri3nxz\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.21.1\",\"Subnet\":\"10.0.21.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_db\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.751592118Z\",\"Version\":{\"Index\":9866157}}},{\"Addresses\":[\"10.0.19.6/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.712710437Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4115\"}},\"ID\":\"r1u6c0bclbl6wyl1g8478x91v\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.19.1\",\"Subnet\":\"10.0.19.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_fe\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.715086232Z\",\"Version\":{\"Index\":9866153}}}],\"NodeID\":\"3e634fut8umris4hqblxbgmk0\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"ServiceID\":\"9vxwqyzsiehxqhe2w9pyi39n4\",\"Slot\":1,\"Spec\":{\"ContainerSpec\":{\"Args\":[\"bash\",\"-c\",\"set -e\\nexport METRICS_PW=\\\"$(cat /run/secrets/metrics-pw)\\\"\\nexec /bin/deploy.sh migrate -- /app/bin/puma.sh\\n\"],\"Configs\":[{\"ConfigID\":\"kyzf7xy96uv6ip5x65lgjf1wf\",\"ConfigName\":\"etna.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/env.yml\",\"UID\":\"0\"}},{\"ConfigID\":\"sh4pln0b83bunf130n8v9e42n\",\"ConfigName\":\"timur.staging.yml_1641333148\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/config.yml\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"ETNA__PRODUCTION_FILE=/app/env.yml\",\"ETNA__PRODUCTION__DB__PASSWORD_FILE=/run/secrets/db-password\",\"ETNA__PRODUCTION__ROLLBAR__ACCESS_TOKEN=/run/secrets/rollbar-access-token\",\"ETNA__PRODUCTION__USER_HASH_SECRET=/run/secrets/user-hash-secret\",\"TIMUR_ENV=production\"],\"Healthcheck\":{\"Interval\":10000000000,\"Retries\":3,\"StartPeriod\":1000000000,\"Test\":[\"CMD-SHELL\",\"bash -c 'curl http://localhost:3000 || exit 1'\"],\"Timeout\":5000000000},\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"/var/node_exporter/metrics.prom\",\"Target\":\"/tmp/metrics.prom\",\"Type\":\"bind\"}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"metrics-pw\",\"UID\":\"0\"},\"SecretID\":\"6adzt6tvilj2msj5m4vsy1eug\",\"SecretName\":\"metrics-pw\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"db-password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"user-hash-secret\",\"UID\":\"0\"},\"SecretID\":\"nqdn03euckbucxx1d7brr0gde\",\"SecretName\":\"user-hash-secret\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app\"],\"Target\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Aliases\":[\"app\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Aliases\":[\"timur_app\",\"app\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{}},\"Status\":{\"ContainerStatus\":{\"ContainerID\":\"aaca6f0fdb21b4b33d0e72c46114d197cf1590889a946dfd4c0e84ab88573f31\",\"ExitCode\":1,\"PID\":0},\"Message\":\"shutdown\",\"PortStatus\":{},\"State\":\"shutdown\",\"Timestamp\":\"2022-01-04T21:53:41.895541058Z\"},\"UpdatedAt\":\"2022-01-04T21:53:41.93158238Z\",\"Version\":{\"Index\":10056975}},{\"CreatedAt\":\"2022-01-04T21:48:34.869891753Z\",\"DesiredState\":\"shutdown\",\"ID\":\"fz7aup1fu575twznk2a7lhqkd\",\"Labels\":{},\"NetworksAttachments\":[{\"Addresses\":[\"10.0.4.195/24\"],\"Network\":{\"CreatedAt\":\"2021-06-12T00:04:08.851633906Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4100\"}},\"ID\":\"pwqf514t16rtmjpq62shyib7h\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.4.1\",\"Subnet\":\"10.0.4.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"Attachable\":true,\"DriverConfiguration\":{\"Name\":\"overlay\"},\"IPAMOptions\":{\"Driver\":{\"Name\":\"default\"}},\"Labels\":{},\"Name\":\"prometheus\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2021-12-28T20:39:20.053403246Z\",\"Version\":{\"Index\":8635318}}},{\"Addresses\":[\"10.0.21.7/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.74850188Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4117\"}},\"ID\":\"c4ggc3aqae1ost27az5ri3nxz\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.21.1\",\"Subnet\":\"10.0.21.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_db\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.751592118Z\",\"Version\":{\"Index\":9866157}}},{\"Addresses\":[\"10.0.19.254/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.712710437Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4115\"}},\"ID\":\"r1u6c0bclbl6wyl1g8478x91v\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.19.1\",\"Subnet\":\"10.0.19.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_fe\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.715086232Z\",\"Version\":{\"Index\":9866153}}}],\"NodeID\":\"ybj02s79vhfv0zrcmwjecr3d6\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"ServiceID\":\"9vxwqyzsiehxqhe2w9pyi39n4\",\"Slot\":1,\"Spec\":{\"ContainerSpec\":{\"Args\":[\"bash\",\"-c\",\"set -e\\nexport METRICS_PW=\\\"$(cat /run/secrets/metrics-pw)\\\"\\nexec /bin/deploy.sh migrate -- /app/bin/puma.sh\\n\"],\"Configs\":[{\"ConfigID\":\"kyzf7xy96uv6ip5x65lgjf1wf\",\"ConfigName\":\"etna.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/env.yml\",\"UID\":\"0\"}},{\"ConfigID\":\"x4akplf1vv5h2j46f2hunod67\",\"ConfigName\":\"timur.staging.yml_1641325556_1641332269\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/config.yml\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"ETNA__PRODUCTION_FILE=/app/env.yml\",\"ETNA__PRODUCTION__DB__PASSWORD_FILE=/run/secrets/db-password\",\"ETNA__PRODUCTION__ROLLBAR__ACCESS_TOKEN=/run/secrets/rollbar-access-token\",\"ETNA__PRODUCTION__USER_HASH_SECRET=/run/secrets/user-hash-secret\",\"TIMUR_ENV=production\"],\"Healthcheck\":{\"Interval\":10000000000,\"Retries\":3,\"StartPeriod\":1000000000,\"Test\":[\"CMD-SHELL\",\"bash -c 'curl http://localhost:3000 || exit 1'\"],\"Timeout\":5000000000},\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"/var/node_exporter/metrics.prom\",\"Target\":\"/tmp/metrics.prom\",\"Type\":\"bind\"}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"metrics-pw\",\"UID\":\"0\"},\"SecretID\":\"6adzt6tvilj2msj5m4vsy1eug\",\"SecretName\":\"metrics-pw\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"db-password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"user-hash-secret\",\"UID\":\"0\"},\"SecretID\":\"nqdn03euckbucxx1d7brr0gde\",\"SecretName\":\"user-hash-secret\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app\"],\"Target\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Aliases\":[\"app\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Aliases\":[\"timur_app\",\"app\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{}},\"Status\":{\"ContainerStatus\":{\"ContainerID\":\"28e15f27e3274630586d2342b0a25983920365a860a2ff6745fd158f1d9a5a6b\",\"ExitCode\":1,\"PID\":0},\"Message\":\"shutdown\",\"PortStatus\":{},\"State\":\"shutdown\",\"Timestamp\":\"2022-01-04T21:52:55.827606933Z\"},\"UpdatedAt\":\"2022-01-04T21:52:55.864189786Z\",\"Version\":{\"Index\":10056849}},{\"CreatedAt\":\"2022-01-04T21:53:20.40610415Z\",\"DesiredState\":\"shutdown\",\"ID\":\"z0xbye6o8sfrrp9tvrrvrpspf\",\"Labels\":{},\"NetworksAttachments\":[{\"Addresses\":[\"10.0.4.198/24\"],\"Network\":{\"CreatedAt\":\"2021-06-12T00:04:08.851633906Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4100\"}},\"ID\":\"pwqf514t16rtmjpq62shyib7h\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.4.1\",\"Subnet\":\"10.0.4.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"Attachable\":true,\"DriverConfiguration\":{\"Name\":\"overlay\"},\"IPAMOptions\":{\"Driver\":{\"Name\":\"default\"}},\"Labels\":{},\"Name\":\"prometheus\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2021-12-28T20:39:20.053403246Z\",\"Version\":{\"Index\":8635318}}},{\"Addresses\":[\"10.0.21.11/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.74850188Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4117\"}},\"ID\":\"c4ggc3aqae1ost27az5ri3nxz\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.21.1\",\"Subnet\":\"10.0.21.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_db\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.751592118Z\",\"Version\":{\"Index\":9866157}}},{\"Addresses\":[\"10.0.19.8/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.712710437Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4115\"}},\"ID\":\"r1u6c0bclbl6wyl1g8478x91v\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.19.1\",\"Subnet\":\"10.0.19.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_fe\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.715086232Z\",\"Version\":{\"Index\":9866153}}}],\"NodeID\":\"ybj02s79vhfv0zrcmwjecr3d6\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"ServiceID\":\"9vxwqyzsiehxqhe2w9pyi39n4\",\"Slot\":1,\"Spec\":{\"ContainerSpec\":{\"Args\":[\"bash\",\"-c\",\"set -e\\nexport METRICS_PW=\\\"$(cat /run/secrets/metrics-pw)\\\"\\nexec /bin/deploy.sh migrate -- /app/bin/puma.sh\\n\"],\"Configs\":[{\"ConfigID\":\"kyzf7xy96uv6ip5x65lgjf1wf\",\"ConfigName\":\"etna.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/env.yml\",\"UID\":\"0\"}},{\"ConfigID\":\"qn484g1c0bmaaw2n1fkueyc8e\",\"ConfigName\":\"timur.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/config.yml\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"ETNA__PRODUCTION_FILE=/app/env.yml\",\"ETNA__PRODUCTION__DB__PASSWORD_FILE=/run/secrets/db-password\",\"ETNA__PRODUCTION__ROLLBAR__ACCESS_TOKEN=/run/secrets/rollbar-access-token\",\"ETNA__PRODUCTION__USER_HASH_SECRET=/run/secrets/user-hash-secret\",\"TIMUR_ENV=production\"],\"Healthcheck\":{\"Interval\":10000000000,\"Retries\":3,\"StartPeriod\":1000000000,\"Test\":[\"CMD-SHELL\",\"bash -c 'curl http://localhost:3000 || exit 1'\"],\"Timeout\":5000000000},\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"/var/node_exporter/metrics.prom\",\"Target\":\"/tmp/metrics.prom\",\"Type\":\"bind\"}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"metrics-pw\",\"UID\":\"0\"},\"SecretID\":\"6adzt6tvilj2msj5m4vsy1eug\",\"SecretName\":\"metrics-pw\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"db-password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"user-hash-secret\",\"UID\":\"0\"},\"SecretID\":\"nqdn03euckbucxx1d7brr0gde\",\"SecretName\":\"user-hash-secret\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app\"],\"Target\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Aliases\":[\"app\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Aliases\":[\"timur_app\",\"app\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{}},\"Status\":{\"ContainerStatus\":{\"ContainerID\":\"9b86e192529d164b80087dbb180858e52f7db86027237dd2d4e6f6db5998505b\",\"ExitCode\":1,\"PID\":0},\"Message\":\"shutdown\",\"PortStatus\":{},\"State\":\"shutdown\",\"Timestamp\":\"2022-01-04T21:56:07.135526801Z\"},\"UpdatedAt\":\"2022-01-04T21:56:07.224862998Z\",\"Version\":{\"Index\":10057332}}]","stderr":"","i":"46 /home/home/monoetna/swarm/swarm-keeper/lib/edit-config-deploy.recording"}
{"cmd":"http","args":["--check-status","--proxy=http:socks5h://127.0.0.1:9090","--proxy=https:socks5h://127.0.0.1:9090","GET","https://portainer.dsco.ucsf.edu/api/endpoints/1/docker/services","Authorization: Bearer xxx","filters=={\"name\":[\"timur-staging_app\"]}"],"result":"0","stdin":"","stdout":"[{\"CreatedAt\":\"2022-01-03T23:20:43.937407448Z\",\"Endpoint\":{\"Spec\":{\"Mode\":\"vip\"},\"VirtualIPs\":[{\"Addr\":\"10.0.4.98/24\",\"NetworkID\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Addr\":\"10.0.21.4/24\",\"NetworkID\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Addr\":\"10.0.19.4/24\",\"NetworkID\":\"r1u6c0bclbl6wyl1g8478x91v\"}]},\"ID\":\"9vxwqyzsiehxqhe2w9pyi39n4\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"PreviousSpec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Replicated\":{\"Replicas\":1}},\"Name\":\"timur-staging_app\",\"TaskTemplate\":{\"ContainerSpec\":{\"Args\":[\"bash\",\"-c\",\"set -e\\nexport METRICS_PW=\\\"$(cat /run/secrets/metrics-pw)\\\"\\nexec /bin/deploy.sh migrate -- /app/bin/puma.sh\\n\"],\"Configs\":[{\"ConfigID\":\"kyzf7xy96uv6ip5x65lgjf1wf\",\"ConfigName\":\"etna.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/env.yml\",\"UID\":\"0\"}},{\"ConfigID\":\"v708ckky9705nzt3rv6gya39l\",\"ConfigName\":\"timur.staging.yml_1641333336\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/config.yml\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"ETNA__PRODUCTION_FILE=/app/env.yml\",\"ETNA__PRODUCTION__DB__PASSWORD_FILE=/run/secrets/db-password\",\"ETNA__PRODUCTION__ROLLBAR__ACCESS_TOKEN=/run/secrets/rollbar-access-token\",\"ETNA__PRODUCTION__USER_HASH_SECRET=/run/secrets/user-hash-secret\",\"TIMUR_ENV=production\"],\"Healthcheck\":{\"Interval\":10000000000,\"Retries\":3,\"StartPeriod\":1000000000,\"Test\":[\"CMD-SHELL\",\"bash -c 'curl http://localhost:3000 || exit 1'\"],\"Timeout\":5000000000},\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"/var/node_exporter/metrics.prom\",\"Target\":\"/tmp/metrics.prom\",\"Type\":\"bind\"}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"metrics-pw\",\"UID\":\"0\"},\"SecretID\":\"6adzt6tvilj2msj5m4vsy1eug\",\"SecretName\":\"metrics-pw\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"db-password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"user-hash-secret\",\"UID\":\"0\"},\"SecretID\":\"nqdn03euckbucxx1d7brr0gde\",\"SecretName\":\"user-hash-secret\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app\"],\"Target\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Aliases\":[\"app\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Aliases\":[\"timur_app\",\"app\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"Runtime\":\"container\"},\"UpdateConfig\":{\"FailureAction\":\"pause\",\"MaxFailureRatio\":0,\"Order\":\"start-first\",\"Parallelism\":1}},\"Spec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Replicated\":{\"Replicas\":1}},\"Name\":\"timur-staging_app\",\"TaskTemplate\":{\"ContainerSpec\":{\"Args\":[\"bash\",\"-c\",\"set -e\\nexport METRICS_PW=\\\"$(cat /run/secrets/metrics-pw)\\\"\\nexec /bin/deploy.sh migrate -- /app/bin/puma.sh\\n\"],\"Configs\":[{\"ConfigID\":\"kyzf7xy96uv6ip5x65lgjf1wf\",\"ConfigName\":\"etna.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/env.yml\",\"UID\":\"0\"}},{\"ConfigID\":\"da9539n2gpyfoszjf2o6scc7n\",\"ConfigName\":\"timur.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/config.yml\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"ETNA__PRODUCTION_FILE=/app/env.yml\",\"ETNA__PRODUCTION__DB__PASSWORD_FILE=/run/secrets/db-password\",\"ETNA__PRODUCTION__ROLLBAR__ACCESS_TOKEN=/run/secrets/rollbar-access-token\",\"ETNA__PRODUCTION__USER_HASH_SECRET=/run/secrets/user-hash-secret\",\"TIMUR_ENV=production\"],\"Healthcheck\":{\"Interval\":10000000000,\"Retries\":3,\"StartPeriod\":1000000000,\"Test\":[\"CMD-SHELL\",\"bash -c 'curl http://localhost:3000 || exit 1'\"],\"Timeout\":5000000000},\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"/var/node_exporter/metrics.prom\",\"Target\":\"/tmp/metrics.prom\",\"Type\":\"bind\"}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"metrics-pw\",\"UID\":\"0\"},\"SecretID\":\"6adzt6tvilj2msj5m4vsy1eug\",\"SecretName\":\"metrics-pw\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"db-password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"user-hash-secret\",\"UID\":\"0\"},\"SecretID\":\"nqdn03euckbucxx1d7brr0gde\",\"SecretName\":\"user-hash-secret\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app\"],\"Target\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Aliases\":[\"app\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Aliases\":[\"timur_app\",\"app\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"Runtime\":\"container\"},\"UpdateConfig\":{\"FailureAction\":\"pause\",\"MaxFailureRatio\":0,\"Order\":\"start-first\",\"Parallelism\":1}},\"UpdateStatus\":{\"Message\":\"update in progress\",\"StartedAt\":\"2022-01-04T21:56:36.479368664Z\",\"State\":\"updating\"},\"UpdatedAt\":\"2022-01-04T21:56:36.479454604Z\",\"Version\":{\"Index\":10057410}},{\"CreatedAt\":\"2022-01-03T23:20:41.23437548Z\",\"Endpoint\":{\"Spec\":{\"Mode\":\"vip\"},\"VirtualIPs\":[{\"Addr\":\"10.0.20.2/24\",\"NetworkID\":\"m52fcusnqimfjqpnrnqrq34gs\"}]},\"ID\":\"qgjxwctj8zxsu5i6ux5bf40j2\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"PreviousSpec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Global\":{}},\"Name\":\"timur-staging_app_assets_deployer\",\"TaskTemplate\":{\"ContainerSpec\":{\"Args\":[\"/bin/deploy.sh\",\"syncAssets\",\"--\",\"true\"],\"Env\":[\"APP_NAME=timur\",\"TIMUR_ENV=production\"],\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur-staging_app_public\",\"Target\":\"/sync-assets\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null}},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app_assets_deployer\"],\"Target\":\"m52fcusnqimfjqpnrnqrq34gs\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_app_public == true\"],\"MaxReplicas\":1,\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"RestartPolicy\":{\"Condition\":\"none\",\"MaxAttempts\":0},\"Runtime\":\"container\"}},\"Spec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Global\":{}},\"Name\":\"timur-staging_app_assets_deployer\",\"TaskTemplate\":{\"ContainerSpec\":{\"Args\":[\"/bin/deploy.sh\",\"syncAssets\",\"--\",\"true\"],\"Env\":[\"APP_NAME=timur\",\"TIMUR_ENV=production\"],\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur-staging_app_public\",\"Target\":\"/sync-assets\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null}},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app_assets_deployer\"],\"Target\":\"m52fcusnqimfjqpnrnqrq34gs\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_app_public == true\"],\"MaxReplicas\":1,\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"RestartPolicy\":{\"Condition\":\"none\",\"MaxAttempts\":0},\"Runtime\":\"container\"}},\"UpdatedAt\":\"2022-01-04T21:56:33.664230534Z\",\"Version\":{\"Index\":10057398}},{\"CreatedAt\":\"2022-01-03T23:20:39.571206988Z\",\"Endpoint\":{\"Spec\":{\"Mode\":\"vip\"},\"VirtualIPs\":[{\"Addr\":\"10.0.3.214/24\",\"NetworkID\":\"wl9z0sp3su5p6za45i3klgtn6\"},{\"Addr\":\"10.0.19.2/24\",\"NetworkID\":\"r1u6c0bclbl6wyl1g8478x91v\"}]},\"ID\":\"y8mocvq0olbq809713v3ey9hd\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"PreviousSpec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur_app_fe:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Replicated\":{\"Replicas\":1}},\"Name\":\"timur-staging_app_fe\",\"TaskTemplate\":{\"ContainerSpec\":{\"Configs\":[{\"ConfigID\":\"efyi8cnelo5i809bnga85ozje\",\"ConfigName\":\"browser.system.include\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/usr/opt/httpd.conf.d/browser.system.include\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"TIMUR_ENV=production\"],\"Image\":\"etnaagent/timur_app_fe:staging@sha256:f3527445b7147a4fba3923abc4f308f12457ffcf120021c7d9a0e234e7e048a3\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur-staging_app_public\",\"Target\":\"/app/public\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"User\":\"0:3000\"},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app_fe\"],\"Target\":\"wl9z0sp3su5p6za45i3klgtn6\"},{\"Aliases\":[\"app_fe\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_app_public == true\"],\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"RestartPolicy\":{\"Condition\":\"none\",\"MaxAttempts\":0},\"Runtime\":\"container\"}},\"Spec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur_app_fe:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Replicated\":{\"Replicas\":1}},\"Name\":\"timur-staging_app_fe\",\"TaskTemplate\":{\"ContainerSpec\":{\"Configs\":[{\"ConfigID\":\"efyi8cnelo5i809bnga85ozje\",\"ConfigName\":\"browser.system.include\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/usr/opt/httpd.conf.d/browser.system.include\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"TIMUR_ENV=production\"],\"Image\":\"etnaagent/timur_app_fe:staging@sha256:f3527445b7147a4fba3923abc4f308f12457ffcf120021c7d9a0e234e7e048a3\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur-staging_app_public\",\"Target\":\"/app/public\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"User\":\"0:3000\"},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app_fe\"],\"Target\":\"wl9z0sp3su5p6za45i3klgtn6\"},{\"Aliases\":[\"app_fe\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_app_public == true\"],\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"RestartPolicy\":{\"Condition\":\"none\",\"MaxAttempts\":0},\"Runtime\":\"container\"}},\"UpdatedAt\":\"2022-01-04T21:56:32.103949457Z\",\"Version\":{\"Index\":10057396}}]","stderr":"","i":"47 /home/home/monoetna/swarm/swarm-keeper/lib/edit-config-deploy.recording"}
{"cmd":"http","args":["--check-status","--proxy=http:socks5h://127.0.0.1:9090","--proxy=https:socks5h://127.0.0.1:9090","GET","https://portainer.dsco.ucsf.edu/api/endpoints/1/docker/tasks","Authorization: Bearer xxx","filters=={\"service\":[\"timur-staging_app\"],\"desired-state\":[\"shutdown\"]}"],"result":"0","stdin":"","stdout":"[{\"CreatedAt\":\"2022-01-04T21:52:36.602750303Z\",\"DesiredState\":\"shutdown\",\"ID\":\"1mn2vkae0he34q7mtwtwanpak\",\"Labels\":{},\"NetworksAttachments\":[{\"Addresses\":[\"10.0.4.197/24\"],\"Network\":{\"CreatedAt\":\"2021-06-12T00:04:08.851633906Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4100\"}},\"ID\":\"pwqf514t16rtmjpq62shyib7h\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.4.1\",\"Subnet\":\"10.0.4.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"Attachable\":true,\"DriverConfiguration\":{\"Name\":\"overlay\"},\"IPAMOptions\":{\"Driver\":{\"Name\":\"default\"}},\"Labels\":{},\"Name\":\"prometheus\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2021-12-28T20:39:20.053403246Z\",\"Version\":{\"Index\":8635318}}},{\"Addresses\":[\"10.0.21.9/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.74850188Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4117\"}},\"ID\":\"c4ggc3aqae1ost27az5ri3nxz\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.21.1\",\"Subnet\":\"10.0.21.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_db\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.751592118Z\",\"Version\":{\"Index\":9866157}}},{\"Addresses\":[\"10.0.19.6/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.712710437Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4115\"}},\"ID\":\"r1u6c0bclbl6wyl1g8478x91v\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.19.1\",\"Subnet\":\"10.0.19.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_fe\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.715086232Z\",\"Version\":{\"Index\":9866153}}}],\"NodeID\":\"3e634fut8umris4hqblxbgmk0\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"ServiceID\":\"9vxwqyzsiehxqhe2w9pyi39n4\",\"Slot\":1,\"Spec\":{\"ContainerSpec\":{\"Args\":[\"bash\",\"-c\",\"set -e\\nexport METRICS_PW=\\\"$(cat /run/secrets/metrics-pw)\\\"\\nexec /bin/deploy.sh migrate -- /app/bin/puma.sh\\n\"],\"Configs\":[{\"ConfigID\":\"kyzf7xy96uv6ip5x65lgjf1wf\",\"ConfigName\":\"etna.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/env.yml\",\"UID\":\"0\"}},{\"ConfigID\":\"sh4pln0b83bunf130n8v9e42n\",\"ConfigName\":\"timur.staging.yml_1641333148\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/config.yml\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"ETNA__PRODUCTION_FILE=/app/env.yml\",\"ETNA__PRODUCTION__DB__PASSWORD_FILE=/run/secrets/db-password\",\"ETNA__PRODUCTION__ROLLBAR__ACCESS_TOKEN=/run/secrets/rollbar-access-token\",\"ETNA__PRODUCTION__USER_HASH_SECRET=/run/secrets/user-hash-secret\",\"TIMUR_ENV=production\"],\"Healthcheck\":{\"Interval\":10000000000,\"Retries\":3,\"StartPeriod\":1000000000,\"Test\":[\"CMD-SHELL\",\"bash -c 'curl http://localhost:3000 || exit 1'\"],\"Timeout\":5000000000},\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"/var/node_exporter/metrics.prom\",\"Target\":\"/tmp/metrics.prom\",\"Type\":\"bind\"}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"metrics-pw\",\"UID\":\"0\"},\"SecretID\":\"6adzt6tvilj2msj5m4vsy1eug\",\"SecretName\":\"metrics-pw\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"db-password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"user-hash-secret\",\"UID\":\"0\"},\"SecretID\":\"nqdn03euckbucxx1d7brr0gde\",\"SecretName\":\"user-hash-secret\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app\"],\"Target\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Aliases\":[\"app\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Aliases\":[\"timur_app\",\"app\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{}},\"Status\":{\"ContainerStatus\":{\"ContainerID\":\"aaca6f0fdb21b4b33d0e72c46114d197cf1590889a946dfd4c0e84ab88573f31\",\"ExitCode\":1,\"PID\":0},\"Message\":\"shutdown\",\"PortStatus\":{},\"State\":\"shutdown\",\"Timestamp\":\"2022-01-04T21:53:41.895541058Z\"},\"UpdatedAt\":\"2022-01-04T21:53:41.93158238Z\",\"Version\":{\"Index\":10056975}},{\"CreatedAt\":\"2022-01-04T21:48:34.869891753Z\",\"DesiredState\":\"shutdown\",\"ID\":\"fz7aup1fu575twznk2a7lhqkd\",\"Labels\":{},\"NetworksAttachments\":[{\"Addresses\":[\"10.0.4.195/24\"],\"Network\":{\"CreatedAt\":\"2021-06-12T00:04:08.851633906Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4100\"}},\"ID\":\"pwqf514t16rtmjpq62shyib7h\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.4.1\",\"Subnet\":\"10.0.4.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"Attachable\":true,\"DriverConfiguration\":{\"Name\":\"overlay\"},\"IPAMOptions\":{\"Driver\":{\"Name\":\"default\"}},\"Labels\":{},\"Name\":\"prometheus\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2021-12-28T20:39:20.053403246Z\",\"Version\":{\"Index\":8635318}}},{\"Addresses\":[\"10.0.21.7/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.74850188Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4117\"}},\"ID\":\"c4ggc3aqae1ost27az5ri3nxz\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.21.1\",\"Subnet\":\"10.0.21.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_db\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.751592118Z\",\"Version\":{\"Index\":9866157}}},{\"Addresses\":[\"10.0.19.254/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.712710437Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4115\"}},\"ID\":\"r1u6c0bclbl6wyl1g8478x91v\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.19.1\",\"Subnet\":\"10.0.19.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_fe\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.715086232Z\",\"Version\":{\"Index\":9866153}}}],\"NodeID\":\"ybj02s79vhfv0zrcmwjecr3d6\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"ServiceID\":\"9vxwqyzsiehxqhe2w9pyi39n4\",\"Slot\":1,\"Spec\":{\"ContainerSpec\":{\"Args\":[\"bash\",\"-c\",\"set -e\\nexport METRICS_PW=\\\"$(cat /run/secrets/metrics-pw)\\\"\\nexec /bin/deploy.sh migrate -- /app/bin/puma.sh\\n\"],\"Configs\":[{\"ConfigID\":\"kyzf7xy96uv6ip5x65lgjf1wf\",\"ConfigName\":\"etna.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/env.yml\",\"UID\":\"0\"}},{\"ConfigID\":\"x4akplf1vv5h2j46f2hunod67\",\"ConfigName\":\"timur.staging.yml_1641325556_1641332269\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/config.yml\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"ETNA__PRODUCTION_FILE=/app/env.yml\",\"ETNA__PRODUCTION__DB__PASSWORD_FILE=/run/secrets/db-password\",\"ETNA__PRODUCTION__ROLLBAR__ACCESS_TOKEN=/run/secrets/rollbar-access-token\",\"ETNA__PRODUCTION__USER_HASH_SECRET=/run/secrets/user-hash-secret\",\"TIMUR_ENV=production\"],\"Healthcheck\":{\"Interval\":10000000000,\"Retries\":3,\"StartPeriod\":1000000000,\"Test\":[\"CMD-SHELL\",\"bash -c 'curl http://localhost:3000 || exit 1'\"],\"Timeout\":5000000000},\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"/var/node_exporter/metrics.prom\",\"Target\":\"/tmp/metrics.prom\",\"Type\":\"bind\"}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"metrics-pw\",\"UID\":\"0\"},\"SecretID\":\"6adzt6tvilj2msj5m4vsy1eug\",\"SecretName\":\"metrics-pw\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"db-password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"user-hash-secret\",\"UID\":\"0\"},\"SecretID\":\"nqdn03euckbucxx1d7brr0gde\",\"SecretName\":\"user-hash-secret\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app\"],\"Target\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Aliases\":[\"app\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Aliases\":[\"timur_app\",\"app\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{}},\"Status\":{\"ContainerStatus\":{\"ContainerID\":\"28e15f27e3274630586d2342b0a25983920365a860a2ff6745fd158f1d9a5a6b\",\"ExitCode\":1,\"PID\":0},\"Message\":\"shutdown\",\"PortStatus\":{},\"State\":\"shutdown\",\"Timestamp\":\"2022-01-04T21:52:55.827606933Z\"},\"UpdatedAt\":\"2022-01-04T21:52:55.864189786Z\",\"Version\":{\"Index\":10056849}},{\"CreatedAt\":\"2022-01-04T21:55:48.100231373Z\",\"DesiredState\":\"shutdown\",\"ID\":\"m41xhijn10or0nd85c924csca\",\"Labels\":{},\"NetworksAttachments\":[{\"Addresses\":[\"10.0.4.200/24\"],\"Network\":{\"CreatedAt\":\"2021-06-12T00:04:08.851633906Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4100\"}},\"ID\":\"pwqf514t16rtmjpq62shyib7h\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.4.1\",\"Subnet\":\"10.0.4.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"Attachable\":true,\"DriverConfiguration\":{\"Name\":\"overlay\"},\"IPAMOptions\":{\"Driver\":{\"Name\":\"default\"}},\"Labels\":{},\"Name\":\"prometheus\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2021-12-28T20:39:20.053403246Z\",\"Version\":{\"Index\":8635318}}},{\"Addresses\":[\"10.0.21.13/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.74850188Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4117\"}},\"ID\":\"c4ggc3aqae1ost27az5ri3nxz\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.21.1\",\"Subnet\":\"10.0.21.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_db\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.751592118Z\",\"Version\":{\"Index\":9866157}}},{\"Addresses\":[\"10.0.19.10/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.712710437Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4115\"}},\"ID\":\"r1u6c0bclbl6wyl1g8478x91v\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.19.1\",\"Subnet\":\"10.0.19.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_fe\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.715086232Z\",\"Version\":{\"Index\":9866153}}}],\"NodeID\":\"3e634fut8umris4hqblxbgmk0\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"ServiceID\":\"9vxwqyzsiehxqhe2w9pyi39n4\",\"Slot\":1,\"Spec\":{\"ContainerSpec\":{\"Args\":[\"bash\",\"-c\",\"set -e\\nexport METRICS_PW=\\\"$(cat /run/secrets/metrics-pw)\\\"\\nexec /bin/deploy.sh migrate -- /app/bin/puma.sh\\n\"],\"Configs\":[{\"ConfigID\":\"kyzf7xy96uv6ip5x65lgjf1wf\",\"ConfigName\":\"etna.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/env.yml\",\"UID\":\"0\"}},{\"ConfigID\":\"v708ckky9705nzt3rv6gya39l\",\"ConfigName\":\"timur.staging.yml_1641333336\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/config.yml\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"ETNA__PRODUCTION_FILE=/app/env.yml\",\"ETNA__PRODUCTION__DB__PASSWORD_FILE=/run/secrets/db-password\",\"ETNA__PRODUCTION__ROLLBAR__ACCESS_TOKEN=/run/secrets/rollbar-access-token\",\"ETNA__PRODUCTION__USER_HASH_SECRET=/run/secrets/user-hash-secret\",\"TIMUR_ENV=production\"],\"Healthcheck\":{\"Interval\":10000000000,\"Retries\":3,\"StartPeriod\":1000000000,\"Test\":[\"CMD-SHELL\",\"bash -c 'curl http://localhost:3000 || exit 1'\"],\"Timeout\":5000000000},\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"/var/node_exporter/metrics.prom\",\"Target\":\"/tmp/metrics.prom\",\"Type\":\"bind\"}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"metrics-pw\",\"UID\":\"0\"},\"SecretID\":\"6adzt6tvilj2msj5m4vsy1eug\",\"SecretName\":\"metrics-pw\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"db-password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"user-hash-secret\",\"UID\":\"0\"},\"SecretID\":\"nqdn03euckbucxx1d7brr0gde\",\"SecretName\":\"user-hash-secret\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app\"],\"Target\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Aliases\":[\"app\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Aliases\":[\"timur_app\",\"app\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{}},\"Status\":{\"ContainerStatus\":{\"ContainerID\":\"e3a51c0c8b47be1f146e69cdb9e1f2569179bf5820fc3ef56e2db70d33814e23\",\"ExitCode\":-1,\"PID\":5135},\"Message\":\"started\",\"PortStatus\":{},\"State\":\"running\",\"Timestamp\":\"2022-01-04T21:56:53.763326712Z\"},\"UpdatedAt\":\"2022-01-04T21:56:53.858491566Z\",\"Version\":{\"Index\":10057456}},{\"CreatedAt\":\"2022-01-04T21:53:20.40610415Z\",\"DesiredState\":\"shutdown\",\"ID\":\"z0xbye6o8sfrrp9tvrrvrpspf\",\"Labels\":{},\"NetworksAttachments\":[{\"Addresses\":[\"10.0.4.198/24\"],\"Network\":{\"CreatedAt\":\"2021-06-12T00:04:08.851633906Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4100\"}},\"ID\":\"pwqf514t16rtmjpq62shyib7h\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.4.1\",\"Subnet\":\"10.0.4.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"Attachable\":true,\"DriverConfiguration\":{\"Name\":\"overlay\"},\"IPAMOptions\":{\"Driver\":{\"Name\":\"default\"}},\"Labels\":{},\"Name\":\"prometheus\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2021-12-28T20:39:20.053403246Z\",\"Version\":{\"Index\":8635318}}},{\"Addresses\":[\"10.0.21.11/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.74850188Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4117\"}},\"ID\":\"c4ggc3aqae1ost27az5ri3nxz\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.21.1\",\"Subnet\":\"10.0.21.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_db\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.751592118Z\",\"Version\":{\"Index\":9866157}}},{\"Addresses\":[\"10.0.19.8/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.712710437Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4115\"}},\"ID\":\"r1u6c0bclbl6wyl1g8478x91v\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.19.1\",\"Subnet\":\"10.0.19.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_fe\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.715086232Z\",\"Version\":{\"Index\":9866153}}}],\"NodeID\":\"ybj02s79vhfv0zrcmwjecr3d6\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"ServiceID\":\"9vxwqyzsiehxqhe2w9pyi39n4\",\"Slot\":1,\"Spec\":{\"ContainerSpec\":{\"Args\":[\"bash\",\"-c\",\"set -e\\nexport METRICS_PW=\\\"$(cat /run/secrets/metrics-pw)\\\"\\nexec /bin/deploy.sh migrate -- /app/bin/puma.sh\\n\"],\"Configs\":[{\"ConfigID\":\"kyzf7xy96uv6ip5x65lgjf1wf\",\"ConfigName\":\"etna.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/env.yml\",\"UID\":\"0\"}},{\"ConfigID\":\"qn484g1c0bmaaw2n1fkueyc8e\",\"ConfigName\":\"timur.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/config.yml\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"ETNA__PRODUCTION_FILE=/app/env.yml\",\"ETNA__PRODUCTION__DB__PASSWORD_FILE=/run/secrets/db-password\",\"ETNA__PRODUCTION__ROLLBAR__ACCESS_TOKEN=/run/secrets/rollbar-access-token\",\"ETNA__PRODUCTION__USER_HASH_SECRET=/run/secrets/user-hash-secret\",\"TIMUR_ENV=production\"],\"Healthcheck\":{\"Interval\":10000000000,\"Retries\":3,\"StartPeriod\":1000000000,\"Test\":[\"CMD-SHELL\",\"bash -c 'curl http://localhost:3000 || exit 1'\"],\"Timeout\":5000000000},\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"/var/node_exporter/metrics.prom\",\"Target\":\"/tmp/metrics.prom\",\"Type\":\"bind\"}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"metrics-pw\",\"UID\":\"0\"},\"SecretID\":\"6adzt6tvilj2msj5m4vsy1eug\",\"SecretName\":\"metrics-pw\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"db-password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"user-hash-secret\",\"UID\":\"0\"},\"SecretID\":\"nqdn03euckbucxx1d7brr0gde\",\"SecretName\":\"user-hash-secret\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app\"],\"Target\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Aliases\":[\"app\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Aliases\":[\"timur_app\",\"app\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{}},\"Status\":{\"ContainerStatus\":{\"ContainerID\":\"9b86e192529d164b80087dbb180858e52f7db86027237dd2d4e6f6db5998505b\",\"ExitCode\":1,\"PID\":0},\"Message\":\"shutdown\",\"PortStatus\":{},\"State\":\"shutdown\",\"Timestamp\":\"2022-01-04T21:56:07.135526801Z\"},\"UpdatedAt\":\"2022-01-04T21:56:07.224862998Z\",\"Version\":{\"Index\":10057332}}]","stderr":"","i":"48 /home/home/monoetna/swarm/swarm-keeper/lib/edit-config-deploy.recording"}
{"cmd":"http","args":["--check-status","--proxy=http:socks5h://127.0.0.1:9090","--proxy=https:socks5h://127.0.0.1:9090","GET","https://portainer.dsco.ucsf.edu/api/endpoints/1/docker/services","Authorization: Bearer xxx","filters=={\"name\":[\"timur-staging_app\"]}"],"result":"0","stdin":"","stdout":"[{\"CreatedAt\":\"2022-01-03T23:20:43.937407448Z\",\"Endpoint\":{\"Spec\":{\"Mode\":\"vip\"},\"VirtualIPs\":[{\"Addr\":\"10.0.4.98/24\",\"NetworkID\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Addr\":\"10.0.21.4/24\",\"NetworkID\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Addr\":\"10.0.19.4/24\",\"NetworkID\":\"r1u6c0bclbl6wyl1g8478x91v\"}]},\"ID\":\"9vxwqyzsiehxqhe2w9pyi39n4\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"PreviousSpec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Replicated\":{\"Replicas\":1}},\"Name\":\"timur-staging_app\",\"TaskTemplate\":{\"ContainerSpec\":{\"Args\":[\"bash\",\"-c\",\"set -e\\nexport METRICS_PW=\\\"$(cat /run/secrets/metrics-pw)\\\"\\nexec /bin/deploy.sh migrate -- /app/bin/puma.sh\\n\"],\"Configs\":[{\"ConfigID\":\"kyzf7xy96uv6ip5x65lgjf1wf\",\"ConfigName\":\"etna.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/env.yml\",\"UID\":\"0\"}},{\"ConfigID\":\"v708ckky9705nzt3rv6gya39l\",\"ConfigName\":\"timur.staging.yml_1641333336\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/config.yml\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"ETNA__PRODUCTION_FILE=/app/env.yml\",\"ETNA__PRODUCTION__DB__PASSWORD_FILE=/run/secrets/db-password\",\"ETNA__PRODUCTION__ROLLBAR__ACCESS_TOKEN=/run/secrets/rollbar-access-token\",\"ETNA__PRODUCTION__USER_HASH_SECRET=/run/secrets/user-hash-secret\",\"TIMUR_ENV=production\"],\"Healthcheck\":{\"Interval\":10000000000,\"Retries\":3,\"StartPeriod\":1000000000,\"Test\":[\"CMD-SHELL\",\"bash -c 'curl http://localhost:3000 || exit 1'\"],\"Timeout\":5000000000},\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"/var/node_exporter/metrics.prom\",\"Target\":\"/tmp/metrics.prom\",\"Type\":\"bind\"}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"metrics-pw\",\"UID\":\"0\"},\"SecretID\":\"6adzt6tvilj2msj5m4vsy1eug\",\"SecretName\":\"metrics-pw\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"db-password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"user-hash-secret\",\"UID\":\"0\"},\"SecretID\":\"nqdn03euckbucxx1d7brr0gde\",\"SecretName\":\"user-hash-secret\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app\"],\"Target\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Aliases\":[\"app\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Aliases\":[\"timur_app\",\"app\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"Runtime\":\"container\"},\"UpdateConfig\":{\"FailureAction\":\"pause\",\"MaxFailureRatio\":0,\"Order\":\"start-first\",\"Parallelism\":1}},\"Spec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Replicated\":{\"Replicas\":1}},\"Name\":\"timur-staging_app\",\"TaskTemplate\":{\"ContainerSpec\":{\"Args\":[\"bash\",\"-c\",\"set -e\\nexport METRICS_PW=\\\"$(cat /run/secrets/metrics-pw)\\\"\\nexec /bin/deploy.sh migrate -- /app/bin/puma.sh\\n\"],\"Configs\":[{\"ConfigID\":\"kyzf7xy96uv6ip5x65lgjf1wf\",\"ConfigName\":\"etna.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/env.yml\",\"UID\":\"0\"}},{\"ConfigID\":\"da9539n2gpyfoszjf2o6scc7n\",\"ConfigName\":\"timur.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/config.yml\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"ETNA__PRODUCTION_FILE=/app/env.yml\",\"ETNA__PRODUCTION__DB__PASSWORD_FILE=/run/secrets/db-password\",\"ETNA__PRODUCTION__ROLLBAR__ACCESS_TOKEN=/run/secrets/rollbar-access-token\",\"ETNA__PRODUCTION__USER_HASH_SECRET=/run/secrets/user-hash-secret\",\"TIMUR_ENV=production\"],\"Healthcheck\":{\"Interval\":10000000000,\"Retries\":3,\"StartPeriod\":1000000000,\"Test\":[\"CMD-SHELL\",\"bash -c 'curl http://localhost:3000 || exit 1'\"],\"Timeout\":5000000000},\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"/var/node_exporter/metrics.prom\",\"Target\":\"/tmp/metrics.prom\",\"Type\":\"bind\"}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"metrics-pw\",\"UID\":\"0\"},\"SecretID\":\"6adzt6tvilj2msj5m4vsy1eug\",\"SecretName\":\"metrics-pw\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"db-password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"user-hash-secret\",\"UID\":\"0\"},\"SecretID\":\"nqdn03euckbucxx1d7brr0gde\",\"SecretName\":\"user-hash-secret\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app\"],\"Target\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Aliases\":[\"app\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Aliases\":[\"timur_app\",\"app\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"Runtime\":\"container\"},\"UpdateConfig\":{\"FailureAction\":\"pause\",\"MaxFailureRatio\":0,\"Order\":\"start-first\",\"Parallelism\":1}},\"UpdateStatus\":{\"CompletedAt\":\"2022-01-04T21:56:58.662459633Z\",\"Message\":\"update completed\",\"StartedAt\":\"2022-01-04T21:56:36.479368664Z\",\"State\":\"completed\"},\"UpdatedAt\":\"2022-01-04T21:56:58.662487109Z\",\"Version\":{\"Index\":10057471}},{\"CreatedAt\":\"2022-01-03T23:20:41.23437548Z\",\"Endpoint\":{\"Spec\":{\"Mode\":\"vip\"},\"VirtualIPs\":[{\"Addr\":\"10.0.20.2/24\",\"NetworkID\":\"m52fcusnqimfjqpnrnqrq34gs\"}]},\"ID\":\"qgjxwctj8zxsu5i6ux5bf40j2\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"PreviousSpec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Global\":{}},\"Name\":\"timur-staging_app_assets_deployer\",\"TaskTemplate\":{\"ContainerSpec\":{\"Args\":[\"/bin/deploy.sh\",\"syncAssets\",\"--\",\"true\"],\"Env\":[\"APP_NAME=timur\",\"TIMUR_ENV=production\"],\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur-staging_app_public\",\"Target\":\"/sync-assets\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null}},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app_assets_deployer\"],\"Target\":\"m52fcusnqimfjqpnrnqrq34gs\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_app_public == true\"],\"MaxReplicas\":1,\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"RestartPolicy\":{\"Condition\":\"none\",\"MaxAttempts\":0},\"Runtime\":\"container\"}},\"Spec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Global\":{}},\"Name\":\"timur-staging_app_assets_deployer\",\"TaskTemplate\":{\"ContainerSpec\":{\"Args\":[\"/bin/deploy.sh\",\"syncAssets\",\"--\",\"true\"],\"Env\":[\"APP_NAME=timur\",\"TIMUR_ENV=production\"],\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur-staging_app_public\",\"Target\":\"/sync-assets\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null}},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app_assets_deployer\"],\"Target\":\"m52fcusnqimfjqpnrnqrq34gs\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_app_public == true\"],\"MaxReplicas\":1,\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"RestartPolicy\":{\"Condition\":\"none\",\"MaxAttempts\":0},\"Runtime\":\"container\"}},\"UpdatedAt\":\"2022-01-04T21:56:33.664230534Z\",\"Version\":{\"Index\":10057398}},{\"CreatedAt\":\"2022-01-03T23:20:39.571206988Z\",\"Endpoint\":{\"Spec\":{\"Mode\":\"vip\"},\"VirtualIPs\":[{\"Addr\":\"10.0.3.214/24\",\"NetworkID\":\"wl9z0sp3su5p6za45i3klgtn6\"},{\"Addr\":\"10.0.19.2/24\",\"NetworkID\":\"r1u6c0bclbl6wyl1g8478x91v\"}]},\"ID\":\"y8mocvq0olbq809713v3ey9hd\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"PreviousSpec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur_app_fe:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Replicated\":{\"Replicas\":1}},\"Name\":\"timur-staging_app_fe\",\"TaskTemplate\":{\"ContainerSpec\":{\"Configs\":[{\"ConfigID\":\"efyi8cnelo5i809bnga85ozje\",\"ConfigName\":\"browser.system.include\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/usr/opt/httpd.conf.d/browser.system.include\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"TIMUR_ENV=production\"],\"Image\":\"etnaagent/timur_app_fe:staging@sha256:f3527445b7147a4fba3923abc4f308f12457ffcf120021c7d9a0e234e7e048a3\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur-staging_app_public\",\"Target\":\"/app/public\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"User\":\"0:3000\"},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app_fe\"],\"Target\":\"wl9z0sp3su5p6za45i3klgtn6\"},{\"Aliases\":[\"app_fe\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_app_public == true\"],\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"RestartPolicy\":{\"Condition\":\"none\",\"MaxAttempts\":0},\"Runtime\":\"container\"}},\"Spec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur_app_fe:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Replicated\":{\"Replicas\":1}},\"Name\":\"timur-staging_app_fe\",\"TaskTemplate\":{\"ContainerSpec\":{\"Configs\":[{\"ConfigID\":\"efyi8cnelo5i809bnga85ozje\",\"ConfigName\":\"browser.system.include\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/usr/opt/httpd.conf.d/browser.system.include\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"TIMUR_ENV=production\"],\"Image\":\"etnaagent/timur_app_fe:staging@sha256:f3527445b7147a4fba3923abc4f308f12457ffcf120021c7d9a0e234e7e048a3\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur-staging_app_public\",\"Target\":\"/app/public\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"User\":\"0:3000\"},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app_fe\"],\"Target\":\"wl9z0sp3su5p6za45i3klgtn6\"},{\"Aliases\":[\"app_fe\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_app_public == true\"],\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"RestartPolicy\":{\"Condition\":\"none\",\"MaxAttempts\":0},\"Runtime\":\"container\"}},\"UpdatedAt\":\"2022-01-04T21:56:32.103949457Z\",\"Version\":{\"Index\":10057396}}]","stderr":"","i":"49 /home/home/monoetna/swarm/swarm-keeper/lib/edit-config-deploy.recording"}
{"cmd":"http","args":["--check-status","--proxy=http:socks5h://127.0.0.1:9090","--proxy=https:socks5h://127.0.0.1:9090","GET","https://portainer.dsco.ucsf.edu/api/endpoints/1/docker/tasks","Authorization: Bearer xxx","filters=={\"service\":[\"timur-staging_app\"],\"desired-state\":[\"shutdown\"]}"],"result":"0","stdin":"","stdout":"[{\"CreatedAt\":\"2022-01-04T21:52:36.602750303Z\",\"DesiredState\":\"shutdown\",\"ID\":\"1mn2vkae0he34q7mtwtwanpak\",\"Labels\":{},\"NetworksAttachments\":[{\"Addresses\":[\"10.0.4.197/24\"],\"Network\":{\"CreatedAt\":\"2021-06-12T00:04:08.851633906Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4100\"}},\"ID\":\"pwqf514t16rtmjpq62shyib7h\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.4.1\",\"Subnet\":\"10.0.4.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"Attachable\":true,\"DriverConfiguration\":{\"Name\":\"overlay\"},\"IPAMOptions\":{\"Driver\":{\"Name\":\"default\"}},\"Labels\":{},\"Name\":\"prometheus\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2021-12-28T20:39:20.053403246Z\",\"Version\":{\"Index\":8635318}}},{\"Addresses\":[\"10.0.21.9/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.74850188Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4117\"}},\"ID\":\"c4ggc3aqae1ost27az5ri3nxz\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.21.1\",\"Subnet\":\"10.0.21.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_db\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.751592118Z\",\"Version\":{\"Index\":9866157}}},{\"Addresses\":[\"10.0.19.6/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.712710437Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4115\"}},\"ID\":\"r1u6c0bclbl6wyl1g8478x91v\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.19.1\",\"Subnet\":\"10.0.19.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_fe\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.715086232Z\",\"Version\":{\"Index\":9866153}}}],\"NodeID\":\"3e634fut8umris4hqblxbgmk0\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"ServiceID\":\"9vxwqyzsiehxqhe2w9pyi39n4\",\"Slot\":1,\"Spec\":{\"ContainerSpec\":{\"Args\":[\"bash\",\"-c\",\"set -e\\nexport METRICS_PW=\\\"$(cat /run/secrets/metrics-pw)\\\"\\nexec /bin/deploy.sh migrate -- /app/bin/puma.sh\\n\"],\"Configs\":[{\"ConfigID\":\"kyzf7xy96uv6ip5x65lgjf1wf\",\"ConfigName\":\"etna.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/env.yml\",\"UID\":\"0\"}},{\"ConfigID\":\"sh4pln0b83bunf130n8v9e42n\",\"ConfigName\":\"timur.staging.yml_1641333148\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/config.yml\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"ETNA__PRODUCTION_FILE=/app/env.yml\",\"ETNA__PRODUCTION__DB__PASSWORD_FILE=/run/secrets/db-password\",\"ETNA__PRODUCTION__ROLLBAR__ACCESS_TOKEN=/run/secrets/rollbar-access-token\",\"ETNA__PRODUCTION__USER_HASH_SECRET=/run/secrets/user-hash-secret\",\"TIMUR_ENV=production\"],\"Healthcheck\":{\"Interval\":10000000000,\"Retries\":3,\"StartPeriod\":1000000000,\"Test\":[\"CMD-SHELL\",\"bash -c 'curl http://localhost:3000 || exit 1'\"],\"Timeout\":5000000000},\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"/var/node_exporter/metrics.prom\",\"Target\":\"/tmp/metrics.prom\",\"Type\":\"bind\"}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"metrics-pw\",\"UID\":\"0\"},\"SecretID\":\"6adzt6tvilj2msj5m4vsy1eug\",\"SecretName\":\"metrics-pw\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"db-password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"user-hash-secret\",\"UID\":\"0\"},\"SecretID\":\"nqdn03euckbucxx1d7brr0gde\",\"SecretName\":\"user-hash-secret\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app\"],\"Target\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Aliases\":[\"app\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Aliases\":[\"timur_app\",\"app\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{}},\"Status\":{\"ContainerStatus\":{\"ContainerID\":\"aaca6f0fdb21b4b33d0e72c46114d197cf1590889a946dfd4c0e84ab88573f31\",\"ExitCode\":1,\"PID\":0},\"Message\":\"shutdown\",\"PortStatus\":{},\"State\":\"shutdown\",\"Timestamp\":\"2022-01-04T21:53:41.895541058Z\"},\"UpdatedAt\":\"2022-01-04T21:53:41.93158238Z\",\"Version\":{\"Index\":10056975}},{\"CreatedAt\":\"2022-01-04T21:48:34.869891753Z\",\"DesiredState\":\"shutdown\",\"ID\":\"fz7aup1fu575twznk2a7lhqkd\",\"Labels\":{},\"NetworksAttachments\":[{\"Addresses\":[\"10.0.4.195/24\"],\"Network\":{\"CreatedAt\":\"2021-06-12T00:04:08.851633906Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4100\"}},\"ID\":\"pwqf514t16rtmjpq62shyib7h\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.4.1\",\"Subnet\":\"10.0.4.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"Attachable\":true,\"DriverConfiguration\":{\"Name\":\"overlay\"},\"IPAMOptions\":{\"Driver\":{\"Name\":\"default\"}},\"Labels\":{},\"Name\":\"prometheus\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2021-12-28T20:39:20.053403246Z\",\"Version\":{\"Index\":8635318}}},{\"Addresses\":[\"10.0.21.7/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.74850188Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4117\"}},\"ID\":\"c4ggc3aqae1ost27az5ri3nxz\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.21.1\",\"Subnet\":\"10.0.21.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_db\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.751592118Z\",\"Version\":{\"Index\":9866157}}},{\"Addresses\":[\"10.0.19.254/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.712710437Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4115\"}},\"ID\":\"r1u6c0bclbl6wyl1g8478x91v\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.19.1\",\"Subnet\":\"10.0.19.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_fe\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.715086232Z\",\"Version\":{\"Index\":9866153}}}],\"NodeID\":\"ybj02s79vhfv0zrcmwjecr3d6\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"ServiceID\":\"9vxwqyzsiehxqhe2w9pyi39n4\",\"Slot\":1,\"Spec\":{\"ContainerSpec\":{\"Args\":[\"bash\",\"-c\",\"set -e\\nexport METRICS_PW=\\\"$(cat /run/secrets/metrics-pw)\\\"\\nexec /bin/deploy.sh migrate -- /app/bin/puma.sh\\n\"],\"Configs\":[{\"ConfigID\":\"kyzf7xy96uv6ip5x65lgjf1wf\",\"ConfigName\":\"etna.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/env.yml\",\"UID\":\"0\"}},{\"ConfigID\":\"x4akplf1vv5h2j46f2hunod67\",\"ConfigName\":\"timur.staging.yml_1641325556_1641332269\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/config.yml\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"ETNA__PRODUCTION_FILE=/app/env.yml\",\"ETNA__PRODUCTION__DB__PASSWORD_FILE=/run/secrets/db-password\",\"ETNA__PRODUCTION__ROLLBAR__ACCESS_TOKEN=/run/secrets/rollbar-access-token\",\"ETNA__PRODUCTION__USER_HASH_SECRET=/run/secrets/user-hash-secret\",\"TIMUR_ENV=production\"],\"Healthcheck\":{\"Interval\":10000000000,\"Retries\":3,\"StartPeriod\":1000000000,\"Test\":[\"CMD-SHELL\",\"bash -c 'curl http://localhost:3000 || exit 1'\"],\"Timeout\":5000000000},\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"/var/node_exporter/metrics.prom\",\"Target\":\"/tmp/metrics.prom\",\"Type\":\"bind\"}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"metrics-pw\",\"UID\":\"0\"},\"SecretID\":\"6adzt6tvilj2msj5m4vsy1eug\",\"SecretName\":\"metrics-pw\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"db-password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"user-hash-secret\",\"UID\":\"0\"},\"SecretID\":\"nqdn03euckbucxx1d7brr0gde\",\"SecretName\":\"user-hash-secret\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app\"],\"Target\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Aliases\":[\"app\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Aliases\":[\"timur_app\",\"app\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{}},\"Status\":{\"ContainerStatus\":{\"ContainerID\":\"28e15f27e3274630586d2342b0a25983920365a860a2ff6745fd158f1d9a5a6b\",\"ExitCode\":1,\"PID\":0},\"Message\":\"shutdown\",\"PortStatus\":{},\"State\":\"shutdown\",\"Timestamp\":\"2022-01-04T21:52:55.827606933Z\"},\"UpdatedAt\":\"2022-01-04T21:52:55.864189786Z\",\"Version\":{\"Index\":10056849}},{\"CreatedAt\":\"2022-01-04T21:55:48.100231373Z\",\"DesiredState\":\"shutdown\",\"ID\":\"m41xhijn10or0nd85c924csca\",\"Labels\":{},\"NetworksAttachments\":[{\"Addresses\":[\"10.0.4.200/24\"],\"Network\":{\"CreatedAt\":\"2021-06-12T00:04:08.851633906Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4100\"}},\"ID\":\"pwqf514t16rtmjpq62shyib7h\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.4.1\",\"Subnet\":\"10.0.4.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"Attachable\":true,\"DriverConfiguration\":{\"Name\":\"overlay\"},\"IPAMOptions\":{\"Driver\":{\"Name\":\"default\"}},\"Labels\":{},\"Name\":\"prometheus\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2021-12-28T20:39:20.053403246Z\",\"Version\":{\"Index\":8635318}}},{\"Addresses\":[\"10.0.21.13/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.74850188Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4117\"}},\"ID\":\"c4ggc3aqae1ost27az5ri3nxz\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.21.1\",\"Subnet\":\"10.0.21.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_db\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.751592118Z\",\"Version\":{\"Index\":9866157}}},{\"Addresses\":[\"10.0.19.10/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.712710437Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4115\"}},\"ID\":\"r1u6c0bclbl6wyl1g8478x91v\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.19.1\",\"Subnet\":\"10.0.19.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_fe\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.715086232Z\",\"Version\":{\"Index\":9866153}}}],\"NodeID\":\"3e634fut8umris4hqblxbgmk0\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"ServiceID\":\"9vxwqyzsiehxqhe2w9pyi39n4\",\"Slot\":1,\"Spec\":{\"ContainerSpec\":{\"Args\":[\"bash\",\"-c\",\"set -e\\nexport METRICS_PW=\\\"$(cat /run/secrets/metrics-pw)\\\"\\nexec /bin/deploy.sh migrate -- /app/bin/puma.sh\\n\"],\"Configs\":[{\"ConfigID\":\"kyzf7xy96uv6ip5x65lgjf1wf\",\"ConfigName\":\"etna.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/env.yml\",\"UID\":\"0\"}},{\"ConfigID\":\"v708ckky9705nzt3rv6gya39l\",\"ConfigName\":\"timur.staging.yml_1641333336\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/config.yml\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"ETNA__PRODUCTION_FILE=/app/env.yml\",\"ETNA__PRODUCTION__DB__PASSWORD_FILE=/run/secrets/db-password\",\"ETNA__PRODUCTION__ROLLBAR__ACCESS_TOKEN=/run/secrets/rollbar-access-token\",\"ETNA__PRODUCTION__USER_HASH_SECRET=/run/secrets/user-hash-secret\",\"TIMUR_ENV=production\"],\"Healthcheck\":{\"Interval\":10000000000,\"Retries\":3,\"StartPeriod\":1000000000,\"Test\":[\"CMD-SHELL\",\"bash -c 'curl http://localhost:3000 || exit 1'\"],\"Timeout\":5000000000},\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"/var/node_exporter/metrics.prom\",\"Target\":\"/tmp/metrics.prom\",\"Type\":\"bind\"}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"metrics-pw\",\"UID\":\"0\"},\"SecretID\":\"6adzt6tvilj2msj5m4vsy1eug\",\"SecretName\":\"metrics-pw\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"db-password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"user-hash-secret\",\"UID\":\"0\"},\"SecretID\":\"nqdn03euckbucxx1d7brr0gde\",\"SecretName\":\"user-hash-secret\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app\"],\"Target\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Aliases\":[\"app\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Aliases\":[\"timur_app\",\"app\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{}},\"Status\":{\"ContainerStatus\":{\"ContainerID\":\"e3a51c0c8b47be1f146e69cdb9e1f2569179bf5820fc3ef56e2db70d33814e23\",\"ExitCode\":1,\"PID\":0},\"Message\":\"shutdown\",\"PortStatus\":{},\"State\":\"shutdown\",\"Timestamp\":\"2022-01-04T21:56:57.308100237Z\"},\"UpdatedAt\":\"2022-01-04T21:56:57.403694091Z\",\"Version\":{\"Index\":10057468}},{\"CreatedAt\":\"2022-01-04T21:53:20.40610415Z\",\"DesiredState\":\"shutdown\",\"ID\":\"z0xbye6o8sfrrp9tvrrvrpspf\",\"Labels\":{},\"NetworksAttachments\":[{\"Addresses\":[\"10.0.4.198/24\"],\"Network\":{\"CreatedAt\":\"2021-06-12T00:04:08.851633906Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4100\"}},\"ID\":\"pwqf514t16rtmjpq62shyib7h\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.4.1\",\"Subnet\":\"10.0.4.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"Attachable\":true,\"DriverConfiguration\":{\"Name\":\"overlay\"},\"IPAMOptions\":{\"Driver\":{\"Name\":\"default\"}},\"Labels\":{},\"Name\":\"prometheus\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2021-12-28T20:39:20.053403246Z\",\"Version\":{\"Index\":8635318}}},{\"Addresses\":[\"10.0.21.11/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.74850188Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4117\"}},\"ID\":\"c4ggc3aqae1ost27az5ri3nxz\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.21.1\",\"Subnet\":\"10.0.21.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_db\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.751592118Z\",\"Version\":{\"Index\":9866157}}},{\"Addresses\":[\"10.0.19.8/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.712710437Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4115\"}},\"ID\":\"r1u6c0bclbl6wyl1g8478x91v\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.19.1\",\"Subnet\":\"10.0.19.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_fe\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.715086232Z\",\"Version\":{\"Index\":9866153}}}],\"NodeID\":\"ybj02s79vhfv0zrcmwjecr3d6\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"ServiceID\":\"9vxwqyzsiehxqhe2w9pyi39n4\",\"Slot\":1,\"Spec\":{\"ContainerSpec\":{\"Args\":[\"bash\",\"-c\",\"set -e\\nexport METRICS_PW=\\\"$(cat /run/secrets/metrics-pw)\\\"\\nexec /bin/deploy.sh migrate -- /app/bin/puma.sh\\n\"],\"Configs\":[{\"ConfigID\":\"kyzf7xy96uv6ip5x65lgjf1wf\",\"ConfigName\":\"etna.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/env.yml\",\"UID\":\"0\"}},{\"ConfigID\":\"qn484g1c0bmaaw2n1fkueyc8e\",\"ConfigName\":\"timur.staging.yml\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/app/config.yml\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"ETNA__PRODUCTION_FILE=/app/env.yml\",\"ETNA__PRODUCTION__DB__PASSWORD_FILE=/run/secrets/db-password\",\"ETNA__PRODUCTION__ROLLBAR__ACCESS_TOKEN=/run/secrets/rollbar-access-token\",\"ETNA__PRODUCTION__USER_HASH_SECRET=/run/secrets/user-hash-secret\",\"TIMUR_ENV=production\"],\"Healthcheck\":{\"Interval\":10000000000,\"Retries\":3,\"StartPeriod\":1000000000,\"Test\":[\"CMD-SHELL\",\"bash -c 'curl http://localhost:3000 || exit 1'\"],\"Timeout\":5000000000},\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"/var/node_exporter/metrics.prom\",\"Target\":\"/tmp/metrics.prom\",\"Type\":\"bind\"}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"metrics-pw\",\"UID\":\"0\"},\"SecretID\":\"6adzt6tvilj2msj5m4vsy1eug\",\"SecretName\":\"metrics-pw\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"db-password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"},{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"user-hash-secret\",\"UID\":\"0\"},\"SecretID\":\"nqdn03euckbucxx1d7brr0gde\",\"SecretName\":\"user-hash-secret\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app\"],\"Target\":\"pwqf514t16rtmjpq62shyib7h\"},{\"Aliases\":[\"app\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"},{\"Aliases\":[\"timur_app\",\"app\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{}},\"Status\":{\"ContainerStatus\":{\"ContainerID\":\"9b86e192529d164b80087dbb180858e52f7db86027237dd2d4e6f6db5998505b\",\"ExitCode\":1,\"PID\":0},\"Message\":\"shutdown\",\"PortStatus\":{},\"State\":\"shutdown\",\"Timestamp\":\"2022-01-04T21:56:07.135526801Z\"},\"UpdatedAt\":\"2022-01-04T21:56:07.224862998Z\",\"Version\":{\"Index\":10057332}}]","stderr":"","i":"50 /home/home/monoetna/swarm/swarm-keeper/lib/edit-config-deploy.recording"}
{"cmd":"http","args":["--check-status","--proxy=http:socks5h://127.0.0.1:9090","--proxy=https:socks5h://127.0.0.1:9090","GET","https://portainer.dsco.ucsf.edu/api/endpoints/1/docker/services","Authorization: Bearer xxx","filters=={\"name\":[\"timur-staging_postgres\"]}"],"result":"0","stdin":"","stdout":"[{\"CreatedAt\":\"2022-01-03T23:20:42.40988215Z\",\"Endpoint\":{\"Spec\":{\"Mode\":\"vip\"},\"VirtualIPs\":[{\"Addr\":\"10.0.21.2/24\",\"NetworkID\":\"c4ggc3aqae1ost27az5ri3nxz\"}]},\"ID\":\"l8z4f6ubn3a07ldj5mscerbog\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"PreviousSpec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"com.docker.stack.image\":\"postgres:10.19\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Replicated\":{\"Replicas\":1}},\"Name\":\"timur-staging_postgres\",\"TaskTemplate\":{\"ContainerSpec\":{\"Env\":[\"POSTGRES_DB=timur\",\"POSTGRES_PASSWORD_FILE=/run/secrets/password\",\"POSTGRES_USER=developer\"],\"Image\":\"postgres:10.19@sha256:ac0b1670c906d610741e93a517e6492979b7b0ad2127862c8a574ce265dc8804\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur_staging_db\",\"Target\":\"/var/lib/postgresql/data\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"postgres\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_db == true\"],\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"},{\"OS\":\"linux\"},{\"OS\":\"linux\"},{\"Architecture\":\"arm64\",\"OS\":\"linux\"},{\"Architecture\":\"386\",\"OS\":\"linux\"}]},\"Resources\":{},\"Runtime\":\"container\"}},\"Spec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"com.docker.stack.image\":\"postgres:10.19\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Replicated\":{\"Replicas\":1}},\"Name\":\"timur-staging_postgres\",\"TaskTemplate\":{\"ContainerSpec\":{\"Env\":[\"POSTGRES_DB=timur\",\"POSTGRES_PASSWORD_FILE=/run/secrets/password\",\"POSTGRES_USER=developer\"],\"Image\":\"postgres:10.19@sha256:ac0b1670c906d610741e93a517e6492979b7b0ad2127862c8a574ce265dc8804\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur_staging_db\",\"Target\":\"/var/lib/postgresql/data\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"postgres\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_db == true\"],\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"},{\"OS\":\"linux\"},{\"OS\":\"linux\"},{\"Architecture\":\"arm64\",\"OS\":\"linux\"},{\"Architecture\":\"386\",\"OS\":\"linux\"}]},\"Resources\":{},\"Runtime\":\"container\"}},\"UpdatedAt\":\"2022-01-04T21:56:34.893497012Z\",\"Version\":{\"Index\":10057407}}]","stderr":"","i":"51 /home/home/monoetna/swarm/swarm-keeper/lib/edit-config-deploy.recording"}
{"cmd":"http","args":["--check-status","--proxy=http:socks5h://127.0.0.1:9090","--proxy=https:socks5h://127.0.0.1:9090","GET","https://portainer.dsco.ucsf.edu/api/endpoints/1/docker/tasks","Authorization: Bearer xxx","filters=={\"service\":[\"timur-staging_postgres\"],\"desired-state\":[\"shutdown\"]}"],"result":"0","stdin":"","stdout":"[{\"CreatedAt\":\"2022-01-04T00:26:25.994684423Z\",\"DesiredState\":\"shutdown\",\"ID\":\"37lq721bd53i4l8i44b4vod4i\",\"Labels\":{},\"NetworksAttachments\":[{\"Addresses\":[\"10.0.21.152/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.74850188Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4117\"}},\"ID\":\"c4ggc3aqae1ost27az5ri3nxz\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.21.1\",\"Subnet\":\"10.0.21.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_db\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.751592118Z\",\"Version\":{\"Index\":9866157}}}],\"NodeID\":\"g1u5emqok8xewkg6k4g2t6ra9\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"ServiceID\":\"l8z4f6ubn3a07ldj5mscerbog\",\"Slot\":1,\"Spec\":{\"ContainerSpec\":{\"Env\":[\"POSTGRES_DB=timur\",\"POSTGRES_PASSWORD_FILE=/run/secrets/password\",\"POSTGRES_USER=developer\"],\"Image\":\"postgres:10.19@sha256:e7efcc5f6a9cd97b0346ce76ffc444dd6692bde07cf35265860655fa01f24da8\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur_staging_db\",\"Target\":\"/var/lib/postgresql/data\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"postgres\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_db == true\"],\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"},{\"OS\":\"linux\"},{\"OS\":\"linux\"},{\"Architecture\":\"arm64\",\"OS\":\"linux\"},{\"Architecture\":\"386\",\"OS\":\"linux\"}]},\"Resources\":{}},\"Status\":{\"ContainerStatus\":{\"ContainerID\":\"dfa1d67faeb912af362c8574b7af5b160b83ca8b8cf6c8d1b5cb8c965bb205df\",\"ExitCode\":0,\"PID\":0},\"Message\":\"shutdown\",\"PortStatus\":{},\"State\":\"shutdown\",\"Timestamp\":\"2022-01-04T19:46:08.190644587Z\"},\"UpdatedAt\":\"2022-01-04T19:46:08.245789154Z\",\"Version\":{\"Index\":10039119}},{\"CreatedAt\":\"2022-01-03T23:29:34.697196592Z\",\"DesiredState\":\"shutdown\",\"ID\":\"j4dkpw4foytlxyh0upu296e27\",\"Labels\":{},\"NetworksAttachments\":[{\"Addresses\":[\"10.0.21.44/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.74850188Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4117\"}},\"ID\":\"c4ggc3aqae1ost27az5ri3nxz\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.21.1\",\"Subnet\":\"10.0.21.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_db\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.751592118Z\",\"Version\":{\"Index\":9866157}}}],\"NodeID\":\"g1u5emqok8xewkg6k4g2t6ra9\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"ServiceID\":\"l8z4f6ubn3a07ldj5mscerbog\",\"Slot\":1,\"Spec\":{\"ContainerSpec\":{\"Env\":[\"POSTGRES_DB=timur\",\"POSTGRES_PASSWORD_FILE=/run/secrets/password\",\"POSTGRES_USER=developer\"],\"Image\":\"docker.io/postgres:10.19@sha256:e7efcc5f6a9cd97b0346ce76ffc444dd6692bde07cf35265860655fa01f24da8\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur_staging_db\",\"Target\":\"/var/lib/postgresql/data\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"Secrets\":[{\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"password\",\"UID\":\"0\"},\"SecretID\":\"xjzixr3ywnuh8kcta77g17khm\",\"SecretName\":\"timur_staging_db_password\"}]},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"postgres\"],\"Target\":\"c4ggc3aqae1ost27az5ri3nxz\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_db == true\"],\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"},{\"OS\":\"linux\"},{\"OS\":\"linux\"},{\"Architecture\":\"arm64\",\"OS\":\"linux\"},{\"Architecture\":\"386\",\"OS\":\"linux\"}]},\"Resources\":{\"Limits\":{},\"Reservations\":{}}},\"Status\":{\"ContainerStatus\":{\"ContainerID\":\"4538933ffa8fd5d6d81554c6ed088651dd63b15c274339c83cb876e5cb64c7f2\",\"ExitCode\":0,\"PID\":0},\"Message\":\"shutdown\",\"PortStatus\":{},\"State\":\"shutdown\",\"Timestamp\":\"2022-01-04T00:26:29.631343719Z\"},\"UpdatedAt\":\"2022-01-04T00:26:29.744551684Z\",\"Version\":{\"Index\":9879380}}]","stderr":"","i":"52 /home/home/monoetna/swarm/swarm-keeper/lib/edit-config-deploy.recording"}
{"cmd":"http","args":["--check-status","--proxy=http:socks5h://127.0.0.1:9090","--proxy=https:socks5h://127.0.0.1:9090","GET","https://portainer.dsco.ucsf.edu/api/endpoints/1/docker/services","Authorization: Bearer xxx","filters=={\"name\":[\"timur-staging_app_assets_deployer\"]}"],"result":"0","stdin":"","stdout":"[{\"CreatedAt\":\"2022-01-03T23:20:41.23437548Z\",\"Endpoint\":{\"Spec\":{\"Mode\":\"vip\"},\"VirtualIPs\":[{\"Addr\":\"10.0.20.2/24\",\"NetworkID\":\"m52fcusnqimfjqpnrnqrq34gs\"}]},\"ID\":\"qgjxwctj8zxsu5i6ux5bf40j2\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"PreviousSpec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Global\":{}},\"Name\":\"timur-staging_app_assets_deployer\",\"TaskTemplate\":{\"ContainerSpec\":{\"Args\":[\"/bin/deploy.sh\",\"syncAssets\",\"--\",\"true\"],\"Env\":[\"APP_NAME=timur\",\"TIMUR_ENV=production\"],\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur-staging_app_public\",\"Target\":\"/sync-assets\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null}},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app_assets_deployer\"],\"Target\":\"m52fcusnqimfjqpnrnqrq34gs\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_app_public == true\"],\"MaxReplicas\":1,\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"RestartPolicy\":{\"Condition\":\"none\",\"MaxAttempts\":0},\"Runtime\":\"container\"}},\"Spec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Global\":{}},\"Name\":\"timur-staging_app_assets_deployer\",\"TaskTemplate\":{\"ContainerSpec\":{\"Args\":[\"/bin/deploy.sh\",\"syncAssets\",\"--\",\"true\"],\"Env\":[\"APP_NAME=timur\",\"TIMUR_ENV=production\"],\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur-staging_app_public\",\"Target\":\"/sync-assets\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null}},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app_assets_deployer\"],\"Target\":\"m52fcusnqimfjqpnrnqrq34gs\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_app_public == true\"],\"MaxReplicas\":1,\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"RestartPolicy\":{\"Condition\":\"none\",\"MaxAttempts\":0},\"Runtime\":\"container\"}},\"UpdatedAt\":\"2022-01-04T21:56:33.664230534Z\",\"Version\":{\"Index\":10057398}}]","stderr":"","i":"53 /home/home/monoetna/swarm/swarm-keeper/lib/edit-config-deploy.recording"}
{"cmd":"http","args":["--check-status","--proxy=http:socks5h://127.0.0.1:9090","--proxy=https:socks5h://127.0.0.1:9090","GET","https://portainer.dsco.ucsf.edu/api/endpoints/1/docker/tasks","Authorization: Bearer xxx","filters=={\"service\":[\"timur-staging_app_assets_deployer\"],\"desired-state\":[\"shutdown\"]}"],"result":"0","stdin":"","stdout":"[{\"CreatedAt\":\"2022-01-03T23:30:26.983452827Z\",\"DesiredState\":\"shutdown\",\"ID\":\"rgac3os26dn9kdz36273cffys\",\"Labels\":{},\"NetworksAttachments\":[{\"Addresses\":[\"10.0.20.3/24\"],\"Network\":{\"CreatedAt\":\"2022-01-03T23:15:48.740552509Z\",\"DriverState\":{\"Name\":\"overlay\",\"Options\":{\"com.docker.network.driver.overlay.vxlanid_list\":\"4116\"}},\"ID\":\"m52fcusnqimfjqpnrnqrq34gs\",\"IPAMOptions\":{\"Configs\":[{\"Gateway\":\"10.0.20.1\",\"Subnet\":\"10.0.20.0/24\"}],\"Driver\":{\"Name\":\"default\"}},\"Spec\":{\"DriverConfiguration\":{\"Name\":\"overlay\"},\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Name\":\"timur-staging_default\",\"Scope\":\"swarm\"},\"UpdatedAt\":\"2022-01-03T23:15:48.743252018Z\",\"Version\":{\"Index\":9866155}}}],\"NodeID\":\"g1u5emqok8xewkg6k4g2t6ra9\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"ServiceID\":\"qgjxwctj8zxsu5i6ux5bf40j2\",\"Spec\":{\"ContainerSpec\":{\"Args\":[\"/bin/deploy.sh\",\"syncAssets\",\"--\",\"true\"],\"Env\":[\"APP_NAME=timur\",\"TIMUR_ENV=production\"],\"Image\":\"etnaagent/timur:staging@sha256:ffcadb0222bdcfc3b4bbffc1e8daa095c6b09ef90f917930978f1dc32d393b3b\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur-staging_app_public\",\"Target\":\"/sync-assets\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null}},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app_assets_deployer\"],\"Target\":\"m52fcusnqimfjqpnrnqrq34gs\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_app_public == true\"],\"MaxReplicas\":1,\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"RestartPolicy\":{\"Condition\":\"none\",\"MaxAttempts\":0}},\"Status\":{\"ContainerStatus\":{\"ContainerID\":\"48c899487b87f0357c8a7290994853b5845d6bd678286c887221b14cb2962aa7\",\"ExitCode\":0,\"PID\":0},\"Message\":\"finished\",\"PortStatus\":{},\"State\":\"complete\",\"Timestamp\":\"2022-01-03T23:31:40.659571482Z\"},\"UpdatedAt\":\"2022-01-03T23:31:40.933472801Z\",\"Version\":{\"Index\":9868625}}]","stderr":"","i":"54 /home/home/monoetna/swarm/swarm-keeper/lib/edit-config-deploy.recording"}
{"cmd":"http","args":["--check-status","--proxy=http:socks5h://127.0.0.1:9090","--proxy=https:socks5h://127.0.0.1:9090","GET","https://portainer.dsco.ucsf.edu/api/endpoints/1/docker/services","Authorization: Bearer xxx","filters=={\"name\":[\"timur-staging_app_fe\"]}"],"result":"0","stdin":"","stdout":"[{\"CreatedAt\":\"2022-01-03T23:20:39.571206988Z\",\"Endpoint\":{\"Spec\":{\"Mode\":\"vip\"},\"VirtualIPs\":[{\"Addr\":\"10.0.3.214/24\",\"NetworkID\":\"wl9z0sp3su5p6za45i3klgtn6\"},{\"Addr\":\"10.0.19.2/24\",\"NetworkID\":\"r1u6c0bclbl6wyl1g8478x91v\"}]},\"ID\":\"y8mocvq0olbq809713v3ey9hd\",\"Portainer\":{\"ResourceControl\":{\"Id\":210,\"ResourceId\":\"1_timur-staging\",\"SubResourceIds\":[],\"Type\":6,\"UserAccesses\":[],\"TeamAccesses\":[],\"Public\":false,\"AdministratorsOnly\":true,\"System\":false}},\"PreviousSpec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur_app_fe:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Replicated\":{\"Replicas\":1}},\"Name\":\"timur-staging_app_fe\",\"TaskTemplate\":{\"ContainerSpec\":{\"Configs\":[{\"ConfigID\":\"efyi8cnelo5i809bnga85ozje\",\"ConfigName\":\"browser.system.include\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/usr/opt/httpd.conf.d/browser.system.include\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"TIMUR_ENV=production\"],\"Image\":\"etnaagent/timur_app_fe:staging@sha256:f3527445b7147a4fba3923abc4f308f12457ffcf120021c7d9a0e234e7e048a3\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur-staging_app_public\",\"Target\":\"/app/public\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"User\":\"0:3000\"},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app_fe\"],\"Target\":\"wl9z0sp3su5p6za45i3klgtn6\"},{\"Aliases\":[\"app_fe\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_app_public == true\"],\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"RestartPolicy\":{\"Condition\":\"none\",\"MaxAttempts\":0},\"Runtime\":\"container\"}},\"Spec\":{\"EndpointSpec\":{\"Mode\":\"vip\"},\"Labels\":{\"autoupdate\":\"true\",\"com.docker.stack.image\":\"etnaagent/timur_app_fe:staging\",\"com.docker.stack.namespace\":\"timur-staging\"},\"Mode\":{\"Replicated\":{\"Replicas\":1}},\"Name\":\"timur-staging_app_fe\",\"TaskTemplate\":{\"ContainerSpec\":{\"Configs\":[{\"ConfigID\":\"efyi8cnelo5i809bnga85ozje\",\"ConfigName\":\"browser.system.include\",\"File\":{\"GID\":\"0\",\"Mode\":292,\"Name\":\"/usr/opt/httpd.conf.d/browser.system.include\",\"UID\":\"0\"}}],\"Env\":[\"APP_NAME=timur\",\"TIMUR_ENV=production\"],\"Image\":\"etnaagent/timur_app_fe:staging@sha256:f3527445b7147a4fba3923abc4f308f12457ffcf120021c7d9a0e234e7e048a3\",\"Isolation\":\"default\",\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"},\"Mounts\":[{\"Source\":\"timur-staging_app_public\",\"Target\":\"/app/public\",\"Type\":\"volume\",\"VolumeOptions\":{\"Labels\":{\"com.docker.stack.namespace\":\"timur-staging\"}}}],\"Privileges\":{\"CredentialSpec\":null,\"SELinuxContext\":null},\"User\":\"0:3000\"},\"ForceUpdate\":0,\"Networks\":[{\"Aliases\":[\"app_fe\"],\"Target\":\"wl9z0sp3su5p6za45i3klgtn6\"},{\"Aliases\":[\"app_fe\"],\"Target\":\"r1u6c0bclbl6wyl1g8478x91v\"}],\"Placement\":{\"Constraints\":[\"node.labels.volumes.timur_staging_app_public == true\"],\"Platforms\":[{\"Architecture\":\"amd64\",\"OS\":\"linux\"}]},\"Resources\":{},\"RestartPolicy\":{\"Condition\":\"none\",\"MaxAttempts\":0},\"Runtime\":\"container\"}},\"UpdatedAt\":\"2022-01-04T21:56:32.103949457Z\",\"Version\":{\"Index\":10057396}}]","stderr":"","i":"55 /home/home/monoetna/swarm/swarm-keeper/lib/edit-config-deploy.recording"}
{"cmd":"http","args":["--check-status","--proxy=http:socks5h://127.0.0.1:9090","--proxy=https:socks5h://127.0.0.1:9090","GET","https://portainer.dsco.ucsf.edu/api/endpoints/1/docker/tasks","Authorization: Bearer xxx","filters=={\"service\":[\"timur-staging_app_fe\"],\"desired-state\":[\"shutdown\"]}"],"result":"0","stdin":"","stdout":"[]","stderr":"","i":"56 /home/home/monoetna/swarm/swarm-keeper/lib/edit-config-deploy.recording"}
