import { setupWorker } from '../worker';

describe('setupWorker', () => {
  it('prepares a dispatch and subscribe', () => {
    const mockExecute = jest.fn();
    const mockWorker = {
      postMessage: jest.fn(),
      addEventListener: jest.fn()
    };

    const { dispatch, subscribe } = setupWorker(mockWorker);
    const data = [];
    dispatch(data)
    expect(mockWorker.postMessage).toHaveBeenCalledWith(data);

    expect(mockWorker.addEventListener).not.toHaveBeenCalled();
    subscribe(mockExecute)
    expect(mockWorker.addEventListener).toHaveBeenCalled();
  });
});
